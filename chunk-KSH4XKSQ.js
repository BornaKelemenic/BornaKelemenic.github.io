import{D as A,G as E,J as N,M as h,N as z,P as B,V as M,a as u,b as V,h as I,i as R,k as O,l as w,m as j,p as v,q as f,t as x}from"./chunk-F55HGIM7.js";function D(...t){let e={config:{},state:{}};for(let{config:n,props:r}of t)Object.assign(e.config,n),Object.assign(e.state,r);return e}var K=0,l=new w(!1),q=l.asObservable().pipe(A(t=>!t),E(1));function ut(t){if(!l.getValue()){l.next(!0);let e=t();return K===0&&l.next(!1),e}return t()}var c={},$=class{registerPreStoreUpdate(e){c.preStoreUpdate=e}registerPreStateInit(e){c.preStateInit=e}},at=new $,p=new Map,C=new O,ct=C.asObservable();function J(t){p.set(t.name,t),C.next({type:"add",store:t})}function Q(t){p.delete(t.name),C.next({type:"remove",store:t})}function ft(t){return p.get(t)}function lt(){return p}function pt(){let t={};return p.forEach((e,n)=>{t[n]=e.getValue()}),t}var d=[];function W(t){d.push(t)}function T(t){d.length&&d.forEach(e=>t.next(e)),d=[]}var P=class extends w{constructor(e){super(e.state),this.storeDef=e,this.initialState=void 0,this.state=void 0,this.batchInProgress=!1,this.events=new O,this.context={config:this.getConfig(),setEvent:n=>{W(n)}},this.events$=this.events.asObservable(),this.state=this.getInitialState(e.state),this.initialState=this.getValue(),J(this)}get name(){return this.storeDef.name}getInitialState(e){return c.preStateInit?c.preStateInit(e,this.name):e}getConfig(){return this.storeDef.config}query(e){return e(this.getValue())}update(...e){let n=this.getValue(),r=e.reduce((s,i)=>(s=i(s,this.context),s),n);c.preStoreUpdate&&(r=c.preStoreUpdate(n,r,this.name)),r!==n&&(this.state=r,l.getValue()?this.batchInProgress||(this.batchInProgress=!0,q.subscribe(()=>{super.next(this.state),T(this.events),this.batchInProgress=!1})):(super.next(this.state),T(this.events)))}getValue(){return this.state}reset(){this.update(()=>this.initialState)}combine(e){let n=!0,r={};return new R(s=>{for(let[i,m]of Object.entries(e))s.add(m.subscribe(b=>{r[i]=b,n=!0}));return this.subscribe({next(){n&&(s.next(u({},r)),n=!1)},error(i){s.error(i)},complete(){s.complete()}})})}destroy(){Q(this),this.reset()}next(e){this.update(()=>e)}error(){}complete(){}};function U(t,...e){let{state:n,config:r}=D(...e),{name:s}=t;return new P({name:s,state:n,config:r})}function X(t){return typeof t=="function"}function gt(t){return t.charAt(0).toUpperCase()+t.slice(1)}function g(t,e){return function(n){return V(u({},n),{[t]:X(e)?e(n[t]):e})}}function S(t){return I(x(t),N())}function ht(){return A(t=>t!=null)}function H(t){return{props:t,config:void 0}}function L(t,e){let n={source:o=>o,preStoreInit:o=>o,key:e.key??`${t.name}@store`,runGuard(){return typeof window<"u"}},r=u(u({},n),e);if(!r.runGuard?.())return{initialized$:f(!1),unsubscribe(){}};let{storage:s}=e,i=new j(1),m=v(s.getItem(r.key)).subscribe(o=>{o&&t.update(y=>r.preStoreInit(u(u({},y),o))),i.next(!0),i.complete()}),b=r.source(t).pipe(z(1),B(o=>{let y=r.preStorageUpdate?r.preStorageUpdate(t.name,o):o;return s.setItem(r.key,y)})).subscribe();return{initialized$:i.asObservable(),unsubscribe(){b.unsubscribe(),m.unsubscribe()}}}function F(t){if(t)return{getItem(e){let n=t.getItem(e);return f(n&&JSON.parse(n))},setItem(e,n){return t.setItem(e,JSON.stringify(n)),f(!0)},removeItem(e){return t.removeItem(e),f(!0)}}}var Y=()=>{try{if(typeof localStorage<"u")return localStorage}catch{}},G=F(Y()),Z=()=>{try{if(typeof sessionStorage<"u")return sessionStorage}catch{}},yt=F(Z());var a=function(t){return t.CROATIAN="hr-HR",t.BRITISH_ENGLISH="en-GB",t}(a||{}),wt=new Map([[a.BRITISH_ENGLISH,"English"],[a.CROATIAN,"Hrvatski"]]),xt=new Map([[a.BRITISH_ENGLISH,"flags-gb"],[a.CROATIAN,"flags-hr"]]);var k={language:a.CROATIAN,hasManuallyChosenLanguage:!1,playSounds:!0,showColoredButtons:!0},_="archery-stats-settings",jt=(()=>{class t{constructor(){this.store=U({name:_},H(k)),L(this.store,{key:_,storage:G}),this.lang$=this.store.pipe(S(n=>n.language),h({refCount:!0,bufferSize:1})),this.playSounds$=this.store.pipe(S(n=>n.playSounds),h({refCount:!0,bufferSize:1})),this.showColoredButtons$=this.store.pipe(S(n=>n.showColoredButtons),h({refCount:!0,bufferSize:1}))}setLanguage(n){this.store.update(g("language",n))}setHasManuallyChosenLanguage(n){this.store.update(g("hasManuallyChosenLanguage",n))}setPlaySounds(n){this.store.update(g("playSounds",n))}setShowColoredButtons(n){this.store.update(g("showColoredButtons",n))}getStoreProp(n){return this.store.getValue()[n]}static{this.\u0275fac=function(r){return new(r||t)}}static{this.\u0275prov=M({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();export{ut as a,ct as b,ft as c,lt as d,pt as e,U as f,gt as g,g as h,S as i,ht as j,H as k,L as l,G as m,a as n,wt as o,xt as p,jt as q};
