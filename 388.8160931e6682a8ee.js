"use strict";(self.webpackChunkarchery_stats=self.webpackChunkarchery_stats||[]).push([[388],{388:(j,d,i)=>{i.r(d),i.d(d,{ActiveSessionPageComponent:()=>N});var p=i(6895),h=i(4850),_=i(3336),f=i(7009),m=i(9132),C=i(7579),x=i(2722),b=i(8735),I=i(5985),t=i(4650),u=i(4859),v=i(5412),g=(()=>((g||(g={})).DELETE="delete",g))(),c=(()=>{return(e=c||(c={})).GOLD="gold-scheme",e.RED="red-scheme",e.BLUE="blue-scheme",e.BLACK="black-scheme",e.WHITE="white-scheme",c;var e})(),y=i(6235);function A(e,s){if(1&e){const n=t.EpF();t.TgZ(0,"button",3),t.NdJ("click",function(){const a=t.CHM(n).$implicit,l=t.oxw(2);return t.KtG(l.action.emit(a.action))}),t.ALo(1,"async"),t._uU(2),t.qZA()}if(2&e){const n=s.$implicit,o=t.oxw(2);t.Tol(t.lcZ(1,3,o.settingsRepo.showColouredInputButton$)&&n.colorScheme||null),t.xp6(2),t.hij(" ",n.label," ")}}function T(e,s){if(1&e&&(t.TgZ(0,"div",1),t.YNc(1,A,3,5,"button",2),t.qZA()),2&e){const n=t.oxw();t.xp6(1),t.Q6J("ngForOf",n.scoreInputConfig)}}const O=[{label:"0",action:0},{label:"10",action:10,colorScheme:c.GOLD},{label:"DEL",action:g.DELETE},{label:"7",action:7,colorScheme:c.RED},{label:"8",action:8,colorScheme:c.RED},{label:"9",action:9,colorScheme:c.GOLD},{label:"4",action:4,colorScheme:c.BLACK},{label:"5",action:5,colorScheme:c.BLUE},{label:"6",action:6,colorScheme:c.BLUE},{label:"1",action:1,colorScheme:c.WHITE},{label:"2",action:2,colorScheme:c.WHITE},{label:"3",action:3,colorScheme:c.BLACK}];let Z=(()=>{class e{constructor(n){this.settingsRepo=n,this.scoreInputConfig=O,this.action=new t.vpe}}return e.\u0275fac=function(n){return new(n||e)(t.Y36(y.i))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-score-input-buttons"]],inputs:{scoreInputConfig:"scoreInputConfig"},outputs:{action:"action"},standalone:!0,features:[t.jDz],decls:1,vars:1,consts:[["class","button-grid",4,"ngIf"],[1,"button-grid"],["mat-stroked-button","",3,"class","click",4,"ngFor","ngForOf"],["mat-stroked-button","",3,"click"]],template:function(n,o){1&n&&t.YNc(0,T,2,1,"div",0),2&n&&t.Q6J("ngIf",o.scoreInputConfig)},dependencies:[p.ax,p.O5,p.Ov,u.ot,u.lW],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;align-items:center}.button-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(3,min-content);gap:var(--spacing-2x)}.button-grid[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:50px;height:50px;min-width:0}"]}),e})();const E=["*"];let w=(()=>{class e{}return e.\u0275fac=function(n){return new(n||e)},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-score-input-display-block"]],standalone:!0,features:[t.jDz],ngContentSelectors:E,decls:1,vars:0,template:function(n,o){1&n&&(t.F$t(),t.Hsn(0))},styles:["[_nghost-%COMP%]{display:inline-flex;align-items:center;justify-content:center;font-size:1.25em;padding:.25em;width:50px;height:50px}[_nghost-%COMP%]:not(.active){cursor:pointer}.active[_nghost-%COMP%]{box-shadow:0 2px 4px -1px #0003,0 4px 5px #00000024,0 1px 10px #0000001f}"]}),e})();var S=i(4298),B=i(9613);function P(e,s){if(1&e){const n=t.EpF();t.ynx(0),t.TgZ(1,"app-score-input-display-block",4),t.NdJ("click",function(){const a=t.CHM(n).index,l=t.oxw();return t.KtG(l.activeShotIndex=a)}),t._uU(2),t.qZA(),t.BQk()}if(2&e){const n=s.$implicit,o=s.index,r=t.oxw();let a;t.xp6(1),t.ekj("active",o===r.activeShotIndex),t.xp6(1),t.hij(" ",null!==(a=null==n?null:n.value)&&void 0!==a?a:"-"," ")}}let k=(()=>{class e{set session(n){this.numberOfArrows=n.numberOfArrows}set numberOfArrows(n){this._numberOfArrows=n,this.resetShots()}get numberOfArrows(){return this._numberOfArrows}constructor(n){this.dialog=n,this._numberOfArrows=6,this.activeShotIndex=0,this.shots=[],this.savedEntry=new t.vpe}resetShots(){this.shots=new Array(this.numberOfArrows).fill(null),this.activeShotIndex=0}saveEntryToRepo(n){this.savedEntry.emit((0,S.Yo)({shots:n})),this.resetShots()}buttonInputAction(n){"number"==typeof n?(this.shots[this.activeShotIndex]=(0,S.Ey)({value:n}),this.activeShotIndex=++this.activeShotIndex%this.shots.length):this.shots[this.activeShotIndex]=null}save(){const n=this.shots.filter(o=>!!o).sort((o,r)=>r.value-o.value);n.length?this.saveEntryToRepo(n):this.dialog.open(B.M,{restoreFocus:!1,autoFocus:!1,width:"500px",data:{title:"Are you sure you want to add an entry with no shots ?"}}).afterClosed().subscribe(r=>{r&&this.saveEntryToRepo(n)})}}return e.\u0275fac=function(n){return new(n||e)(t.Y36(v.uw))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-score-input"]],inputs:{session:"session"},outputs:{savedEntry:"savedEntry"},standalone:!0,features:[t.jDz],decls:5,vars:1,consts:[[1,"blocks-grid","margin-bottom-4x"],[4,"ngFor","ngForOf"],[3,"action"],["mat-raised-button","","color","primary",1,"margin-top-4x",3,"click"],[3,"click"]],template:function(n,o){1&n&&(t.TgZ(0,"div",0),t.YNc(1,P,3,3,"ng-container",1),t.qZA(),t.TgZ(2,"app-score-input-buttons",2),t.NdJ("action",function(a){return o.buttonInputAction(a)}),t.qZA(),t.TgZ(3,"button",3),t.NdJ("click",function(){return o.save()}),t._uU(4," Save\n"),t.qZA()),2&n&&(t.xp6(1),t.Q6J("ngForOf",o.shots))},dependencies:[p.ax,w,Z,u.ot,u.lW,v.Is],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;align-items:center}.blocks-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(3,min-content);gap:var(--spacing-2x)}"]}),e})();var D=i(8778),F=i(2823);function J(e,s){1&e&&(t.TgZ(0,"mat-icon"),t._uU(1," lock "),t.qZA())}function L(e,s){if(1&e){const n=t.EpF();t.TgZ(0,"app-score-input",7),t.NdJ("savedEntry",function(r){t.CHM(n);const a=t.oxw(2);return t.KtG(a.archerySessionRepo.addEntryForActiveSession(r))}),t.qZA()}if(2&e){const n=t.oxw().ngIf;t.Q6J("session",n)}}function U(e,s){if(1&e&&t._UZ(0,"app-entries-table",9),2&e){const n=t.oxw(4);t.Q6J("entries",n.entries)}}function Y(e,s){if(1&e&&t._UZ(0,"app-entries-circles-list",9),2&e){const n=t.oxw(4);t.Q6J("entries",n.entries)}}function Q(e,s){if(1&e&&(t.ynx(0),t.YNc(1,U,1,1,"app-entries-table",8),t.YNc(2,Y,1,1,"app-entries-circles-list",8),t.BQk()),2&e){const n=s.ngIf;t.xp6(1),t.Q6J("ngIf","table"===n),t.xp6(1),t.Q6J("ngIf","circles"===n)}}function R(e,s){if(1&e&&(t.ynx(0),t.YNc(1,Q,3,2,"ng-container",0),t.ALo(2,"async"),t.BQk()),2&e){const n=t.oxw(2);t.xp6(1),t.Q6J("ngIf",t.lcZ(2,1,n.settingsRepo.entryListStyle$))}}function M(e,s){if(1&e&&(t.ynx(0),t.TgZ(1,"div",1)(2,"div",2)(3,"h2"),t._uU(4),t.qZA(),t.TgZ(5,"h5",3)(6,"span"),t._uU(7),t.ALo(8,"dateDistance"),t.qZA(),t.TgZ(9,"span",4),t._uU(10,"\u2022"),t.qZA(),t.TgZ(11,"span"),t._uU(12),t.ALo(13,"date"),t.qZA()()(),t.YNc(14,J,2,0,"mat-icon",0),t.qZA(),t._UZ(15,"mat-divider",5),t.YNc(16,L,1,1,"app-score-input",6),t.YNc(17,R,3,3,"ng-container",0),t.BQk()),2&e){const n=s.ngIf,o=t.oxw();t.xp6(4),t.Oqu(n.name),t.xp6(3),t.hij(" Created: ",t.lcZ(8,6,n.date_created)," "),t.xp6(5),t.hij(" ",t.xi3(13,8,n.date_created,"short")," "),t.xp6(2),t.Q6J("ngIf",n.locked),t.xp6(2),t.Q6J("ngIf",!n.locked),t.xp6(1),t.Q6J("ngIf",o.entries.length)}}let N=(()=>{class e{constructor(n,o,r,a,l){this.router=n,this.route=o,this.archerySessionRepo=r,this.snackbar=a,this.settingsRepo=l,this.destroy$=new C.x,this.entries=[]}ngOnInit(){this.route.params.pipe((0,x.R)(this.destroy$)).subscribe(n=>{const o=n.id;o?(this.archerySessionRepo.setActiveSession(o),this.archerySessionRepo.getActiveSession()||(this.snackbar.open("The session with that ID was not found","OK"),this.router.navigateByUrl("/list"))):this.router.navigateByUrl("/list")}),this.archerySessionRepo.activeSession$.pipe((0,x.R)(this.destroy$)).subscribe(n=>{this.entries=n?.entries?[...n.entries]:[]})}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}}return e.\u0275fac=function(n){return new(n||e)(t.Y36(m.F0),t.Y36(m.gz),t.Y36(F.H),t.Y36(f.ux),t.Y36(y.i))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-active-session-page"]],standalone:!0,features:[t.jDz],decls:2,vars:3,consts:[[4,"ngIf"],[1,"title-row"],[1,"flex-column"],[1,"flex-row","align-items-center"],[2,"margin","0 4px"],[1,"margin-top-2x","margin-bottom-2x"],["class","margin-bottom-8x",3,"session","savedEntry",4,"ngIf"],[1,"margin-bottom-8x",3,"session","savedEntry"],["class","margin-bottom-8x",3,"entries",4,"ngIf"],[1,"margin-bottom-8x",3,"entries"]],template:function(n,o){1&n&&(t.YNc(0,M,18,11,"ng-container",0),t.ALo(1,"async")),2&n&&t.Q6J("ngIf",t.lcZ(1,1,o.archerySessionRepo.activeSession$))},dependencies:[p.O5,p.Ov,m.Bz,p.uU,D.n,k,b.j,I.S,f.ZX,h.t,h.d,_.Ps,_.Hw],styles:["[_nghost-%COMP%]{display:block;padding:var(--spacing-3x) var(--spacing-1x)}@media (min-width: 768px){[_nghost-%COMP%]{padding:var(--spacing-3x)}}.title-row[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;align-items:center;justify-content:space-between;gap:var(--spacing-2x)}"]}),e})()}}]);