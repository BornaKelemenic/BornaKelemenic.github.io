"use strict";(self.webpackChunkarchery_stats=self.webpackChunkarchery_stats||[]).push([[133],{133:(v,g,i)=>{i.r(g),i.d(g,{ListPageComponent:()=>j});var p=i(6895),_=i(4850),a=i(3336),t=i(4650),r=i(4859),u=i(6338),d=i(8778);let h=(()=>{class e{transform(n){return n.flat()}}return e.\u0275fac=function(n){return new(n||e)},e.\u0275pipe=t.Yjl({name:"flatten",type:e,pure:!0,standalone:!0}),e})();var C=i(2189),A=i(489),Z=i(5412),T=i(9613),x=i(9132),k=i(1331),f=i(8255);class D extends Map{constructor(s,n){super(n),this.defaultValue=s}get(s){return this.has(s)?super.get(s):this.defaultValue}}var L=i(2823),P=i(7009),U=i(3959);const M=function(e){return{session:e}};function w(e,s){if(1&e&&(t.TgZ(0,"button",12),t.NdJ("click",function(o){return o.stopPropagation()}),t.TgZ(1,"mat-icon"),t._uU(2,"more_vert"),t.qZA()()),2&e){const n=t.oxw().$implicit;t.oxw(3);const o=t.MAs(3);t.Q6J("matMenuTriggerFor",o)("matMenuTriggerData",t.VKq(2,M,n))}}const F=function(e){return["/list",e]};function O(e,s){if(1&e){const n=t.EpF();t.TgZ(0,"mat-list-item",6),t.NdJ("click",function(){const l=t.CHM(n).$implicit,m=t.oxw(3);return t.KtG(m.sessionClicked.emit(l))}),t.ALo(1,"async"),t.TgZ(2,"span",7),t._uU(3),t.qZA(),t.TgZ(4,"span",8)(5,"span",9),t.ALo(6,"date"),t._uU(7),t.ALo(8,"dateDistance"),t.qZA()(),t.TgZ(9,"span",8)(10,"span"),t._uU(11),t.qZA(),t.TgZ(12,"span",10),t._uU(13,"\u2022"),t.qZA(),t.TgZ(14,"span"),t._uU(15),t.ALo(16,"average"),t.ALo(17,"pluck"),t.ALo(18,"flatten"),t.ALo(19,"pluck"),t.qZA(),t.TgZ(20,"span",10),t._uU(21,"\u2022"),t.qZA(),t.TgZ(22,"span"),t._uU(23),t.qZA()(),t.YNc(24,w,3,4,"button",11),t.qZA()}if(2&e){const n=s.$implicit,o=s.index,c=t.oxw(3);let l;t.Udp("padding-right",c.showAction?"48px":null),t.Q6J("routerLink",t.VKq(29,F,n.id))("lines",3)("activated",n.id===(null==(l=t.lcZ(1,13,c.archerySessionRepo.activeSession$))?null:l.id)),t.xp6(3),t.AsE(" ",o+1,". ",n.name," "),t.xp6(2),t.Q6J("title",t.lcZ(6,15,n.date_created)||""),t.xp6(2),t.hij(" ",t.lcZ(8,17,n.date_created)," "),t.xp6(4),t.hij(" Arrows: ",n.numberOfArrows," "),t.xp6(4),t.hij(" Average: ",t.lcZ(16,19,t.xi3(17,21,t.lcZ(18,24,t.xi3(19,26,n.entries,"shots")),"value"))," "),t.xp6(8),t.hij(" Entires: ",n.entries.length," "),t.xp6(1),t.Q6J("ngIf",c.showAction)}}function I(e,s){if(1&e&&(t.ynx(0),t.YNc(1,O,25,31,"mat-list-item",5),t.BQk()),2&e){const n=t.oxw().ngIf;t.xp6(1),t.Q6J("ngForOf",n)}}function Y(e,s){1&e&&(t.TgZ(0,"mat-list-item")(1,"span",7),t._uU(2," No sessions "),t.qZA()())}function b(e,s){if(1&e&&(t.TgZ(0,"mat-list"),t.YNc(1,I,2,1,"ng-container",3),t.YNc(2,Y,3,0,"ng-template",null,4,t.W1O),t.qZA()),2&e){const n=s.ngIf,o=t.MAs(3);t.xp6(1),t.Q6J("ngIf",n.length)("ngIfElse",o)}}function E(e,s){if(1&e){const n=t.EpF();t.TgZ(0,"button",13),t.NdJ("click",function(){const l=t.CHM(n).session,m=t.oxw();return t.KtG(m.onLockClicked(l))}),t.TgZ(1,"mat-icon"),t._uU(2),t.qZA(),t.TgZ(3,"span"),t._uU(4),t.qZA()(),t.TgZ(5,"button",13),t.NdJ("click",function(){const l=t.CHM(n).session,m=t.oxw();return t.KtG(m.onExportClicked(l))}),t.TgZ(6,"mat-icon"),t._uU(7,"file_download"),t.qZA(),t.TgZ(8,"span"),t._uU(9,"Export/Save CSV"),t.qZA()(),t.TgZ(10,"button",13),t.NdJ("click",function(){const l=t.CHM(n).session,m=t.oxw();return t.KtG(m.removeArcherySession(l))}),t.TgZ(11,"mat-icon",14),t._uU(12,"delete_outline"),t.qZA(),t.TgZ(13,"span"),t._uU(14,"Delete session"),t.qZA()()}if(2&e){const n=s.session,o=t.oxw();t.xp6(2),t.hij(" ",o.typeCastToArcherySession(n).locked?"lock":"lock_open"," "),t.xp6(2),t.hij(" ",o.typeCastToArcherySession(n).locked?"Locked":"Unlocked"," ")}}let J=(()=>{class e{constructor(n,o,c,l){this.archerySessionRepo=n,this.dialog=o,this.snackbar=c,this.papa=l,this.showAction=!0,this.sessionClicked=new t.vpe}typeCastToArcherySession(n){return n}removeArcherySession(n){n?this.dialog.open(T.M,{restoreFocus:!1,autoFocus:!1,width:"300px",data:{title:"Delete session ?"}}).afterClosed().subscribe(c=>{c&&(0,k.xr)(()=>{this.archerySessionRepo.getActiveSession()?.id===n.id&&this.archerySessionRepo.resetActiveSession(),this.archerySessionRepo.deleteSessions(n.id)})}):this.snackbar.open("Session data missing","OK")}onExportClicked(n){const o=function S(e){return e.entries.map(s=>s.shots.map(n=>n.value))}(n);!function y(e,s,n="text"){if(navigator.msSaveBlob)navigator.msSaveOrOpenBlob(new Blob([e],{type:n}),s);else{const o=window.document.createElement("a");o.href=window.URL.createObjectURL(new Blob([e],{type:n})),o.download=s,document.body.appendChild(o),o.click(),document.body.removeChild(o)}}(this.papa.unparse(o),n.name,"text/csv")}onLockClicked(n){this.archerySessionRepo.toggleLockForSession(n)}}return e.\u0275fac=function(n){return new(n||e)(t.Y36(L.H),t.Y36(Z.uw),t.Y36(P.ux),t.Y36(U.N))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-session-list"]],inputs:{showAction:"showAction"},outputs:{sessionClicked:"sessionClicked"},standalone:!0,features:[t.jDz],decls:5,vars:3,consts:[[4,"ngIf"],["actionMenu","matMenu"],["matMenuContent",""],[4,"ngIf","ngIfElse"],["noSessions",""],[3,"routerLink","lines","activated","padding-right","click",4,"ngFor","ngForOf"],[3,"routerLink","lines","activated","click"],["matListItemTitle",""],["matListItemLine",""],[3,"title"],[2,"margin","0 4px"],["class","action","mat-icon-button","",3,"matMenuTriggerFor","matMenuTriggerData","click",4,"ngIf"],["mat-icon-button","",1,"action",3,"matMenuTriggerFor","matMenuTriggerData","click"],["mat-menu-item","",3,"click"],["color","warn"]],template:function(n,o){1&n&&(t.YNc(0,b,4,2,"mat-list",0),t.ALo(1,"async"),t.TgZ(2,"mat-menu",null,1),t.YNc(4,E,15,2,"ng-template",2),t.qZA()),2&n&&t.Q6J("ngIf",t.lcZ(1,1,o.archerySessionRepo.sessions$))},dependencies:[p.ax,p.O5,p.Ov,p.uU,d.n,h,C.F,A.p,x.Bz,x.rH,u.ie,u.i$,u.Tg,u.WW,u.sL,a.Ps,a.Hw,r.ot,r.RK,Z.Is,f.Tx,f.VK,f.OP,f.KA,f.p6],styles:["[_nghost-%COMP%]{display:block}mat-list-item[_ngcontent-%COMP%]{cursor:pointer!important}mat-list-item[_ngcontent-%COMP%]:hover:not(.mdc-list-item--activated){background-color:var(--list-item-hover-background)}"]}),e})();function N(e,s){if(1&e&&(t.ynx(0),t.TgZ(1,"div",1)(2,"h2"),t._uU(3),t.qZA()(),t._UZ(4,"mat-divider",2),t.TgZ(5,"h3"),t._uU(6),t.ALo(7,"average"),t.ALo(8,"pluck"),t.ALo(9,"flatten"),t.ALo(10,"pluck"),t.ALo(11,"flatten"),t.ALo(12,"pluck"),t.qZA(),t._UZ(13,"mat-divider",2),t.BQk()),2&e){const n=t.oxw().ngIf;t.xp6(3),t.hij("Your sessions (",n.length,"):"),t.xp6(3),t.hij(" Your overall average: ",t.lcZ(7,2,t.xi3(8,4,t.lcZ(9,7,t.xi3(10,9,t.lcZ(11,12,t.xi3(12,14,n,"entries")),"shots")),"value"))," ")}}function R(e,s){1&e&&(t.ynx(0),t.TgZ(1,"div",2)(2,"a",3)(3,"mat-icon"),t._uU(4,"add"),t.qZA(),t._uU(5," Create a new session "),t.qZA()(),t.BQk()),2&e&&(t.xp6(2),t.Q6J("routerLink","/new"))}function Q(e,s){if(1&e&&(t.ynx(0),t.YNc(1,N,14,17,"ng-container",0),t._UZ(2,"app-session-list"),t.YNc(3,R,6,1,"ng-container",0),t.BQk()),2&e){const n=s.ngIf;t.xp6(1),t.Q6J("ngIf",n.length),t.xp6(2),t.Q6J("ngIf",!n.length)}}let j=(()=>{class e{constructor(n){this.archerySessionRepo=n}}return e.\u0275fac=function(n){return new(n||e)(t.Y36(L.H))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-list-page"]],standalone:!0,features:[t.jDz],decls:2,vars:3,consts:[[4,"ngIf"],[1,"margin-bottom-2x","flex-row"],[1,"margin-y-2x"],["mat-stroked-button","",3,"routerLink"]],template:function(n,o){1&n&&(t.YNc(0,Q,4,2,"ng-container",0),t.ALo(1,"async")),2&n&&t.Q6J("ngIf",t.lcZ(1,1,o.archerySessionRepo.sessions$))},dependencies:[p.O5,p.Ov,C.F,h,A.p,x.Bz,x.rH,J,_.t,_.d,a.Ps,a.Hw,r.ot,r.zs],styles:["[_nghost-%COMP%]{display:block;padding:var(--spacing-3x) var(--spacing-1x)}@media (min-width: 768px){[_nghost-%COMP%]{padding:var(--spacing-3x)}}"]}),e})()},489:(v,g,i)=>{i.d(g,{p:()=>_});var p=i(4650);let _=(()=>{class a{transform(r,u=2){return r&&r.length?(r.reduce((d,h)=>d+h,0)/r.length).toFixed(u):"0"}}return a.\u0275fac=function(r){return new(r||a)},a.\u0275pipe=p.Yjl({name:"average",type:a,pure:!0,standalone:!0}),a})()},2189:(v,g,i)=>{i.d(g,{F:()=>_});var p=i(4650);let _=(()=>{class a{transform(r,u){return r&&u?r.map(d=>d[u]):[]}}return a.\u0275fac=function(r){return new(r||a)},a.\u0275pipe=p.Yjl({name:"pluck",type:a,pure:!0,standalone:!0}),a})()}}]);