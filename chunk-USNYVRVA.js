import{b as ct,e as mt,f as ut,g as pt,h as dt}from"./chunk-LDZW5IQA.js";import{c as st}from"./chunk-4S7A2FOW.js";import{a as lt}from"./chunk-DWNUXYHK.js";import"./chunk-KSH4XKSQ.js";import{b as z,c as J,d as X,f as Y,g as Z,h as tt}from"./chunk-PQ5KA4QR.js";import{a as rt}from"./chunk-HWTWGKEY.js";import{a as b,c as d,i as E,k as ot,o as k,q as it,t as at}from"./chunk-OLK2YL67.js";import{a as W,c as H,e as K}from"./chunk-PLJUC4GA.js";import{$a as _,Bb as $,Dd as et,Eb as v,Ed as nt,Fb as j,Gb as M,Ka as V,Pa as u,V as P,Xa as y,Ya as x,Z as T,Za as o,_ as D,_a as i,a as I,ab as B,b as A,bb as F,cc as N,db as h,ec as G,f as c,fa as C,ga as f,gb as g,ib as p,p as w,tb as s,td as Q,ub as O,va as a,vb as S,xb as L,xd as U,yd as q,zc as R}from"./chunk-F55HGIM7.js";var Ct=(()=>{class n{constructor(){this.entries$=w(b(()=>d.arrowCountEntries.orderBy("date").reverse().toArray())),this.entriesGroupedByDate$=w(b(()=>c(this,null,function*(){return(yield d.arrowCountEntries.orderBy("date").reverse().toArray()).reduce((e,r)=>{let m=new Date(r.date).toISOString().split("T")[0];return e[m]||(e[m]=[]),e[m].push({id:r.id,value:r.value}),e},{})})))}addEntry(t){return c(this,null,function*(){return yield d.arrowCountEntries.add(A(I({},t),{date:new Date().toISOString()}))})}deleteEntry(t){return c(this,null,function*(){return yield d.arrowCountEntries.delete(t)})}static{this.\u0275fac=function(e){return new(e||n)}}static{this.\u0275prov=P({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();var gt=(n,l)=>l.key,vt=(n,l)=>l.id;function wt(n,l){if(n&1){let t=h();o(0,"mat-list-item"),s(1),o(2,"button",11),g("click",function(){let r=C(t).$implicit,m=p(3);return f(m.arrowCountEntriesService.deleteEntry(r.id))}),o(3,"mat-icon"),s(4,"delete"),i()()()}if(n&2){let t=l.$implicit;a(),S(" ",t.value," ")}}function yt(n,l){if(n&1&&(o(0,"div",10),s(1),v(2,"date"),i(),y(3,wt,5,1,"mat-list-item",null,vt)),n&2){let t=l.$implicit;a(),S(" ",M(2,1,t.key,"longDate")," "),a(2),x(t.value)}}function xt(n,l){if(n&1){let t=h();B(0),o(1,"app-page-with-title",1)(2,"mat-card")(3,"mat-card-header")(4,"mat-card-title"),s(5),i()(),o(6,"mat-card-content")(7,"div",2)(8,"div",3)(9,"span"),s(10,"Shooting:"),i(),_(11,"app-small-counter",4),i(),o(12,"div",5)(13,"span"),s(14,"Count:"),i(),_(15,"app-small-counter",6),i()()(),o(16,"mat-card-actions")(17,"button",7),g("click",function(){C(t);let r=p();return f(r.countControl.reset())}),s(18,"Reset count"),i(),_(19,"span",8),o(20,"button",9),g("click",function(){C(t);let r=p();return f(r.saveCount())}),s(21," Save count "),i()()(),L(22),v(23,"async"),v(24,"keyvalue"),o(25,"mat-list"),y(26,yt,5,4,null,null,gt),i()(),F()}if(n&2){let t=l.$implicit,e=p();a(),u("page-title",t("navbar.arrowCounter")),a(4),O(t("navbar.arrowCounter")),a(6),u("formControl",e.shootingCountControl)("min",1),a(4),u("moreIncrementAmount",e.shootingCountControl.value)("formControl",e.countControl)("min",0),a(5),u("disabled",e.countControl.invalid);let r=M(24,10,j(23,8,e.arrowCountEntriesService.entriesGroupedByDate$),e.originalOrder);a(6),x(r)}}var ft="archery-stats-arrow-count-value",zt=(()=>{class n{constructor(){this.arrowCountEntriesService=T(Ct),this.shootingCountControl=new k(6,{nonNullable:!0,validators:[E.min(1)]}),this.countControl=new k(0,{nonNullable:!0,validators:[E.min(0)]}),this.originalOrder=()=>0;let t=sessionStorage.getItem(ft);t&&this.countControl.setValue(R(t,0),{emitEvent:!1}),this.countControl.valueChanges.pipe(Q()).subscribe({next:e=>sessionStorage.setItem(ft,e.toString())})}saveCount(){return c(this,null,function*(){yield this.arrowCountEntriesService.addEntry({value:this.countControl.value}),this.countControl.reset()})}static{this.\u0275fac=function(e){return new(e||n)}}static{this.\u0275cmp=D({type:n,selectors:[["app-arrow-counter-page"]],standalone:!0,features:[$],decls:1,vars:0,consts:[[4,"transloco"],["page-back-link","/",3,"page-title"],[1,"padding-y-4x"],[1,"flex-row","align-items-center","justify-content-space-between"],["disableControlsWhenOverLimit","",3,"formControl","min"],[1,"flex-row","align-items-center","justify-content-space-between","margin-top-4x"],["moreIncrements","","disableControlsWhenOverLimit","",3,"moreIncrementAmount","formControl","min"],["mat-button","","color","warn",3,"click"],[1,"spacer"],["mat-flat-button","",3,"click","disabled"],["matSubheader",""],["matListItemMeta","","mat-icon-button","",3,"click"]],template:function(e,r){e&1&&V(0,xt,28,13,"ng-container",0)},dependencies:[N,G,q,U,at,ot,it,st,rt,lt,dt,mt,ut,pt,ct,tt,z,Y,X,Z,J,K,W,H,nt,et],styles:["[_nghost-%COMP%]{display:block}mat-card[_ngcontent-%COMP%], mat-list[_ngcontent-%COMP%]{margin:0 auto;max-width:600px}"],changeDetection:0})}}return n})();export{zt as ArrowCounterPageComponent};
