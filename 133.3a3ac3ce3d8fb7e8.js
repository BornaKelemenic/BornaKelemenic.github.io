"use strict";(self.webpackChunkarchery_stats=self.webpackChunkarchery_stats||[]).push([[133],{133:(v,m,o)=>{o.r(m),o.d(m,{ListPageComponent:()=>D});var l=o(6895),g=o(4850),a=o(3336),t=o(4650),r=o(4859),p=o(6338),d=o(8778);let h=(()=>{class e{transform(n){return n.flat()}}return e.\u0275fac=function(n){return new(n||e)},e.\u0275pipe=t.Yjl({name:"flatten",type:e,pure:!0,standalone:!0}),e})();var A=o(2189),Z=o(489),C=o(5412),T=o(9613),x=o(9132),y=o(1331),_=o(8255);class j extends Map{constructor(s,n){super(n),this.defaultValue=s}get(s){return this.has(s)?super.get(s):this.defaultValue}}var L=o(2823),P=o(7009),M=o(3959);const U=function(e){return{session:e}};function F(e,s){if(1&e&&(t.TgZ(0,"button",12),t.NdJ("click",function(i){return i.stopPropagation()}),t.TgZ(1,"mat-icon"),t._uU(2,"more_vert"),t.qZA()()),2&e){const n=t.oxw().$implicit;t.oxw(3);const i=t.MAs(3);t.Q6J("matMenuTriggerFor",i)("matMenuTriggerData",t.VKq(2,U,n))}}const w=function(e){return["/list",e]};function O(e,s){if(1&e){const n=t.EpF();t.TgZ(0,"mat-list-item",6),t.NdJ("click",function(){const u=t.CHM(n).$implicit,f=t.oxw(3);return t.KtG(f.sessionClicked.emit(u))}),t.ALo(1,"async"),t.TgZ(2,"span",7),t._uU(3),t.qZA(),t.TgZ(4,"span",8)(5,"span",9),t.ALo(6,"date"),t._uU(7),t.ALo(8,"dateDistance"),t.qZA()(),t.TgZ(9,"span",8)(10,"span"),t._uU(11),t.qZA(),t.TgZ(12,"span",10),t._uU(13,"\u2022"),t.qZA(),t.TgZ(14,"span"),t._uU(15),t.ALo(16,"average"),t.ALo(17,"pluck"),t.ALo(18,"flatten"),t.ALo(19,"pluck"),t.qZA(),t.TgZ(20,"span",10),t._uU(21,"\u2022"),t.qZA(),t.TgZ(22,"span"),t._uU(23),t.qZA()(),t.YNc(24,F,3,4,"button",11),t.qZA()}if(2&e){const n=s.$implicit,i=s.index,c=t.oxw(3);let u;t.Udp("padding-right",c.showAction?"48px":null),t.Q6J("routerLink",t.VKq(29,w,n.id))("lines",3)("activated",n.id===(null==(u=t.lcZ(1,13,c.archerySessionRepo.activeSession$))?null:u.id)),t.xp6(3),t.AsE(" ",i+1,". ",n.name," "),t.xp6(2),t.Q6J("title",t.lcZ(6,15,n.date_created)||""),t.xp6(2),t.hij(" ",t.lcZ(8,17,n.date_created)," "),t.xp6(4),t.hij(" Arrows: ",n.numberOfArrows," "),t.xp6(4),t.hij(" Average: ",t.lcZ(16,19,t.xi3(17,21,t.lcZ(18,24,t.xi3(19,26,n.entries,"shots")),"value"))," "),t.xp6(8),t.hij(" Entires: ",n.entries.length," "),t.xp6(1),t.Q6J("ngIf",c.showAction)}}function I(e,s){if(1&e&&(t.ynx(0),t.YNc(1,O,25,31,"mat-list-item",5),t.BQk()),2&e){const n=t.oxw().ngIf;t.xp6(1),t.Q6J("ngForOf",n)}}function Y(e,s){1&e&&(t.TgZ(0,"mat-list-item")(1,"span",7),t._uU(2," No sessions "),t.qZA()())}function E(e,s){if(1&e&&(t.TgZ(0,"mat-list"),t.YNc(1,I,2,1,"ng-container",3),t.YNc(2,Y,3,0,"ng-template",null,4,t.W1O),t.qZA()),2&e){const n=s.ngIf,i=t.MAs(3);t.xp6(1),t.Q6J("ngIf",n.length)("ngIfElse",i)}}function b(e,s){if(1&e){const n=t.EpF();t.TgZ(0,"button",13),t.NdJ("click",function(){const u=t.CHM(n).session,f=t.oxw();return t.KtG(f.onExportClicked(u))}),t.TgZ(1,"mat-icon"),t._uU(2,"file_download"),t.qZA(),t.TgZ(3,"span"),t._uU(4,"Export/Save CSV"),t.qZA()(),t.TgZ(5,"button",13),t.NdJ("click",function(){const u=t.CHM(n).session,f=t.oxw();return t.KtG(f.removeArcherySession(u))}),t.TgZ(6,"mat-icon",14),t._uU(7,"delete_outline"),t.qZA(),t.TgZ(8,"span"),t._uU(9,"Delete session"),t.qZA()()}}let J=(()=>{class e{constructor(n,i,c,u){this.archerySessionRepo=n,this.dialog=i,this.snackbar=c,this.papa=u,this.showAction=!0,this.sessionClicked=new t.vpe}removeArcherySession(n){n?this.dialog.open(T.M,{restoreFocus:!1,autoFocus:!1,width:"300px",data:{title:"Delete session ?"}}).afterClosed().subscribe(c=>{c&&(0,y.xr)(()=>{this.archerySessionRepo.getActiveSession()?.id===n.id&&this.archerySessionRepo.resetActiveSession(),this.archerySessionRepo.deleteSessions(n.id)})}):this.snackbar.open("Session data missing","OK")}onExportClicked(n){const i=function k(e){return e.entries.map(s=>s.shots.map(n=>n.value))}(n);!function S(e,s,n="text"){if(navigator.msSaveBlob)navigator.msSaveOrOpenBlob(new Blob([e],{type:n}),s);else{const i=window.document.createElement("a");i.href=window.URL.createObjectURL(new Blob([e],{type:n})),i.download=s,document.body.appendChild(i),i.click(),document.body.removeChild(i)}}(this.papa.unparse(i),n.name,"text/csv")}}return e.\u0275fac=function(n){return new(n||e)(t.Y36(L.H),t.Y36(C.uw),t.Y36(P.ux),t.Y36(M.N))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-session-list"]],inputs:{showAction:"showAction"},outputs:{sessionClicked:"sessionClicked"},standalone:!0,features:[t.jDz],decls:5,vars:3,consts:[[4,"ngIf"],["actionMenu","matMenu"],["matMenuContent",""],[4,"ngIf","ngIfElse"],["noSessions",""],[3,"routerLink","lines","activated","padding-right","click",4,"ngFor","ngForOf"],[3,"routerLink","lines","activated","click"],["matListItemTitle",""],["matListItemLine",""],[3,"title"],[2,"margin","0 4px"],["class","action","mat-icon-button","",3,"matMenuTriggerFor","matMenuTriggerData","click",4,"ngIf"],["mat-icon-button","",1,"action",3,"matMenuTriggerFor","matMenuTriggerData","click"],["mat-menu-item","",3,"click"],["color","warn"]],template:function(n,i){1&n&&(t.YNc(0,E,4,2,"mat-list",0),t.ALo(1,"async"),t.TgZ(2,"mat-menu",null,1),t.YNc(4,b,10,0,"ng-template",2),t.qZA()),2&n&&t.Q6J("ngIf",t.lcZ(1,1,i.archerySessionRepo.sessions$))},dependencies:[l.ax,l.O5,l.Ov,l.uU,d.n,h,A.F,Z.p,x.Bz,x.rH,p.ie,p.i$,p.Tg,p.WW,p.sL,a.Ps,a.Hw,r.ot,r.RK,C.Is,_.Tx,_.VK,_.OP,_.KA,_.p6],styles:["[_nghost-%COMP%]{display:block}mat-list-item[_ngcontent-%COMP%]{cursor:pointer!important}mat-list-item[_ngcontent-%COMP%]:hover:not(.mdc-list-item--activated){background-color:var(--list-item-hover-background)}"]}),e})();function N(e,s){if(1&e&&(t.ynx(0),t.TgZ(1,"div",1)(2,"h2"),t._uU(3),t.qZA()(),t._UZ(4,"mat-divider",2),t.TgZ(5,"h3"),t._uU(6),t.ALo(7,"average"),t.ALo(8,"pluck"),t.ALo(9,"flatten"),t.ALo(10,"pluck"),t.ALo(11,"flatten"),t.ALo(12,"pluck"),t.qZA(),t._UZ(13,"mat-divider",2),t.BQk()),2&e){const n=t.oxw().ngIf;t.xp6(3),t.hij("Your sessions (",n.length,"):"),t.xp6(3),t.hij(" Your overall average: ",t.lcZ(7,2,t.xi3(8,4,t.lcZ(9,7,t.xi3(10,9,t.lcZ(11,12,t.xi3(12,14,n,"entries")),"shots")),"value"))," ")}}function Q(e,s){1&e&&(t.ynx(0),t.TgZ(1,"div",2)(2,"a",3)(3,"mat-icon"),t._uU(4,"add"),t.qZA(),t._uU(5," Create a new session "),t.qZA()(),t.BQk()),2&e&&(t.xp6(2),t.Q6J("routerLink","/new"))}function R(e,s){if(1&e&&(t.ynx(0),t.YNc(1,N,14,17,"ng-container",0),t._UZ(2,"app-session-list"),t.YNc(3,Q,6,1,"ng-container",0),t.BQk()),2&e){const n=s.ngIf;t.xp6(1),t.Q6J("ngIf",n.length),t.xp6(2),t.Q6J("ngIf",!n.length)}}let D=(()=>{class e{constructor(n){this.archerySessionRepo=n}}return e.\u0275fac=function(n){return new(n||e)(t.Y36(L.H))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-list-page"]],standalone:!0,features:[t.jDz],decls:2,vars:3,consts:[[4,"ngIf"],[1,"margin-bottom-2x","flex-row"],[1,"margin-y-2x"],["mat-stroked-button","",3,"routerLink"]],template:function(n,i){1&n&&(t.YNc(0,R,4,2,"ng-container",0),t.ALo(1,"async")),2&n&&t.Q6J("ngIf",t.lcZ(1,1,i.archerySessionRepo.sessions$))},dependencies:[l.O5,l.Ov,A.F,h,Z.p,x.Bz,x.rH,J,g.t,g.d,a.Ps,a.Hw,r.ot,r.zs],styles:["[_nghost-%COMP%]{display:block;padding:var(--spacing-3x) var(--spacing-1x)}@media (min-width: 768px){[_nghost-%COMP%]{padding:var(--spacing-3x)}}"]}),e})()},489:(v,m,o)=>{o.d(m,{p:()=>g});var l=o(4650);let g=(()=>{class a{transform(r,p=2){return r&&r.length?(r.reduce((d,h)=>d+h,0)/r.length).toFixed(p):"0"}}return a.\u0275fac=function(r){return new(r||a)},a.\u0275pipe=l.Yjl({name:"average",type:a,pure:!0,standalone:!0}),a})()},2189:(v,m,o)=>{o.d(m,{F:()=>g});var l=o(4650);let g=(()=>{class a{transform(r,p){return r&&p?r.map(d=>d[p]):[]}}return a.\u0275fac=function(r){return new(r||a)},a.\u0275pipe=l.Yjl({name:"pluck",type:a,pure:!0,standalone:!0}),a})()}}]);