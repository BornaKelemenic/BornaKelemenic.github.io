(self.webpackChunkarchery_stats=self.webpackChunkarchery_stats||[]).push([[559],{5559:(ze,Ne,k)=>{"use strict";k.r(Ne),k.d(Ne,{ArcheryScorePageComponent:()=>Ie});var K=k(6895),V=k(4859),X=k(6319),F=k(4850),ie=k(3336),ve=k(7521);function ge(n,s,t,o,i,c,d){try{var w=n[c](d),x=w.value}catch(re){return void t(re)}w.done?s(x):Promise.resolve(x).then(o,i)}var m=k(1281),he=k(6338),W=k(4298),e=k(4650),Re=k(3028),ye=k.t(Re,2);let ke=(()=>{class n{constructor(){this._papa=ye}parse(t,o){return this._papa.parse(t,o)}unparse(t,o){return this._papa.unparse(t,o)}setLocalChunkSize(t){this._papa.LocalChunkSize=t}setRemoteChunkSize(t){this._papa.RemoteChunkSize=t}setDefaultDelimiter(t){this._papa.DefaultDelimiter=t}get badDelimiters(){return this._papa.BAD_DELIMITERS}get recordSeparator(){return this._papa.RECORD_SEP}get unitSeparator(){return this._papa.UNIT_SEP}get workersSupported(){return this._papa.WORKERS_SUPPORTED}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();var De=k(9229);const Ce=["fileInput"];function Se(n,s){if(1&n){const t=e.EpF();e.TgZ(0,"mat-list-item",10)(1,"h3"),e._uU(2),e.qZA(),e.TgZ(3,"button",11),e.NdJ("click",function(){const c=e.CHM(t).index,d=e.oxw(2);return e.KtG(d.removeFileFromList(c))}),e.TgZ(4,"mat-icon"),e._uU(5,"remove"),e.qZA()()()}if(2&n){const t=s.$implicit;e.Q6J("lines",1),e.xp6(2),e.Oqu(t.name)}}function Ue(n,s){if(1&n&&(e.TgZ(0,"mat-list"),e.YNc(1,Se,6,2,"mat-list-item",9),e.qZA()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("ngForOf",t.fileList)}}function Ze(n,s){if(1&n){const t=e.EpF();e.TgZ(0,"button",12),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.importFiles())}),e._uU(1," Import "),e.qZA()}}class fe{constructor(s,t,o){this.dialogRef=s,this.papa=t,this.archerySessionRepo=o,this.fileList=[]}processCsvData(s,t){const o=[];s.forEach(c=>{const d=[];c.forEach(w=>{w&&d.push((0,W.Ey)({value:(0,m.su)(w)}))}),o.push((0,W.Yo)({shots:d}))});const i=o.reduce((c,d)=>d.shots.length>c.length?d.shots:c,[]);return(0,W.ed)({name:t.name,entries:o,numberOfArrows:i.length})}removeFileFromList(s){this.fileList.splice(s,1)}onFileSelect(s){const t=s.target.files;t?.length&&(this.fileList=[...this.fileList,...Array.from(t)]),this.fileInput.nativeElement.value=""}importFiles(){var s=this;return function Be(n){return function(){var s=this,t=arguments;return new Promise(function(o,i){var c=n.apply(s,t);function d(x){ge(c,o,i,d,w,"next",x)}function w(x){ge(c,o,i,d,w,"throw",x)}d(void 0)})}}(function*(){try{const t=yield Promise.all(s.fileList.map(o=>new Promise((i,c)=>s.papa.parse(o,{complete:d=>{i(s.processCsvData(d.data,o))},error:c}))));s.archerySessionRepo.addSessions(t),s.dialogRef.close()}catch(t){console.error(t)}})()}}fe.\u0275fac=function(s){return new(s||fe)(e.Y36(X.so),e.Y36(ke),e.Y36(De.H))},fe.\u0275cmp=e.Xpm({type:fe,selectors:[["app-import-csv-session"]],viewQuery:function(s,t){if(1&s&&e.Gf(Ce,5),2&s){let o;e.iGM(o=e.CRH())&&(t.fileInput=o.first)}},standalone:!0,features:[e.jDz],decls:18,vars:2,consts:[["mat-dialog-title",""],["hidden","","type","file","name","file","multiple","","accept",".csv",3,"change"],["fileInput",""],[1,"flex-column"],["mat-stroked-button","","color","primary",1,"margin-bottom-2x",3,"click"],[4,"ngIf"],["mat-button","","mat-dialog-close",""],[1,"spacer"],["mat-raised-button","","color","primary",3,"click",4,"ngIf"],[3,"lines",4,"ngFor","ngForOf"],[3,"lines"],["mat-icon-button","",1,"action",3,"click"],["mat-raised-button","","color","primary",3,"click"]],template:function(s,t){if(1&s){const o=e.EpF();e.TgZ(0,"h2",0),e._uU(1,"Import a session from a CSV format"),e.qZA(),e.TgZ(2,"mat-dialog-content")(3,"p"),e._uU(4," It should be in a simple format where each shot is separated by a semicolon and each row is one entry "),e.qZA(),e.TgZ(5,"input",1,2),e.NdJ("change",function(c){return t.onFileSelect(c)}),e.qZA(),e.TgZ(7,"div",3)(8,"button",4),e.NdJ("click",function(){e.CHM(o);const c=e.MAs(6);return e.KtG(c.click())}),e.TgZ(9,"mat-icon"),e._uU(10,"upload"),e.qZA(),e._uU(11," Upload files "),e.qZA(),e.YNc(12,Ue,2,1,"mat-list",5),e.qZA()(),e.TgZ(13,"mat-dialog-actions")(14,"button",6),e._uU(15,"Cancel"),e.qZA(),e._UZ(16,"span",7),e.YNc(17,Ze,2,0,"button",8),e.qZA()}2&s&&(e.xp6(12),e.Q6J("ngIf",t.fileList.length),e.xp6(5),e.Q6J("ngIf",t.fileList.length))},dependencies:[K.O5,K.ax,X.Is,X.ZT,X.uh,X.xY,X.H8,V.ot,V.lW,V.RK,ie.Ps,ie.Hw,he.ie,he.i$,he.Tg]});var be=k(445),q=k(5017),A=k(3353),a=k(1218),r=k(7579),l=k(2076),h=k(1135),p=k(9751),C=k(576),P=k(9646),T=k(2722),f=k(5698);const N=[[["caption"]],[["colgroup"],["col"]]],g=["caption","colgroup, col"];function u(n){return class extends n{get sticky(){return this._sticky}set sticky(s){const t=this._sticky;this._sticky=(0,m.Ig)(s),this._hasStickyChanged=t!==this._sticky}hasStickyChanged(){const s=this._hasStickyChanged;return this._hasStickyChanged=!1,s}resetStickyChanged(){this._hasStickyChanged=!1}constructor(...s){super(...s),this._sticky=!1,this._hasStickyChanged=!1}}}const b=new e.OlP("CDK_TABLE");let E=(()=>{class n{constructor(t){this.template=t}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(e.Rgc))},n.\u0275dir=e.lG2({type:n,selectors:[["","cdkCellDef",""]]}),n})(),Z=(()=>{class n{constructor(t){this.template=t}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(e.Rgc))},n.\u0275dir=e.lG2({type:n,selectors:[["","cdkHeaderCellDef",""]]}),n})(),L=(()=>{class n{constructor(t){this.template=t}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(e.Rgc))},n.\u0275dir=e.lG2({type:n,selectors:[["","cdkFooterCellDef",""]]}),n})();class H{}const _=u(H);let v=(()=>{class n extends _{get name(){return this._name}set name(t){this._setNameInput(t)}get stickyEnd(){return this._stickyEnd}set stickyEnd(t){const o=this._stickyEnd;this._stickyEnd=(0,m.Ig)(t),this._hasStickyChanged=o!==this._stickyEnd}constructor(t){super(),this._table=t,this._stickyEnd=!1}_updateColumnCssClassName(){this._columnCssClassName=[`cdk-column-${this.cssClassFriendlyName}`]}_setNameInput(t){t&&(this._name=t,this.cssClassFriendlyName=t.replace(/[^a-z0-9_-]/gi,"-"),this._updateColumnCssClassName())}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(b,8))},n.\u0275dir=e.lG2({type:n,selectors:[["","cdkColumnDef",""]],contentQueries:function(t,o,i){if(1&t&&(e.Suo(i,E,5),e.Suo(i,Z,5),e.Suo(i,L,5)),2&t){let c;e.iGM(c=e.CRH())&&(o.cell=c.first),e.iGM(c=e.CRH())&&(o.headerCell=c.first),e.iGM(c=e.CRH())&&(o.footerCell=c.first)}},inputs:{sticky:"sticky",name:["cdkColumnDef","name"],stickyEnd:"stickyEnd"},features:[e._Bn([{provide:"MAT_SORT_HEADER_COLUMN_DEF",useExisting:n}]),e.qOj]}),n})();class O{constructor(s,t){t.nativeElement.classList.add(...s._columnCssClassName)}}let M=(()=>{class n extends O{constructor(t,o){super(t,o)}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(v),e.Y36(e.SBq))},n.\u0275dir=e.lG2({type:n,selectors:[["cdk-header-cell"],["th","cdk-header-cell",""]],hostAttrs:["role","columnheader",1,"cdk-header-cell"],features:[e.qOj]}),n})(),R=(()=>{class n extends O{constructor(t,o){if(super(t,o),1===t._table?._elementRef.nativeElement.nodeType){const i=t._table._elementRef.nativeElement.getAttribute("role");o.nativeElement.setAttribute("role","grid"===i||"treegrid"===i?"gridcell":"cell")}}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(v),e.Y36(e.SBq))},n.\u0275dir=e.lG2({type:n,selectors:[["cdk-footer-cell"],["td","cdk-footer-cell",""]],hostAttrs:[1,"cdk-footer-cell"],features:[e.qOj]}),n})(),S=(()=>{class n extends O{constructor(t,o){if(super(t,o),1===t._table?._elementRef.nativeElement.nodeType){const i=t._table._elementRef.nativeElement.getAttribute("role");o.nativeElement.setAttribute("role","grid"===i||"treegrid"===i?"gridcell":"cell")}}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(v),e.Y36(e.SBq))},n.\u0275dir=e.lG2({type:n,selectors:[["cdk-cell"],["td","cdk-cell",""]],hostAttrs:[1,"cdk-cell"],features:[e.qOj]}),n})();class I{constructor(){this.tasks=[],this.endTasks=[]}}const y=new e.OlP("_COALESCED_STYLE_SCHEDULER");let ce=(()=>{class n{constructor(t){this._ngZone=t,this._currentSchedule=null,this._destroyed=new r.x}schedule(t){this._createScheduleIfNeeded(),this._currentSchedule.tasks.push(t)}scheduleEnd(t){this._createScheduleIfNeeded(),this._currentSchedule.endTasks.push(t)}ngOnDestroy(){this._destroyed.next(),this._destroyed.complete()}_createScheduleIfNeeded(){this._currentSchedule||(this._currentSchedule=new I,this._getScheduleObservable().pipe((0,T.R)(this._destroyed)).subscribe(()=>{for(;this._currentSchedule.tasks.length||this._currentSchedule.endTasks.length;){const t=this._currentSchedule;this._currentSchedule=new I;for(const o of t.tasks)o();for(const o of t.endTasks)o()}this._currentSchedule=null}))}_getScheduleObservable(){return this._ngZone.isStable?(0,l.D)(Promise.resolve(void 0)):this._ngZone.onStable.pipe((0,f.q)(1))}}return n.\u0275fac=function(t){return new(t||n)(e.LFG(e.R0b))},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac}),n})(),Q=(()=>{class n{constructor(t,o){this.template=t,this._differs=o}ngOnChanges(t){if(!this._columnsDiffer){const o=t.columns&&t.columns.currentValue||[];this._columnsDiffer=this._differs.find(o).create(),this._columnsDiffer.diff(o)}}getColumnsDiff(){return this._columnsDiffer.diff(this.columns)}extractCellTemplate(t){return this instanceof z?t.headerCell.template:this instanceof B?t.footerCell.template:t.cell.template}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(e.Rgc),e.Y36(e.ZZ4))},n.\u0275dir=e.lG2({type:n,features:[e.TTD]}),n})();class le extends Q{}const se=u(le);let z=(()=>{class n extends se{constructor(t,o,i){super(t,o),this._table=i}ngOnChanges(t){super.ngOnChanges(t)}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(e.Rgc),e.Y36(e.ZZ4),e.Y36(b,8))},n.\u0275dir=e.lG2({type:n,selectors:[["","cdkHeaderRowDef",""]],inputs:{columns:["cdkHeaderRowDef","columns"],sticky:["cdkHeaderRowDefSticky","sticky"]},features:[e.qOj,e.TTD]}),n})();class j extends Q{}const de=u(j);let B=(()=>{class n extends de{constructor(t,o,i){super(t,o),this._table=i}ngOnChanges(t){super.ngOnChanges(t)}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(e.Rgc),e.Y36(e.ZZ4),e.Y36(b,8))},n.\u0275dir=e.lG2({type:n,selectors:[["","cdkFooterRowDef",""]],inputs:{columns:["cdkFooterRowDef","columns"],sticky:["cdkFooterRowDefSticky","sticky"]},features:[e.qOj,e.TTD]}),n})(),ue=(()=>{class n extends Q{constructor(t,o,i){super(t,o),this._table=i}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(e.Rgc),e.Y36(e.ZZ4),e.Y36(b,8))},n.\u0275dir=e.lG2({type:n,selectors:[["","cdkRowDef",""]],inputs:{columns:["cdkRowDefColumns","columns"],when:["cdkRowDefWhen","when"]},features:[e.qOj]}),n})(),J=(()=>{class n{constructor(t){this._viewContainer=t,n.mostRecentCellOutlet=this}ngOnDestroy(){n.mostRecentCellOutlet===this&&(n.mostRecentCellOutlet=null)}}return n.mostRecentCellOutlet=null,n.\u0275fac=function(t){return new(t||n)(e.Y36(e.s_b))},n.\u0275dir=e.lG2({type:n,selectors:[["","cdkCellOutlet",""]]}),n})(),xe=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=e.Xpm({type:n,selectors:[["cdk-header-row"],["tr","cdk-header-row",""]],hostAttrs:["role","row",1,"cdk-header-row"],decls:1,vars:0,consts:[["cdkCellOutlet",""]],template:function(t,o){1&t&&e.GkF(0,0)},dependencies:[J],encapsulation:2}),n})(),pe=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=e.Xpm({type:n,selectors:[["cdk-footer-row"],["tr","cdk-footer-row",""]],hostAttrs:["role","row",1,"cdk-footer-row"],decls:1,vars:0,consts:[["cdkCellOutlet",""]],template:function(t,o){1&t&&e.GkF(0,0)},dependencies:[J],encapsulation:2}),n})(),we=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=e.Xpm({type:n,selectors:[["cdk-row"],["tr","cdk-row",""]],hostAttrs:["role","row",1,"cdk-row"],decls:1,vars:0,consts:[["cdkCellOutlet",""]],template:function(t,o){1&t&&e.GkF(0,0)},dependencies:[J],encapsulation:2}),n})(),_e=(()=>{class n{constructor(t){this.templateRef=t,this._contentClassName="cdk-no-data-row"}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(e.Rgc))},n.\u0275dir=e.lG2({type:n,selectors:[["ng-template","cdkNoDataRow",""]]}),n})();const Qe=["top","bottom","left","right"];class Ve{constructor(s,t,o,i,c=!0,d=!0,w){this._isNativeHtmlTable=s,this._stickCellCss=t,this.direction=o,this._coalescedStyleScheduler=i,this._isBrowser=c,this._needsPositionStickyOnElement=d,this._positionListener=w,this._cachedCellWidths=[],this._borderCellCss={top:`${t}-border-elem-top`,bottom:`${t}-border-elem-bottom`,left:`${t}-border-elem-left`,right:`${t}-border-elem-right`}}clearStickyPositioning(s,t){const o=[];for(const i of s)if(i.nodeType===i.ELEMENT_NODE){o.push(i);for(let c=0;c<i.children.length;c++)o.push(i.children[c])}this._coalescedStyleScheduler.schedule(()=>{for(const i of o)this._removeStickyStyle(i,t)})}updateStickyColumns(s,t,o,i=!0){if(!s.length||!this._isBrowser||!t.some($=>$)&&!o.some($=>$))return void(this._positionListener&&(this._positionListener.stickyColumnsUpdated({sizes:[]}),this._positionListener.stickyEndColumnsUpdated({sizes:[]})));const c=s[0],d=c.children.length,w=this._getCellWidths(c,i),x=this._getStickyStartColumnPositions(w,t),re=this._getStickyEndColumnPositions(w,o),U=t.lastIndexOf(!0),ae=o.indexOf(!0);this._coalescedStyleScheduler.schedule(()=>{const $="rtl"===this.direction,me=$?"right":"left",Ft=$?"left":"right";for(const Fe of s)for(let te=0;te<d;te++){const $e=Fe.children[te];t[te]&&this._addStickyStyle($e,me,x[te],te===U),o[te]&&this._addStickyStyle($e,Ft,re[te],te===ae)}this._positionListener&&(this._positionListener.stickyColumnsUpdated({sizes:-1===U?[]:w.slice(0,U+1).map((Fe,te)=>t[te]?Fe:null)}),this._positionListener.stickyEndColumnsUpdated({sizes:-1===ae?[]:w.slice(ae).map((Fe,te)=>o[te+ae]?Fe:null).reverse()}))})}stickRows(s,t,o){if(!this._isBrowser)return;const i="bottom"===o?s.slice().reverse():s,c="bottom"===o?t.slice().reverse():t,d=[],w=[],x=[];for(let U=0,ae=0;U<i.length;U++){if(!c[U])continue;d[U]=ae;const $=i[U];x[U]=this._isNativeHtmlTable?Array.from($.children):[$];const me=$.getBoundingClientRect().height;ae+=me,w[U]=me}const re=c.lastIndexOf(!0);this._coalescedStyleScheduler.schedule(()=>{for(let U=0;U<i.length;U++){if(!c[U])continue;const ae=d[U],$=U===re;for(const me of x[U])this._addStickyStyle(me,o,ae,$)}"top"===o?this._positionListener?.stickyHeaderRowsUpdated({sizes:w,offsets:d,elements:x}):this._positionListener?.stickyFooterRowsUpdated({sizes:w,offsets:d,elements:x})})}updateStickyFooterContainer(s,t){if(!this._isNativeHtmlTable)return;const o=s.querySelector("tfoot");this._coalescedStyleScheduler.schedule(()=>{t.some(i=>!i)?this._removeStickyStyle(o,["bottom"]):this._addStickyStyle(o,"bottom",0,!1)})}_removeStickyStyle(s,t){for(const i of t)s.style[i]="",s.classList.remove(this._borderCellCss[i]);Qe.some(i=>-1===t.indexOf(i)&&s.style[i])?s.style.zIndex=this._getCalculatedZIndex(s):(s.style.zIndex="",this._needsPositionStickyOnElement&&(s.style.position=""),s.classList.remove(this._stickCellCss))}_addStickyStyle(s,t,o,i){s.classList.add(this._stickCellCss),i&&s.classList.add(this._borderCellCss[t]),s.style[t]=`${o}px`,s.style.zIndex=this._getCalculatedZIndex(s),this._needsPositionStickyOnElement&&(s.style.cssText+="position: -webkit-sticky; position: sticky; ")}_getCalculatedZIndex(s){const t={top:100,bottom:10,left:1,right:1};let o=0;for(const i of Qe)s.style[i]&&(o+=t[i]);return o?`${o}`:""}_getCellWidths(s,t=!0){if(!t&&this._cachedCellWidths.length)return this._cachedCellWidths;const o=[],i=s.children;for(let c=0;c<i.length;c++)o.push(i[c].getBoundingClientRect().width);return this._cachedCellWidths=o,o}_getStickyStartColumnPositions(s,t){const o=[];let i=0;for(let c=0;c<s.length;c++)t[c]&&(o[c]=i,i+=s[c]);return o}_getStickyEndColumnPositions(s,t){const o=[];let i=0;for(let c=s.length;c>0;c--)t[c]&&(o[c]=i,i+=s[c]);return o}}const Je=new e.OlP("CDK_SPL");let Ye=(()=>{class n{constructor(t,o){this.viewContainer=t,this.elementRef=o}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(e.s_b),e.Y36(e.SBq))},n.\u0275dir=e.lG2({type:n,selectors:[["","rowOutlet",""]]}),n})(),Ge=(()=>{class n{constructor(t,o){this.viewContainer=t,this.elementRef=o}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(e.s_b),e.Y36(e.SBq))},n.\u0275dir=e.lG2({type:n,selectors:[["","headerRowOutlet",""]]}),n})(),je=(()=>{class n{constructor(t,o){this.viewContainer=t,this.elementRef=o}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(e.s_b),e.Y36(e.SBq))},n.\u0275dir=e.lG2({type:n,selectors:[["","footerRowOutlet",""]]}),n})(),qe=(()=>{class n{constructor(t,o){this.viewContainer=t,this.elementRef=o}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(e.s_b),e.Y36(e.SBq))},n.\u0275dir=e.lG2({type:n,selectors:[["","noDataRowOutlet",""]]}),n})(),Le=(()=>{class n{get trackBy(){return this._trackByFn}set trackBy(t){this._trackByFn=t}get dataSource(){return this._dataSource}set dataSource(t){this._dataSource!==t&&this._switchDataSource(t)}get multiTemplateDataRows(){return this._multiTemplateDataRows}set multiTemplateDataRows(t){this._multiTemplateDataRows=(0,m.Ig)(t),this._rowOutlet&&this._rowOutlet.viewContainer.length&&(this._forceRenderDataRows(),this.updateStickyColumnStyles())}get fixedLayout(){return this._fixedLayout}set fixedLayout(t){this._fixedLayout=(0,m.Ig)(t),this._forceRecalculateCellWidths=!0,this._stickyColumnStylesNeedReset=!0}constructor(t,o,i,c,d,w,x,re,U,ae,$,me){this._differs=t,this._changeDetectorRef=o,this._elementRef=i,this._dir=d,this._platform=x,this._viewRepeater=re,this._coalescedStyleScheduler=U,this._viewportRuler=ae,this._stickyPositioningListener=$,this._ngZone=me,this._onDestroy=new r.x,this._columnDefsByName=new Map,this._customColumnDefs=new Set,this._customRowDefs=new Set,this._customHeaderRowDefs=new Set,this._customFooterRowDefs=new Set,this._headerRowDefChanged=!0,this._footerRowDefChanged=!0,this._stickyColumnStylesNeedReset=!0,this._forceRecalculateCellWidths=!0,this._cachedRenderRowsMap=new Map,this.stickyCssClass="cdk-table-sticky",this.needsPositionStickyOnElement=!0,this._isShowingNoDataRow=!1,this._multiTemplateDataRows=!1,this._fixedLayout=!1,this.contentChanged=new e.vpe,this.viewChange=new h.X({start:0,end:Number.MAX_VALUE}),c||this._elementRef.nativeElement.setAttribute("role","table"),this._document=w,this._isNativeHtmlTable="TABLE"===this._elementRef.nativeElement.nodeName}ngOnInit(){this._setupStickyStyler(),this._isNativeHtmlTable&&this._applyNativeTableSections(),this._dataDiffer=this._differs.find([]).create((t,o)=>this.trackBy?this.trackBy(o.dataIndex,o.data):o),this._viewportRuler.change().pipe((0,T.R)(this._onDestroy)).subscribe(()=>{this._forceRecalculateCellWidths=!0})}ngAfterContentChecked(){this._cacheRowDefs(),this._cacheColumnDefs();const o=this._renderUpdatedColumns()||this._headerRowDefChanged||this._footerRowDefChanged;this._stickyColumnStylesNeedReset=this._stickyColumnStylesNeedReset||o,this._forceRecalculateCellWidths=o,this._headerRowDefChanged&&(this._forceRenderHeaderRows(),this._headerRowDefChanged=!1),this._footerRowDefChanged&&(this._forceRenderFooterRows(),this._footerRowDefChanged=!1),this.dataSource&&this._rowDefs.length>0&&!this._renderChangeSubscription?this._observeRenderChanges():this._stickyColumnStylesNeedReset&&this.updateStickyColumnStyles(),this._checkStickyStates()}ngOnDestroy(){[this._rowOutlet.viewContainer,this._headerRowOutlet.viewContainer,this._footerRowOutlet.viewContainer,this._cachedRenderRowsMap,this._customColumnDefs,this._customRowDefs,this._customHeaderRowDefs,this._customFooterRowDefs,this._columnDefsByName].forEach(t=>{t.clear()}),this._headerRowDefs=[],this._footerRowDefs=[],this._defaultRowDef=null,this._onDestroy.next(),this._onDestroy.complete(),(0,q.Z9)(this.dataSource)&&this.dataSource.disconnect(this)}renderRows(){this._renderRows=this._getAllRenderRows();const t=this._dataDiffer.diff(this._renderRows);if(!t)return this._updateNoDataRow(),void this.contentChanged.next();const o=this._rowOutlet.viewContainer;this._viewRepeater.applyChanges(t,o,(i,c,d)=>this._getEmbeddedViewArgs(i.item,d),i=>i.item.data,i=>{1===i.operation&&i.context&&this._renderCellTemplateForItem(i.record.item.rowDef,i.context)}),this._updateRowIndexContext(),t.forEachIdentityChange(i=>{o.get(i.currentIndex).context.$implicit=i.item.data}),this._updateNoDataRow(),this._ngZone&&e.R0b.isInAngularZone()?this._ngZone.onStable.pipe((0,f.q)(1),(0,T.R)(this._onDestroy)).subscribe(()=>{this.updateStickyColumnStyles()}):this.updateStickyColumnStyles(),this.contentChanged.next()}addColumnDef(t){this._customColumnDefs.add(t)}removeColumnDef(t){this._customColumnDefs.delete(t)}addRowDef(t){this._customRowDefs.add(t)}removeRowDef(t){this._customRowDefs.delete(t)}addHeaderRowDef(t){this._customHeaderRowDefs.add(t),this._headerRowDefChanged=!0}removeHeaderRowDef(t){this._customHeaderRowDefs.delete(t),this._headerRowDefChanged=!0}addFooterRowDef(t){this._customFooterRowDefs.add(t),this._footerRowDefChanged=!0}removeFooterRowDef(t){this._customFooterRowDefs.delete(t),this._footerRowDefChanged=!0}setNoDataRow(t){this._customNoDataRow=t}updateStickyHeaderRowStyles(){const t=this._getRenderedRows(this._headerRowOutlet),i=this._elementRef.nativeElement.querySelector("thead");i&&(i.style.display=t.length?"":"none");const c=this._headerRowDefs.map(d=>d.sticky);this._stickyStyler.clearStickyPositioning(t,["top"]),this._stickyStyler.stickRows(t,c,"top"),this._headerRowDefs.forEach(d=>d.resetStickyChanged())}updateStickyFooterRowStyles(){const t=this._getRenderedRows(this._footerRowOutlet),i=this._elementRef.nativeElement.querySelector("tfoot");i&&(i.style.display=t.length?"":"none");const c=this._footerRowDefs.map(d=>d.sticky);this._stickyStyler.clearStickyPositioning(t,["bottom"]),this._stickyStyler.stickRows(t,c,"bottom"),this._stickyStyler.updateStickyFooterContainer(this._elementRef.nativeElement,c),this._footerRowDefs.forEach(d=>d.resetStickyChanged())}updateStickyColumnStyles(){const t=this._getRenderedRows(this._headerRowOutlet),o=this._getRenderedRows(this._rowOutlet),i=this._getRenderedRows(this._footerRowOutlet);(this._isNativeHtmlTable&&!this._fixedLayout||this._stickyColumnStylesNeedReset)&&(this._stickyStyler.clearStickyPositioning([...t,...o,...i],["left","right"]),this._stickyColumnStylesNeedReset=!1),t.forEach((c,d)=>{this._addStickyColumnStyles([c],this._headerRowDefs[d])}),this._rowDefs.forEach(c=>{const d=[];for(let w=0;w<o.length;w++)this._renderRows[w].rowDef===c&&d.push(o[w]);this._addStickyColumnStyles(d,c)}),i.forEach((c,d)=>{this._addStickyColumnStyles([c],this._footerRowDefs[d])}),Array.from(this._columnDefsByName.values()).forEach(c=>c.resetStickyChanged())}_getAllRenderRows(){const t=[],o=this._cachedRenderRowsMap;this._cachedRenderRowsMap=new Map;for(let i=0;i<this._data.length;i++){let c=this._data[i];const d=this._getRenderRowsForData(c,i,o.get(c));this._cachedRenderRowsMap.has(c)||this._cachedRenderRowsMap.set(c,new WeakMap);for(let w=0;w<d.length;w++){let x=d[w];const re=this._cachedRenderRowsMap.get(x.data);re.has(x.rowDef)?re.get(x.rowDef).push(x):re.set(x.rowDef,[x]),t.push(x)}}return t}_getRenderRowsForData(t,o,i){return this._getRowDefs(t,o).map(d=>{const w=i&&i.has(d)?i.get(d):[];if(w.length){const x=w.shift();return x.dataIndex=o,x}return{data:t,rowDef:d,dataIndex:o}})}_cacheColumnDefs(){this._columnDefsByName.clear(),Pe(this._getOwnDefs(this._contentColumnDefs),this._customColumnDefs).forEach(o=>{this._columnDefsByName.has(o.name),this._columnDefsByName.set(o.name,o)})}_cacheRowDefs(){this._headerRowDefs=Pe(this._getOwnDefs(this._contentHeaderRowDefs),this._customHeaderRowDefs),this._footerRowDefs=Pe(this._getOwnDefs(this._contentFooterRowDefs),this._customFooterRowDefs),this._rowDefs=Pe(this._getOwnDefs(this._contentRowDefs),this._customRowDefs);const t=this._rowDefs.filter(o=>!o.when);this._defaultRowDef=t[0]}_renderUpdatedColumns(){const t=(d,w)=>d||!!w.getColumnsDiff(),o=this._rowDefs.reduce(t,!1);o&&this._forceRenderDataRows();const i=this._headerRowDefs.reduce(t,!1);i&&this._forceRenderHeaderRows();const c=this._footerRowDefs.reduce(t,!1);return c&&this._forceRenderFooterRows(),o||i||c}_switchDataSource(t){this._data=[],(0,q.Z9)(this.dataSource)&&this.dataSource.disconnect(this),this._renderChangeSubscription&&(this._renderChangeSubscription.unsubscribe(),this._renderChangeSubscription=null),t||(this._dataDiffer&&this._dataDiffer.diff([]),this._rowOutlet.viewContainer.clear()),this._dataSource=t}_observeRenderChanges(){if(!this.dataSource)return;let t;(0,q.Z9)(this.dataSource)?t=this.dataSource.connect(this):function D(n){return!!n&&(n instanceof p.y||(0,C.m)(n.lift)&&(0,C.m)(n.subscribe))}(this.dataSource)?t=this.dataSource:Array.isArray(this.dataSource)&&(t=(0,P.of)(this.dataSource)),this._renderChangeSubscription=t.pipe((0,T.R)(this._onDestroy)).subscribe(o=>{this._data=o||[],this.renderRows()})}_forceRenderHeaderRows(){this._headerRowOutlet.viewContainer.length>0&&this._headerRowOutlet.viewContainer.clear(),this._headerRowDefs.forEach((t,o)=>this._renderRow(this._headerRowOutlet,t,o)),this.updateStickyHeaderRowStyles()}_forceRenderFooterRows(){this._footerRowOutlet.viewContainer.length>0&&this._footerRowOutlet.viewContainer.clear(),this._footerRowDefs.forEach((t,o)=>this._renderRow(this._footerRowOutlet,t,o)),this.updateStickyFooterRowStyles()}_addStickyColumnStyles(t,o){const i=Array.from(o.columns||[]).map(w=>this._columnDefsByName.get(w)),c=i.map(w=>w.sticky),d=i.map(w=>w.stickyEnd);this._stickyStyler.updateStickyColumns(t,c,d,!this._fixedLayout||this._forceRecalculateCellWidths)}_getRenderedRows(t){const o=[];for(let i=0;i<t.viewContainer.length;i++){const c=t.viewContainer.get(i);o.push(c.rootNodes[0])}return o}_getRowDefs(t,o){if(1==this._rowDefs.length)return[this._rowDefs[0]];let i=[];if(this.multiTemplateDataRows)i=this._rowDefs.filter(c=>!c.when||c.when(o,t));else{let c=this._rowDefs.find(d=>d.when&&d.when(o,t))||this._defaultRowDef;c&&i.push(c)}return i}_getEmbeddedViewArgs(t,o){return{templateRef:t.rowDef.template,context:{$implicit:t.data},index:o}}_renderRow(t,o,i,c={}){const d=t.viewContainer.createEmbeddedView(o.template,c,i);return this._renderCellTemplateForItem(o,c),d}_renderCellTemplateForItem(t,o){for(let i of this._getCellTemplates(t))J.mostRecentCellOutlet&&J.mostRecentCellOutlet._viewContainer.createEmbeddedView(i,o);this._changeDetectorRef.markForCheck()}_updateRowIndexContext(){const t=this._rowOutlet.viewContainer;for(let o=0,i=t.length;o<i;o++){const d=t.get(o).context;d.count=i,d.first=0===o,d.last=o===i-1,d.even=o%2==0,d.odd=!d.even,this.multiTemplateDataRows?(d.dataIndex=this._renderRows[o].dataIndex,d.renderIndex=o):d.index=this._renderRows[o].dataIndex}}_getCellTemplates(t){return t&&t.columns?Array.from(t.columns,o=>{const i=this._columnDefsByName.get(o);return t.extractCellTemplate(i)}):[]}_applyNativeTableSections(){const t=this._document.createDocumentFragment(),o=[{tag:"thead",outlets:[this._headerRowOutlet]},{tag:"tbody",outlets:[this._rowOutlet,this._noDataRowOutlet]},{tag:"tfoot",outlets:[this._footerRowOutlet]}];for(const i of o){const c=this._document.createElement(i.tag);c.setAttribute("role","rowgroup");for(const d of i.outlets)c.appendChild(d.elementRef.nativeElement);t.appendChild(c)}this._elementRef.nativeElement.appendChild(t)}_forceRenderDataRows(){this._dataDiffer.diff([]),this._rowOutlet.viewContainer.clear(),this.renderRows()}_checkStickyStates(){const t=(o,i)=>o||i.hasStickyChanged();this._headerRowDefs.reduce(t,!1)&&this.updateStickyHeaderRowStyles(),this._footerRowDefs.reduce(t,!1)&&this.updateStickyFooterRowStyles(),Array.from(this._columnDefsByName.values()).reduce(t,!1)&&(this._stickyColumnStylesNeedReset=!0,this.updateStickyColumnStyles())}_setupStickyStyler(){this._stickyStyler=new Ve(this._isNativeHtmlTable,this.stickyCssClass,this._dir?this._dir.value:"ltr",this._coalescedStyleScheduler,this._platform.isBrowser,this.needsPositionStickyOnElement,this._stickyPositioningListener),(this._dir?this._dir.change:(0,P.of)()).pipe((0,T.R)(this._onDestroy)).subscribe(o=>{this._stickyStyler.direction=o,this.updateStickyColumnStyles()})}_getOwnDefs(t){return t.filter(o=>!o._table||o._table===this)}_updateNoDataRow(){const t=this._customNoDataRow||this._noDataRow;if(!t)return;const o=0===this._rowOutlet.viewContainer.length;if(o===this._isShowingNoDataRow)return;const i=this._noDataRowOutlet.viewContainer;if(o){const c=i.createEmbeddedView(t.templateRef),d=c.rootNodes[0];1===c.rootNodes.length&&d?.nodeType===this._document.ELEMENT_NODE&&(d.setAttribute("role","row"),d.classList.add(t._contentClassName))}else i.clear();this._isShowingNoDataRow=o}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(e.ZZ4),e.Y36(e.sBO),e.Y36(e.SBq),e.$8M("role"),e.Y36(be.Is,8),e.Y36(K.K0),e.Y36(A.t4),e.Y36(q.k),e.Y36(y),e.Y36(a.rL),e.Y36(Je,12),e.Y36(e.R0b,8))},n.\u0275cmp=e.Xpm({type:n,selectors:[["cdk-table"],["table","cdk-table",""]],contentQueries:function(t,o,i){if(1&t&&(e.Suo(i,_e,5),e.Suo(i,v,5),e.Suo(i,ue,5),e.Suo(i,z,5),e.Suo(i,B,5)),2&t){let c;e.iGM(c=e.CRH())&&(o._noDataRow=c.first),e.iGM(c=e.CRH())&&(o._contentColumnDefs=c),e.iGM(c=e.CRH())&&(o._contentRowDefs=c),e.iGM(c=e.CRH())&&(o._contentHeaderRowDefs=c),e.iGM(c=e.CRH())&&(o._contentFooterRowDefs=c)}},viewQuery:function(t,o){if(1&t&&(e.Gf(Ye,7),e.Gf(Ge,7),e.Gf(je,7),e.Gf(qe,7)),2&t){let i;e.iGM(i=e.CRH())&&(o._rowOutlet=i.first),e.iGM(i=e.CRH())&&(o._headerRowOutlet=i.first),e.iGM(i=e.CRH())&&(o._footerRowOutlet=i.first),e.iGM(i=e.CRH())&&(o._noDataRowOutlet=i.first)}},hostAttrs:[1,"cdk-table"],hostVars:2,hostBindings:function(t,o){2&t&&e.ekj("cdk-table-fixed-layout",o.fixedLayout)},inputs:{trackBy:"trackBy",dataSource:"dataSource",multiTemplateDataRows:"multiTemplateDataRows",fixedLayout:"fixedLayout"},outputs:{contentChanged:"contentChanged"},exportAs:["cdkTable"],features:[e._Bn([{provide:b,useExisting:n},{provide:q.k,useClass:q.yy},{provide:y,useClass:ce},{provide:Je,useValue:null}])],ngContentSelectors:g,decls:6,vars:0,consts:[["headerRowOutlet",""],["rowOutlet",""],["noDataRowOutlet",""],["footerRowOutlet",""]],template:function(t,o){1&t&&(e.F$t(N),e.Hsn(0),e.Hsn(1,1),e.GkF(2,0)(3,1)(4,2)(5,3))},dependencies:[Ye,Ge,je,qe],styles:[".cdk-table-fixed-layout{table-layout:fixed}"],encapsulation:2}),n})();function Pe(n,s){return n.concat(Array.from(s))}let tt=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[a.Cl]}),n})();var We=k(489);class Te{transform(s){return s&&s.length?s.reduce((t,o)=>t+o,0):0}}Te.\u0275fac=function(s){return new(s||Te)},Te.\u0275pipe=e.Yjl({name:"sum",type:Te,pure:!0,standalone:!0});var Ke=k(2189);function nt(n,s){1&n&&(e.TgZ(0,"th",11),e._uU(1,"Number"),e.qZA())}function ot(n,s){if(1&n&&(e.TgZ(0,"td",12),e._uU(1),e.qZA()),2&n){const t=s.index;e.xp6(1),e.hij("",t+1,".")}}function st(n,s){if(1&n&&(e.TgZ(0,"td",13),e._uU(1),e.qZA()),2&n){const t=e.oxw();e.xp6(1),e.hij("Shots: ",t.allShots.length,"")}}function it(n,s){if(1&n&&(e.TgZ(0,"th",11),e._uU(1),e.qZA()),2&n){const t=e.oxw().$implicit;e.xp6(1),e.hij("",+t+1,".")}}function rt(n,s){if(1&n&&(e.TgZ(0,"td",12),e._uU(1),e.qZA()),2&n){const t=s.$implicit,o=e.oxw().$implicit;let i;e.xp6(1),e.hij(" ",null!==(i=null==t||null==t.shots[o]?null:t.shots[o].value)&&void 0!==i?i:"-"," ")}}function at(n,s){1&n&&e._UZ(0,"td",13)}function ct(n,s){1&n&&(e.ynx(0,14),e.YNc(1,it,2,1,"th",2),e.YNc(2,rt,2,1,"td",3),e.YNc(3,at,1,0,"td",4),e.BQk()),2&n&&e.Q6J("cdkColumnDef",s.$implicit)}function lt(n,s){1&n&&(e.TgZ(0,"th",11),e._uU(1,"Average"),e.qZA())}function dt(n,s){if(1&n&&(e.TgZ(0,"td",12),e._uU(1),e.ALo(2,"average"),e.ALo(3,"pluck"),e.qZA()),2&n){const t=s.$implicit,o=e.oxw();e.xp6(1),e.hij(" ",e.lcZ(2,1,e.xi3(3,3,o.typeCastToArcheryEntry(t).shots,"value"))," ")}}function ut(n,s){if(1&n&&(e.TgZ(0,"td",13),e._uU(1),e.ALo(2,"average"),e.qZA()),2&n){const t=e.oxw();e.xp6(1),e.hij(" ",e.lcZ(2,1,t.allShots)," ")}}function ht(n,s){1&n&&(e.TgZ(0,"th",11),e._uU(1,"Sum"),e.qZA())}function ft(n,s){if(1&n&&(e.TgZ(0,"td",12),e._uU(1),e.ALo(2,"sum"),e.ALo(3,"pluck"),e.qZA()),2&n){const t=s.$implicit,o=e.oxw();e.xp6(1),e.hij(" ",e.lcZ(2,1,e.xi3(3,3,o.typeCastToArcheryEntry(t).shots,"value"))," ")}}function pt(n,s){if(1&n&&(e.TgZ(0,"td",13),e._uU(1),e.ALo(2,"sum"),e.qZA()),2&n){const t=e.oxw();e.xp6(1),e.Oqu(e.lcZ(2,1,t.allShots))}}function _t(n,s){1&n&&e._UZ(0,"tr",15)}function mt(n,s){1&n&&e._UZ(0,"tr",16)}function gt(n,s){1&n&&e._UZ(0,"tr",17)}class Ee{constructor(){this.dataSource=[],this.displayedColumns=[],this.allShots=[]}set session(s){this.dataSource=s.entries;const t=s.entries.reduce((o,i)=>i.shots.length>o.length?i.shots:o,[]);this.displayedColumns=["shotNumber",...t.map((o,i)=>i.toString()),"sum","avg"],this.allShots=s.entries.map(o=>o.shots).flat().map(o=>o.value),this.table?.renderRows()}typeCastToArcheryEntry(s){return s}trackBy(s,t){return t.id}}Ee.\u0275fac=function(s){return new(s||Ee)},Ee.\u0275cmp=e.Xpm({type:Ee,selectors:[["app-entries-table"]],viewQuery:function(s,t){if(1&s&&e.Gf(Le,5),2&s){let o;e.iGM(o=e.CRH())&&(t.table=o.first)}},inputs:{session:"session"},standalone:!0,features:[e.jDz],decls:18,vars:10,consts:[["cdk-table","","fixedLayout","",3,"dataSource","trackBy"],["cdkColumnDef","shotNumber"],["cdk-header-cell","",4,"cdkHeaderCellDef"],["cdk-cell","",4,"cdkCellDef"],["cdk-footer-cell","",4,"cdkFooterCellDef"],[3,"cdkColumnDef",4,"ngFor","ngForOf"],["cdkColumnDef","avg"],["cdkColumnDef","sum"],["cdk-header-row","",4,"cdkHeaderRowDef"],["cdk-row","",4,"cdkRowDef","cdkRowDefColumns"],["cdk-footer-row","",4,"cdkFooterRowDef"],["cdk-header-cell",""],["cdk-cell",""],["cdk-footer-cell",""],[3,"cdkColumnDef"],["cdk-header-row",""],["cdk-row",""],["cdk-footer-row",""]],template:function(s,t){1&s&&(e.TgZ(0,"table",0),e.ynx(1,1),e.YNc(2,nt,2,0,"th",2),e.YNc(3,ot,2,1,"td",3),e.YNc(4,st,2,1,"td",4),e.BQk(),e.YNc(5,ct,4,1,"ng-container",5),e.ALo(6,"slice"),e.ynx(7,6),e.YNc(8,lt,2,0,"th",2),e.YNc(9,dt,4,6,"td",3),e.YNc(10,ut,3,3,"td",4),e.BQk(),e.ynx(11,7),e.YNc(12,ht,2,0,"th",2),e.YNc(13,ft,4,6,"td",3),e.YNc(14,pt,3,3,"td",4),e.BQk(),e.YNc(15,_t,1,0,"tr",8),e.YNc(16,mt,1,0,"tr",9),e.YNc(17,gt,1,0,"tr",10),e.qZA()),2&s&&(e.Q6J("dataSource",t.dataSource)("trackBy",t.trackBy),e.xp6(5),e.Q6J("ngForOf",e.Dn7(6,6,t.displayedColumns,1,t.displayedColumns.length-2)),e.xp6(10),e.Q6J("cdkHeaderRowDef",t.displayedColumns),e.xp6(1),e.Q6J("cdkRowDefColumns",t.displayedColumns),e.xp6(1),e.Q6J("cdkFooterRowDef",t.displayedColumns))},dependencies:[K.ax,K.OU,We.p,Te,Ke.F,tt,Le,ue,E,Z,L,v,S,we,M,R,xe,z,pe,B],styles:["[_nghost-%COMP%]{display:block;overflow-x:auto}table[_ngcontent-%COMP%]{margin:0 auto;border-collapse:collapse;overflow:hidden}table[_ngcontent-%COMP%]   .cdk-header-cell[_ngcontent-%COMP%], table[_ngcontent-%COMP%]   .cdk-footer-cell[_ngcontent-%COMP%], table[_ngcontent-%COMP%]   .cdk-cell[_ngcontent-%COMP%]{text-align:left;padding:2px 8px}"]});var yt=k(5136),He=(()=>((He||(He={})).DELETE="delete",He))(),ee=(()=>{return(n=ee||(ee={})).GOLD="gold-scheme",n.RED="red-scheme",n.BLUE="blue-scheme",n.BLACK="black-scheme",n.WHITE="white-scheme",ee;var n})();function Ct(n,s){if(1&n){const t=e.EpF();e.TgZ(0,"button",4),e.NdJ("click",function(){const c=e.CHM(t).$implicit,d=e.oxw(2);return e.KtG(d.action.emit(c.action))}),e._uU(1),e.qZA()}if(2&n){const t=s.$implicit,o=e.oxw(2);e.Tol(o.showColorSchemes&&t.colorScheme||null),e.xp6(1),e.hij(" ",t.label," ")}}function wt(n,s){if(1&n&&(e.TgZ(0,"div",2),e.YNc(1,Ct,2,3,"button",3),e.qZA()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("ngForOf",t.scoreInputConfig)}}const Rt=[{label:"0",action:0},{label:"10",action:10,colorScheme:ee.GOLD},{label:"DEL",action:He.DELETE},{label:"7",action:7,colorScheme:ee.RED},{label:"8",action:8,colorScheme:ee.RED},{label:"9",action:9,colorScheme:ee.GOLD},{label:"4",action:4,colorScheme:ee.BLACK},{label:"5",action:5,colorScheme:ee.BLUE},{label:"6",action:6,colorScheme:ee.BLUE},{label:"1",action:1,colorScheme:ee.WHITE},{label:"2",action:2,colorScheme:ee.WHITE},{label:"3",action:3,colorScheme:ee.BLACK}];class Oe{constructor(){this.scoreInputConfig=Rt,this.showColorSchemes=!1,this.action=new e.vpe}}Oe.\u0275fac=function(s){return new(s||Oe)},Oe.\u0275cmp=e.Xpm({type:Oe,selectors:[["app-score-input-buttons"]],inputs:{scoreInputConfig:"scoreInputConfig",showColorSchemes:"showColorSchemes"},outputs:{action:"action"},standalone:!0,features:[e.jDz],decls:3,vars:1,consts:[["class","button-grid",4,"ngIf"],["mat-button","",1,"margin-top-1x",3,"click"],[1,"button-grid"],["mat-stroked-button","",3,"class","click",4,"ngFor","ngForOf"],["mat-stroked-button","",3,"click"]],template:function(s,t){1&s&&(e.YNc(0,wt,2,1,"div",0),e.TgZ(1,"button",1),e.NdJ("click",function(){return t.showColorSchemes=!t.showColorSchemes}),e._uU(2," Toggle colors\n"),e.qZA()),2&s&&e.Q6J("ngIf",t.scoreInputConfig)},dependencies:[K.ax,K.O5,V.ot,V.lW],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;align-items:center}.button-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(3,min-content);gap:var(--spacing-2x)}.button-grid[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:50px;min-width:0}"]});class Ae{}Ae.\u0275fac=function(s){return new(s||Ae)},Ae.\u0275cmp=e.Xpm({type:Ae,selectors:[["app-score-input-display-block"]],standalone:!0,features:[e.jDz],ngContentSelectors:["*"],decls:1,vars:0,template:function(s,t){1&s&&(e.F$t(),e.Hsn(0))},styles:["[_nghost-%COMP%]{display:inline-flex;align-items:center;justify-content:center;font-size:1.25em;padding:.25em;width:50px;height:50px}[_nghost-%COMP%]:not(.active){cursor:pointer}.active[_nghost-%COMP%]{box-shadow:0 2px 4px -1px #0003,0 4px 5px #00000024,0 1px 10px #0000001f}"]});var vt=k(9613);function Dt(n,s){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"app-score-input-display-block",4),e.NdJ("click",function(){const c=e.CHM(t).index,d=e.oxw();return e.KtG(d.activeShotIndex=c)}),e._uU(2),e.qZA(),e.BQk()}if(2&n){const t=s.$implicit,o=s.index,i=e.oxw();let c;e.xp6(1),e.ekj("active",o===i.activeShotIndex),e.xp6(1),e.hij(" ",null!==(c=null==t?null:t.value)&&void 0!==c?c:"-"," ")}}class Me{set session(s){this.numberOfArrows=s.numberOfArrows}set numberOfArrows(s){this._numberOfArrows=s,this.resetShots()}get numberOfArrows(){return this._numberOfArrows}constructor(s){this.dialog=s,this._numberOfArrows=6,this.activeShotIndex=0,this.shots=[],this.savedEntry=new e.vpe}resetShots(){this.shots=new Array(this.numberOfArrows).fill(null),this.activeShotIndex=0}saveEntryToRepo(s){this.savedEntry.emit((0,W.Yo)({shots:s})),this.resetShots()}buttonInputAction(s){"number"==typeof s?(this.shots[this.activeShotIndex]=(0,W.Ey)({value:s}),this.activeShotIndex=++this.activeShotIndex%this.shots.length):this.shots[this.activeShotIndex]=null}save(){const s=this.shots.filter(t=>!!t).sort((t,o)=>o.value-t.value);s.length?this.saveEntryToRepo(s):this.dialog.open(vt.M,{restoreFocus:!1,autoFocus:!1,width:"500px",data:{title:"Are you sure you want to add an entry with no shots ?"}}).afterClosed().subscribe(o=>{o&&this.saveEntryToRepo(s)})}}Me.\u0275fac=function(s){return new(s||Me)(e.Y36(X.uw))},Me.\u0275cmp=e.Xpm({type:Me,selectors:[["app-score-input"]],inputs:{session:"session"},outputs:{savedEntry:"savedEntry"},standalone:!0,features:[e.jDz],decls:5,vars:1,consts:[["mat-stroked-button","",1,"margin-bottom-2x",3,"click"],[1,"blocks-grid","margin-bottom-4x"],[4,"ngFor","ngForOf"],[3,"action"],[3,"click"]],template:function(s,t){1&s&&(e.TgZ(0,"button",0),e.NdJ("click",function(){return t.save()}),e._uU(1," Save\n"),e.qZA(),e.TgZ(2,"div",1),e.YNc(3,Dt,3,3,"ng-container",2),e.qZA(),e.TgZ(4,"app-score-input-buttons",3),e.NdJ("action",function(i){return t.buttonInputAction(i)}),e.qZA()),2&s&&(e.xp6(3),e.Q6J("ngForOf",t.shots))},dependencies:[K.ax,Ae,Oe,V.ot,V.lW,X.Is],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;align-items:center}.blocks-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(3,min-content);gap:var(--spacing-2x)}"]});var St=k(3768),bt=k(8778),xt=k(7322);function Tt(n,s){if(1&n&&e._UZ(0,"app-entries-table",11),2&n){const t=e.oxw().ngIf;e.Q6J("session",t)}}function Et(n,s){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",3)(2,"div",4)(3,"h2",5),e._uU(4),e.qZA(),e.TgZ(5,"h5",6),e.ALo(6,"date"),e._uU(7),e.ALo(8,"dateDistance"),e.qZA()(),e.TgZ(9,"button",7),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.archerySessionRepo.resetActiveSession())}),e.TgZ(10,"mat-icon"),e._uU(11,"close_fullscreen"),e.qZA(),e._uU(12," Close session "),e.qZA()(),e._UZ(13,"mat-divider",8),e.TgZ(14,"app-score-input",9),e.NdJ("savedEntry",function(i){e.CHM(t);const c=e.oxw();return e.KtG(c.archerySessionRepo.addEntryForActiveSession(i))}),e.qZA(),e.YNc(15,Tt,1,1,"app-entries-table",10),e.BQk()}if(2&n){const t=s.ngIf;e.xp6(4),e.Oqu(t.name),e.xp6(1),e.Q6J("title",e.lcZ(6,5,t.date_created)),e.xp6(2),e.hij(" Created: ",e.lcZ(8,7,t.date_created)," "),e.xp6(7),e.Q6J("session",t),e.xp6(1),e.Q6J("ngIf",t.entries.length)}}function Ot(n,s){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",14)(2,"h2"),e._uU(3),e.qZA(),e._UZ(4,"span",15),e.TgZ(5,"button",16),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(3);return e.KtG(i.openNewSessionDialog())}),e._uU(6," New Session "),e.qZA()(),e._UZ(7,"mat-divider",17),e.TgZ(8,"h3"),e._uU(9),e.ALo(10,"average"),e.ALo(11,"pluck"),e.ALo(12,"flatten"),e.ALo(13,"pluck"),e.ALo(14,"flatten"),e.ALo(15,"pluck"),e.qZA(),e._UZ(16,"mat-divider",17)(17,"app-session-list"),e.BQk()}if(2&n){const t=e.oxw().ngIf;e.xp6(3),e.hij("Your sessions (",t.length,"):"),e.xp6(6),e.hij(" Your overall average: ",e.lcZ(10,2,e.xi3(11,4,e.lcZ(12,7,e.xi3(13,9,e.lcZ(14,12,e.xi3(15,14,t,"entries")),"shots")),"value"))," ")}}function At(n,s){1&n&&(e.TgZ(0,"h2"),e._uU(1,"Start a new session"),e.qZA(),e._UZ(2,"mat-divider",8)(3,"app-new-archery-session-form"))}function Mt(n,s){if(1&n&&(e.ynx(0),e.YNc(1,Ot,18,17,"ng-container",1),e.YNc(2,At,4,0,"ng-template",null,13,e.W1O),e.BQk()),2&n){const t=s.ngIf,o=e.MAs(3);e.xp6(1),e.Q6J("ngIf",t.length)("ngIfElse",o)}}function It(n,s){if(1&n&&(e.YNc(0,Mt,4,2,"ng-container",12),e.ALo(1,"async")),2&n){const t=e.oxw();e.Q6J("ngIf",e.lcZ(1,1,t.archerySessionRepo.sessions$))}}class Ie{constructor(s,t){this.archerySessionRepo=s,this.dialog=t}openNewSessionDialog(){this.dialog.open(ve.q,{width:"500px"})}openCSVFileImportDialog(){this.dialog.open(fe,{width:"500px"})}}Ie.\u0275fac=function(s){return new(s||Ie)(e.Y36(De.H),e.Y36(X.uw))},Ie.\u0275cmp=e.Xpm({type:Ie,selectors:[["app-archery-score-page"]],standalone:!0,features:[e.jDz],decls:6,vars:4,consts:[["mat-raised-button","","color","primary",3,"click"],[4,"ngIf","ngIfElse"],["noActiveSession",""],[1,"title-row"],[1,"flex-column"],[1,"margin-bottom-1x"],[3,"title"],["mat-stroked-button","",3,"click"],[1,"margin-top-2x","margin-bottom-2x"],[1,"margin-bottom-8x",3,"session","savedEntry"],["class","margin-bottom-8x",3,"session",4,"ngIf"],[1,"margin-bottom-8x",3,"session"],[4,"ngIf"],["noSessions",""],[1,"margin-bottom-2x","flex-row"],[1,"spacer"],["mat-raised-button","",3,"click"],[1,"margin-y-2x"]],template:function(s,t){if(1&s&&(e.TgZ(0,"button",0),e.NdJ("click",function(){return t.openCSVFileImportDialog()}),e._uU(1," OPEN FILE UPLOAD\n"),e.qZA(),e.YNc(2,Et,16,9,"ng-container",1),e.ALo(3,"async"),e.YNc(4,It,2,3,"ng-template",null,2,e.W1O)),2&s){const o=e.MAs(5);e.xp6(2),e.Q6J("ngIf",e.lcZ(3,2,t.archerySessionRepo.activeSession$))("ngIfElse",o)}},dependencies:[K.O5,K.Ov,bt.n,K.uU,Ke.F,We.p,xt.p,St.G,yt.e,Ee,Me,F.t,F.d,V.ot,V.lW,X.Is,ie.Ps,ie.Hw],styles:["[_nghost-%COMP%]{display:block;padding:var(--spacing-3x)}@media (max-width: 767px){[_nghost-%COMP%]{padding:var(--spacing-1x)}}[_nghost-%COMP%]   .title-row[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;align-items:center;justify-content:space-between;gap:var(--spacing-2x)}"]})},3028:function(ze,Ne){var k,V;k=function X(){"use strict";var F=typeof self<"u"?self:typeof window<"u"?window:void 0!==F?F:{},ie=!F.document&&!!F.postMessage,ve=ie&&/blob:/i.test((F.location||{}).protocol),ge={},Be=0,m={parse:function(a,r){var l=(r=r||{}).dynamicTyping||!1;if(A(l)&&(r.dynamicTypingFunction=l,l={}),r.dynamicTyping=l,r.transform=!!A(r.transform)&&r.transform,r.worker&&m.WORKERS_SUPPORTED){var h=function(){if(!m.WORKERS_SUPPORTED)return!1;var P,T,C=(P=F.URL||F.webkitURL||null,T=X.toString(),m.BLOB_URL||(m.BLOB_URL=P.createObjectURL(new Blob(["(",T,")();"],{type:"text/javascript"})))),D=new F.Worker(C);return D.onmessage=Ue,D.id=Be++,ge[D.id]=D}();return h.userStep=r.step,h.userChunk=r.chunk,h.userComplete=r.complete,h.userError=r.error,r.step=A(r.step),r.chunk=A(r.chunk),r.complete=A(r.complete),r.error=A(r.error),delete r.worker,void h.postMessage({input:a,config:r,workerId:h.id})}var p=null;return"string"==typeof a?p=r.download?new e(r):new ye(r):!0===a.readable&&A(a.read)&&A(a.on)?p=new ke(r):(F.File&&a instanceof File||a instanceof Object)&&(p=new Re(r)),p.stream(a)},unparse:function(a,r){var l=!1,h=!0,p=",",C="\r\n",D='"',P=D+D,T=!1,f=null,N=!1;!function(){if("object"==typeof r){if("string"!=typeof r.delimiter||m.BAD_DELIMITERS.filter(function(u){return-1!==r.delimiter.indexOf(u)}).length||(p=r.delimiter),("boolean"==typeof r.quotes||"function"==typeof r.quotes||Array.isArray(r.quotes))&&(l=r.quotes),"boolean"!=typeof r.skipEmptyLines&&"string"!=typeof r.skipEmptyLines||(T=r.skipEmptyLines),"string"==typeof r.newline&&(C=r.newline),"string"==typeof r.quoteChar&&(D=r.quoteChar),"boolean"==typeof r.header&&(h=r.header),Array.isArray(r.columns)){if(0===r.columns.length)throw new Error("Option columns is empty");f=r.columns}void 0!==r.escapeChar&&(P=r.escapeChar+D),("boolean"==typeof r.escapeFormulae||r.escapeFormulae instanceof RegExp)&&(N=r.escapeFormulae instanceof RegExp?r.escapeFormulae:/^[=+\-@\t\r].*$/)}}();var g=new RegExp(Ce(D),"g");if("string"==typeof a&&(a=JSON.parse(a)),Array.isArray(a)){if(!a.length||Array.isArray(a[0]))return ne(null,a,T);if("object"==typeof a[0])return ne(f||Object.keys(a[0]),a,T)}else if("object"==typeof a)return"string"==typeof a.data&&(a.data=JSON.parse(a.data)),Array.isArray(a.data)&&(a.fields||(a.fields=a.meta&&a.meta.fields||f),a.fields||(a.fields=Array.isArray(a.data[0])?a.fields:"object"==typeof a.data[0]?Object.keys(a.data[0]):[]),Array.isArray(a.data[0])||"object"==typeof a.data[0]||(a.data=[a.data])),ne(a.fields||[],a.data||[],T);throw new Error("Unable to serialize unrecognized input");function ne(u,b,G){var E="";"string"==typeof u&&(u=JSON.parse(u)),"string"==typeof b&&(b=JSON.parse(b));var Z=Array.isArray(u)&&0<u.length,L=!Array.isArray(b[0]);if(Z&&h){for(var H=0;H<u.length;H++)0<H&&(E+=p),E+=Y(u[H],H);0<b.length&&(E+=C)}for(var _=0;_<b.length;_++){var v=Z?u.length:b[_].length,O=!1,M=Z?0===Object.keys(b[_]).length:0===b[_].length;if(G&&!Z&&(O="greedy"===G?""===b[_].join("").trim():1===b[_].length&&0===b[_][0].length),"greedy"===G&&Z){for(var R=[],S=0;S<v;S++)R.push(b[_][L?u[S]:S]);O=""===R.join("").trim()}if(!O){for(var y=0;y<v;y++)0<y&&!M&&(E+=p),E+=Y(b[_][Z&&L?u[y]:y],y);_<b.length-1&&(!G||0<v&&!M)&&(E+=C)}}return E}function Y(u,b){if(null==u)return"";if(u.constructor===Date)return JSON.stringify(u).slice(1,25);var G=!1;N&&"string"==typeof u&&N.test(u)&&(u="'"+u,G=!0);var E=u.toString().replace(g,P);return(G=G||!0===l||"function"==typeof l&&l(u,b)||Array.isArray(l)&&l[b]||function(Z,L){for(var H=0;H<L.length;H++)if(-1<Z.indexOf(L[H]))return!0;return!1}(E,m.BAD_DELIMITERS)||-1<E.indexOf(p)||" "===E.charAt(0)||" "===E.charAt(E.length-1))?D+E+D:E}}};if(m.RECORD_SEP=String.fromCharCode(30),m.UNIT_SEP=String.fromCharCode(31),m.BYTE_ORDER_MARK="\ufeff",m.BAD_DELIMITERS=["\r","\n",'"',m.BYTE_ORDER_MARK],m.WORKERS_SUPPORTED=!ie&&!!F.Worker,m.NODE_STREAM_INPUT=1,m.LocalChunkSize=10485760,m.RemoteChunkSize=5242880,m.DefaultDelimiter=",",m.Parser=Se,m.ParserHandle=De,m.NetworkStreamer=e,m.FileStreamer=Re,m.StringStreamer=ye,m.ReadableStreamStreamer=ke,F.jQuery){var he=F.jQuery;he.fn.parse=function(a){var r=a.config||{},l=[];return this.each(function(C){if("INPUT"!==he(this).prop("tagName").toUpperCase()||"file"!==he(this).attr("type").toLowerCase()||!F.FileReader||!this.files||0===this.files.length)return!0;for(var D=0;D<this.files.length;D++)l.push({file:this.files[D],inputElem:this,instanceConfig:he.extend({},r)})}),h(),this;function h(){if(0!==l.length){var D,P,T,f=l[0];if(A(a.before)){var N=a.before(f.file,f.inputElem);if("object"==typeof N){if("abort"===N.action)return"AbortError",D=f.file,P=f.inputElem,T=N.reason,void(A(a.error)&&a.error({name:"AbortError"},D,P,T));if("skip"===N.action)return void p();"object"==typeof N.config&&(f.instanceConfig=he.extend(f.instanceConfig,N.config))}else if("skip"===N)return void p()}var g=f.instanceConfig.complete;f.instanceConfig.complete=function(ne){A(g)&&g(ne,f.file,f.inputElem),p()},m.parse(f.file,f.instanceConfig)}else A(a.complete)&&a.complete()}function p(){l.splice(0,1),h()}}}function W(a){this._handle=null,this._finished=!1,this._completed=!1,this._halted=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},function(r){var l=be(r);l.chunkSize=parseInt(l.chunkSize),r.step||r.chunk||(l.chunkSize=null),this._handle=new De(l),(this._handle.streamer=this)._config=l}.call(this,a),this.parseChunk=function(r,l){if(this.isFirstChunk&&A(this._config.beforeFirstChunk)){var h=this._config.beforeFirstChunk(r);void 0!==h&&(r=h)}this.isFirstChunk=!1,this._halted=!1;var p=this._partialLine+r;this._partialLine="";var C=this._handle.parse(p,this._baseIndex,!this._finished);if(!this._handle.paused()&&!this._handle.aborted()){var D=C.meta.cursor;this._finished||(this._partialLine=p.substring(D-this._baseIndex),this._baseIndex=D),C&&C.data&&(this._rowCount+=C.data.length);var P=this._finished||this._config.preview&&this._rowCount>=this._config.preview;if(ve)F.postMessage({results:C,workerId:m.WORKER_ID,finished:P});else if(A(this._config.chunk)&&!l){if(this._config.chunk(C,this._handle),this._handle.paused()||this._handle.aborted())return void(this._halted=!0);C=void 0,this._completeResults=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(C.data),this._completeResults.errors=this._completeResults.errors.concat(C.errors),this._completeResults.meta=C.meta),this._completed||!P||!A(this._config.complete)||C&&C.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),P||C&&C.meta.paused||this._nextChunk(),C}this._halted=!0},this._sendError=function(r){A(this._config.error)?this._config.error(r):ve&&this._config.error&&F.postMessage({workerId:m.WORKER_ID,error:r,finished:!1})}}function e(a){var r;(a=a||{}).chunkSize||(a.chunkSize=m.RemoteChunkSize),W.call(this,a),this._nextChunk=ie?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(l){this._input=l,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(r=new XMLHttpRequest,this._config.withCredentials&&(r.withCredentials=this._config.withCredentials),ie||(r.onload=q(this._chunkLoaded,this),r.onerror=q(this._chunkError,this)),r.open(this._config.downloadRequestBody?"POST":"GET",this._input,!ie),this._config.downloadRequestHeaders){var l=this._config.downloadRequestHeaders;for(var h in l)r.setRequestHeader(h,l[h])}this._config.chunkSize&&r.setRequestHeader("Range","bytes="+this._start+"-"+(this._start+this._config.chunkSize-1));try{r.send(this._config.downloadRequestBody)}catch(C){this._chunkError(C.message)}ie&&0===r.status&&this._chunkError()}},this._chunkLoaded=function(){var h;4===r.readyState&&(r.status<200||400<=r.status?this._chunkError():(this._start+=this._config.chunkSize?this._config.chunkSize:r.responseText.length,this._finished=!this._config.chunkSize||this._start>=(null===(h=r.getResponseHeader("Content-Range"))?-1:parseInt(h.substring(h.lastIndexOf("/")+1))),this.parseChunk(r.responseText)))},this._chunkError=function(l){this._sendError(new Error(r.statusText||l))}}function Re(a){var r,l;(a=a||{}).chunkSize||(a.chunkSize=m.LocalChunkSize),W.call(this,a);var h=typeof FileReader<"u";this.stream=function(p){this._input=p,l=p.slice||p.webkitSlice||p.mozSlice,h?((r=new FileReader).onload=q(this._chunkLoaded,this),r.onerror=q(this._chunkError,this)):r=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var p=this._input;if(this._config.chunkSize){var C=Math.min(this._start+this._config.chunkSize,this._input.size);p=l.call(p,this._start,C)}var D=r.readAsText(p,this._config.encoding);h||this._chunkLoaded({target:{result:D}})},this._chunkLoaded=function(p){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(p.target.result)},this._chunkError=function(){this._sendError(r.error)}}function ye(a){var r;W.call(this,a=a||{}),this.stream=function(l){return r=l,this._nextChunk()},this._nextChunk=function(){if(!this._finished){var l,h=this._config.chunkSize;return h?(l=r.substring(0,h),r=r.substring(h)):(l=r,r=""),this._finished=!r,this.parseChunk(l)}}}function ke(a){W.call(this,a=a||{});var r=[],l=!0,h=!1;this.pause=function(){W.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){W.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(p){this._input=p,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){h&&1===r.length&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),r.length?this.parseChunk(r.shift()):l=!0},this._streamData=q(function(p){try{r.push("string"==typeof p?p:p.toString(this._config.encoding)),l&&(l=!1,this._checkIsFinished(),this.parseChunk(r.shift()))}catch(C){this._streamError(C)}},this),this._streamError=q(function(p){this._streamCleanUp(),this._sendError(p)},this),this._streamEnd=q(function(){this._streamCleanUp(),h=!0,this._streamData("")},this),this._streamCleanUp=q(function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)},this)}function De(a){var r,l,h,p=Math.pow(2,53),C=-p,D=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)([eE][-+]?\d+)?\s*$/,P=/^(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))$/,T=this,f=0,N=0,g=!1,ne=!1,Y=[],u={data:[],errors:[],meta:{}};if(A(a.step)){var b=a.step;a.step=function(_){if(u=_,Z())E();else{if(E(),0===u.data.length)return;f+=_.data.length,a.preview&&f>a.preview?l.abort():(u.data=u.data[0],b(u,T))}}}function G(_){return"greedy"===a.skipEmptyLines?""===_.join("").trim():1===_.length&&0===_[0].length}function E(){return u&&h&&(H("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+m.DefaultDelimiter+"'"),h=!1),a.skipEmptyLines&&(u.data=u.data.filter(function(_){return!G(_)})),Z()&&function(){if(u)if(Array.isArray(u.data[0])){for(var v=0;Z()&&v<u.data.length;v++)u.data[v].forEach(_);u.data.splice(0,1)}else u.data.forEach(_);function _(O,M){A(a.transformHeader)&&(O=a.transformHeader(O,M)),Y.push(O)}}(),function(){if(!u||!a.header&&!a.dynamicTyping&&!a.transform)return u;function _(O,M){var R,S=a.header?{}:[];for(R=0;R<O.length;R++){var I=R,y=O[R];a.header&&(I=R>=Y.length?"__parsed_extra":Y[R]),a.transform&&(y=a.transform(y,I)),y=L(I,y),"__parsed_extra"===I?(S[I]=S[I]||[],S[I].push(y)):S[I]=y}return a.header&&(R>Y.length?H("FieldMismatch","TooManyFields","Too many fields: expected "+Y.length+" fields but parsed "+R,N+M):R<Y.length&&H("FieldMismatch","TooFewFields","Too few fields: expected "+Y.length+" fields but parsed "+R,N+M)),S}var v=1;return!u.data.length||Array.isArray(u.data[0])?(u.data=u.data.map(_),v=u.data.length):u.data=_(u.data,0),a.header&&u.meta&&(u.meta.fields=Y),N+=v,u}()}function Z(){return a.header&&0===Y.length}function L(_,v){return O=_,a.dynamicTypingFunction&&void 0===a.dynamicTyping[O]&&(a.dynamicTyping[O]=a.dynamicTypingFunction(O)),!0===(a.dynamicTyping[O]||a.dynamicTyping)?"true"===v||"TRUE"===v||"false"!==v&&"FALSE"!==v&&(function(M){if(D.test(M)){var R=parseFloat(M);if(C<R&&R<p)return!0}return!1}(v)?parseFloat(v):P.test(v)?new Date(v):""===v?null:v):v;var O}function H(_,v,O,M){var R={type:_,code:v,message:O};void 0!==M&&(R.row=M),u.errors.push(R)}this.parse=function(_,v,O){if(a.newline||(a.newline=function(I,y){I=I.substring(0,1048576);var ce=new RegExp(Ce(y)+"([^]*?)"+Ce(y),"gm"),oe=(I=I.replace(ce,"")).split("\r"),Q=I.split("\n");if(1===oe.length||1<Q.length&&Q[0].length<oe[0].length)return"\n";for(var se=0,z=0;z<oe.length;z++)"\n"===oe[z][0]&&se++;return se>=oe.length/2?"\r\n":"\r"}(_,a.quoteChar||'"')),h=!1,a.delimiter)A(a.delimiter)&&(a.delimiter=a.delimiter(_),u.meta.delimiter=a.delimiter);else{var R=function(I,y,ce,oe,Q){var le,se,z,j;Q=Q||[",","\t","|",";",m.RECORD_SEP,m.UNIT_SEP];for(var de=0;de<Q.length;de++){var B=Q[de],ue=0,J=0,xe=0;z=void 0;for(var pe=new Se({comments:oe,delimiter:B,newline:y,preview:10}).parse(I),we=0;we<pe.data.length;we++)if(ce&&G(pe.data[we]))xe++;else{var _e=pe.data[we].length;J+=_e,void 0!==z?0<_e&&(ue+=Math.abs(_e-z),z=_e):z=_e}0<pe.data.length&&(J/=pe.data.length-xe),(void 0===se||ue<=se)&&(void 0===j||j<J)&&1.99<J&&(se=ue,le=B,j=J)}return{successful:!!(a.delimiter=le),bestDelimiter:le}}(_,a.newline,a.skipEmptyLines,a.comments,a.delimitersToGuess);R.successful?a.delimiter=R.bestDelimiter:(h=!0,a.delimiter=m.DefaultDelimiter),u.meta.delimiter=a.delimiter}var S=be(a);return a.preview&&a.header&&S.preview++,r=_,l=new Se(S),u=l.parse(r,v,O),E(),g?{meta:{paused:!0}}:u||{meta:{paused:!1}}},this.paused=function(){return g},this.pause=function(){g=!0,l.abort(),r=A(a.chunk)?"":r.substring(l.getCharIndex())},this.resume=function(){T.streamer._halted?(g=!1,T.streamer.parseChunk(r,!0)):setTimeout(T.resume,3)},this.aborted=function(){return ne},this.abort=function(){ne=!0,l.abort(),u.meta.aborted=!0,A(a.complete)&&a.complete(u),r=""}}function Ce(a){return a.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function Se(a){var r,l=(a=a||{}).delimiter,h=a.newline,p=a.comments,C=a.step,D=a.preview,P=a.fastMode,T=r=null==a.quoteChar?'"':a.quoteChar;if(void 0!==a.escapeChar&&(T=a.escapeChar),("string"!=typeof l||-1<m.BAD_DELIMITERS.indexOf(l))&&(l=","),p===l)throw new Error("Comment character same as delimiter");!0===p?p="#":("string"!=typeof p||-1<m.BAD_DELIMITERS.indexOf(p))&&(p=!1),"\n"!==h&&"\r"!==h&&"\r\n"!==h&&(h="\n");var f=0,N=!1;this.parse=function(g,ne,Y){if("string"!=typeof g)throw new Error("Input must be a string");var u=g.length,b=l.length,G=h.length,E=p.length,Z=A(C),L=[],H=[],_=[],v=f=0;if(!g)return j();if(P||!1!==P&&-1===g.indexOf(r)){for(var O=g.split(h),M=0;M<O.length;M++){if(f+=(_=O[M]).length,M!==O.length-1)f+=h.length;else if(Y)return j();if(!p||_.substring(0,E)!==p){if(Z){if(L=[],Q(_.split(l)),de(),N)return j()}else Q(_.split(l));if(D&&D<=M)return L=L.slice(0,D),j(!0)}}return j()}for(var R=g.indexOf(l,f),S=g.indexOf(h,f),I=new RegExp(Ce(T)+Ce(r),"g"),y=g.indexOf(r,f);;)if(g[f]!==r)if(p&&0===_.length&&g.substring(f,f+E)===p){if(-1===S)return j();S=g.indexOf(h,f=S+G),R=g.indexOf(l,f)}else if(-1!==R&&(R<S||-1===S))_.push(g.substring(f,R)),R=g.indexOf(l,f=R+b);else{if(-1===S)break;if(_.push(g.substring(f,S)),z(S+G),Z&&(de(),N))return j();if(D&&L.length>=D)return j(!0)}else for(y=f,f++;;){if(-1===(y=g.indexOf(r,y+1)))return Y||H.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:L.length,index:f}),se();if(y===u-1)return se(g.substring(f,y).replace(I,r));if(r!==T||g[y+1]!==T){if(r===T||0===y||g[y-1]!==T){-1!==R&&R<y+1&&(R=g.indexOf(l,y+1)),-1!==S&&S<y+1&&(S=g.indexOf(h,y+1));var ce=le(-1===S?R:Math.min(R,S));if(g.substr(y+1+ce,b)===l){_.push(g.substring(f,y).replace(I,r)),g[f=y+1+ce+b]!==r&&(y=g.indexOf(r,f)),R=g.indexOf(l,f),S=g.indexOf(h,f);break}var oe=le(S);if(g.substring(y+1+oe,y+1+oe+G)===h){if(_.push(g.substring(f,y).replace(I,r)),z(y+1+oe+G),R=g.indexOf(l,f),y=g.indexOf(r,f),Z&&(de(),N))return j();if(D&&L.length>=D)return j(!0);break}H.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:L.length,index:f}),y++}}else y++}return se();function Q(B){L.push(B),v=f}function le(B){var ue=0;if(-1!==B){var J=g.substring(y+1,B);J&&""===J.trim()&&(ue=J.length)}return ue}function se(B){return Y||(void 0===B&&(B=g.substring(f)),_.push(B),f=u,Q(_),Z&&de()),j()}function z(B){f=B,Q(_),_=[],S=g.indexOf(h,f)}function j(B){return{data:L,errors:H,meta:{delimiter:l,linebreak:h,aborted:N,truncated:!!B,cursor:v+(ne||0)}}}function de(){C(j()),L=[],H=[]}},this.abort=function(){N=!0},this.getCharIndex=function(){return f}}function Ue(a){var r=a.data,l=ge[r.workerId],h=!1;if(r.error)l.userError(r.error,r.file);else if(r.results&&r.results.data){var p={abort:function(){h=!0,Ze(r.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:fe,resume:fe};if(A(l.userStep)){for(var C=0;C<r.results.data.length&&(l.userStep({data:r.results.data[C],errors:r.results.errors,meta:r.results.meta},p),!h);C++);delete r.results}else A(l.userChunk)&&(l.userChunk(r.results,p,r.file),delete r.results)}r.finished&&!h&&Ze(r.workerId,r.results)}function Ze(a,r){var l=ge[a];A(l.userComplete)&&l.userComplete(r),l.terminate(),delete ge[a]}function fe(){throw new Error("Not implemented.")}function be(a){if("object"!=typeof a||null===a)return a;var r=Array.isArray(a)?[]:{};for(var l in a)r[l]=be(a[l]);return r}function q(a,r){return function(){a.apply(r,arguments)}}function A(a){return"function"==typeof a}return ve&&(F.onmessage=function(a){var r=a.data;if(void 0===m.WORKER_ID&&r&&(m.WORKER_ID=r.workerId),"string"==typeof r.input)F.postMessage({workerId:m.WORKER_ID,results:m.parse(r.input,r.config),finished:!0});else if(F.File&&r.input instanceof File||r.input instanceof Object){var l=m.parse(r.input,r.config);l&&F.postMessage({workerId:m.WORKER_ID,results:l,finished:!0})}}),(e.prototype=Object.create(W.prototype)).constructor=e,(Re.prototype=Object.create(W.prototype)).constructor=Re,(ye.prototype=Object.create(ye.prototype)).constructor=ye,(ke.prototype=Object.create(W.prototype)).constructor=ke,m},void 0!==(V=k.apply(Ne,[]))&&(ze.exports=V)}}]);