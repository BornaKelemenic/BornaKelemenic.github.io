import{b as $e,c as Pe,d as Xe,e as Ye,g as nt}from"./chunk-LS3ORNY6.js";import"./chunk-RV4RZYMT.js";import{a as ze,c as je,d as Ae,e as Ke,f as We,g as qe,h as Ge,i as Qe,j as Ue,k as He,l as Je,m as Z,o as ee,p as te}from"./chunk-52VUZKTX.js";import{c as Te,d as be,e as De,f as Ie,g as Ee,h as H,i as Ze,j as et,k as tt,l as it}from"./chunk-RCUXNONF.js";import{a as Se,f as he,h as W,i as q,k as _e,l as ve,m as Me}from"./chunk-SXL6WRPU.js";import{a as Re,h as J,i as Be,j as X,k as we,o as ke,q as Ne,u as Y,w as Oe,z as Ve}from"./chunk-CN5XTSAD.js";import{Q as Le,a as k,b as Ce,e as N}from"./chunk-XMT65DH3.js";import{Ab as ge,Bb as f,Cb as h,Db as fe,Ia as u,K as F,Ma as p,N as z,Oa as de,Ra as D,Sa as j,T as me,Ua as E,Va as $,Wa as r,X as d,Xa as o,Y as _,Ya as g,Yc as xe,Za as x,_a as C,_b as w,a as se,ab as B,da as R,db as P,dc as U,ea as L,fb as m,fd as ye,ja as ce,kd as G,ld as Fe,na as pe,od as v,p as ae,pb as ue,pd as M,qb as s,rb as S,sb as c,t as le,ta as n,tb as re,u as oe,ub as T,ud as O,vb as A,vd as V,wb as K,yb as y}from"./chunk-X3MDISX7.js";var pt={sortBy:J.NEWEST_FIRST,targetFace:null,shootingType:null,distance:null},ot="archery-stats-session-filters",I=(()=>{class t{constructor(){this.store=he({name:ot},_e(pt)),ve(this.store,{key:ot,storage:Me}),this.sortBy$=this.store.pipe(q(e=>e.sortBy),F({refCount:!0,bufferSize:1})),this.targetFace$=this.store.pipe(q(e=>e.targetFace),F({refCount:!0,bufferSize:1})),this.shootingType$=this.store.pipe(q(e=>e.shootingType),F({refCount:!0,bufferSize:1})),this.distance$=this.store.pipe(q(e=>e.distance),F({refCount:!0,bufferSize:1})),this.filters$=oe({sortBy:this.sortBy$,targetFace:this.targetFace$,shootingType:this.shootingType$,distance:this.distance$}).pipe(F({refCount:!0,bufferSize:1})),this.activeFiltersCount$=oe({targetFace:this.targetFace$,shootingType:this.shootingType$,distance:this.distance$}).pipe(le(e=>{let i=0;return Object.values(e).forEach(a=>{Le(a)&&i++}),i}),F({refCount:!0,bufferSize:1}))}setSortBy(e){this.store.update(W("sortBy",e))}setTargetFace(e){this.store.update(W("targetFace",e))}setShootingType(e){this.store.update(W("shootingType",e))}setDistance(e){this.store.update(W("distance",e))}getStoreProp(e){return this.store.getValue()[e]}resetAll(){this.store.reset()}resetOnlyFilters(){Se(()=>{let e=this.getStoreProp("sortBy");this.resetAll(),this.setSortBy(e)})}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275prov=me({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();function dt(t,l){if(t&1&&(r(0,"mat-radio-button",3),s(1),o()),t&2){let e=l.$implicit,i=m().$implicit;p("value",e[0]),n(),c(" ",i(e[1])," ")}}function ut(t,l){if(t&1&&(g(0,"img",8),r(1,"span",9),s(2),o()),t&2){let e=m().$implicit,i=m();p("ngSrc",i.TargetFaceImgMap.get(i.targetFaceControl.value)),n(2),c(" ",e(i.TargetFaceNameMap.get(i.targetFaceControl.value))," ")}}function gt(t,l){if(t&1&&s(0),t&2){let e=m().$implicit;c(" ",e("generic.all")," ")}}function ft(t,l){if(t&1&&(T(0)(1),r(2,"mat-option",3),g(3,"img",8),r(4,"span",9),s(5),o()()),t&2){let e=l.$implicit,i=m().$implicit,a=m(),b=e[0],ne=e[1];n(2),p("value",b),n(),p("ngSrc",a.TargetFaceImgMap.get(b)),n(2),c(" ",i(ne)," ")}}function St(t,l){if(t&1&&(x(0),r(1,"div",1)(2,"label"),s(3),o(),r(4,"mat-radio-group",2)(5,"mat-radio-button",3),s(6),o(),E(7,dt,2,2,"mat-radio-button",3,j),o()(),r(9,"mat-form-field",4)(10,"mat-label"),s(11),o(),r(12,"mat-select",2)(13,"mat-select-trigger"),u(14,ut,3,2)(15,gt,1,1),o(),r(16,"mat-option",5),s(17),o(),E(18,ft,6,3,"mat-option",3,j),o()(),r(20,"div",6)(21,"label"),s(22),o(),g(23,"app-small-counter",7),o(),C()),t&2){let e=l.$implicit,i=m();n(3),c(" ",e("form.labels.shootingType"),": "),n(),p("formControl",i.shootingTypeControl),n(),p("value",null),n(),S(e("generic.all")),n(),$(i.ShootingTypeNameMap.entries()),n(4),S(e("form.labels.targetFace")),n(),p("formControl",i.targetFaceControl),n(2),D(i.targetFaceControl.value!=="all"?14:15),n(3),S(e("generic.all")),n(),$(i.TargetFaceNameMap.entries()),n(4),S(e("form.labels.distance")),n(),p("formControl",i.distanceControl)}}var rt=(()=>{class t{constructor(){this.destroyRef=d(ce),this.sessionFiltersRepo=d(I),this.TargetFaceNameMap=ee,this.TargetFaceImgMap=te,this.ShootingType=Je,this.ShootingTypeNameMap=Z,this.targetFaceControl=new Y(this.sessionFiltersRepo.getStoreProp("targetFace")??"all",{nonNullable:!0}),this.shootingTypeControl=new Y(this.sessionFiltersRepo.getStoreProp("shootingType")),this.distanceControl=new Y(this.sessionFiltersRepo.getStoreProp("distance"),{nonNullable:!0,validators:[ke.min(0)]}),this.listenToRepoValueChanges(),this.setupControlValueChangeListeners()}listenToRepoValueChanges(){this.sessionFiltersRepo.filters$.pipe(G(this.destroyRef)).subscribe(({targetFace:e,shootingType:i,distance:a})=>{this.targetFaceControl.setValue(e??"all",{emitEvent:!1}),this.shootingTypeControl.setValue(i,{emitEvent:!1}),this.distanceControl.setValue(a,{emitEvent:!1})})}setupControlValueChangeListeners(){this.targetFaceControl.valueChanges.pipe(G(this.destroyRef)).subscribe(e=>this.sessionFiltersRepo.setTargetFace(e==="all"?null:e)),this.shootingTypeControl.valueChanges.pipe(G(this.destroyRef)).subscribe(e=>this.sessionFiltersRepo.setShootingType(e)),this.distanceControl.valueChanges.pipe(G(this.destroyRef)).subscribe(e=>this.sessionFiltersRepo.setDistance(e===0?null:e))}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275cmp=_({type:t,selectors:[["app-session-filters"]],standalone:!0,features:[y],decls:1,vars:0,consts:[[4,"transloco"],[1,"flex-column","margin-bottom-4x"],[3,"formControl"],[3,"value"],[1,"margin-bottom-4x"],["value","all"],[1,"flex-column","align-items-start"],["suffix","m","moreIncrements","",3,"formControl"],["width","30","height","30",2,"vertical-align","middle",3,"ngSrc"],[1,"margin-left-2x"]],template:function(i,a){i&1&&u(0,St,24,10,"ng-container",0)},dependencies:[Ve,Ne,Oe,U,M,v,He,qe,Ke,We,Ue,je,ze,Ge,Qe,xe,Ae],styles:["[_nghost-%COMP%]{display:block}mat-form-field[_ngcontent-%COMP%]{width:100%}"],changeDetection:0})}}return t})();function ht(t,l){if(t&1){let e=B();x(0),r(1,"h2",1),s(2),o(),r(3,"mat-dialog-content"),g(4,"app-session-filters"),o(),r(5,"mat-dialog-actions")(6,"button",2),s(7),o(),g(8,"span",3),r(9,"button",4),P("click",function(){R(e);let a=m();return L(a.sessionFiltersRepo.resetOnlyFilters())}),s(10),o()(),C()}if(t&2){let e=l.$implicit;n(2),c(" ",e("session.dialogs.filtersDialog.title")," "),n(5),c(" ",e("generic.close")," "),n(3),c(" ",e("generic.resetFilters")," ")}}var at=(()=>{class t{constructor(){this.sessionFiltersRepo=d(I)}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275cmp=_({type:t,selectors:[["app-session-filters-dialog"]],standalone:!0,features:[y],decls:1,vars:0,consts:[[4,"transloco"],["mat-dialog-title",""],["mat-button","","type","button","mat-dialog-close",""],[1,"spacer"],["mat-button","","color","warn",3,"click"]],template:function(i,a){i&1&&u(0,ht,11,3,"ng-container",0)},dependencies:[M,v,rt,H,be,De,Ee,Ie,N,k],styles:["[_nghost-%COMP%]{display:block}"],changeDetection:0})}}return t})();function _t(t,l){t&1&&(r(0,"mat-icon"),s(1,"lock"),o())}function xt(t,l){if(t&1&&(x(0),T(1),g(2,"img",1),r(3,"div",2)(4,"span",3),s(5),u(6,_t,2,0,"mat-icon"),o(),r(7,"small"),s(8),f(9,"date"),f(10,"dateDistance"),o(),r(11,"div",4)(12,"small"),s(13),o(),r(14,"small"),s(15,"\u2022"),o(),r(16,"small"),s(17),o(),r(18,"small"),s(19,"\u2022"),o(),r(20,"small"),s(21),f(22,"async"),o(),r(23,"small"),s(24,"\u2022"),o(),r(25,"small"),s(26),o(),r(27,"small"),s(28),f(29,"async"),o(),r(30,"small"),s(31,"\u2022"),o(),r(32,"small"),s(33),o(),r(34,"small"),s(35),f(36,"async"),o()()(),g(37,"app-session-options-menu",5),C()),t&2){let e=l.$implicit,i=m(),a=i.$session();n(2),p("ngSrc",i.TargetFaceImgMap.get(a.targetFace)),n(3),c(" ",a.name," "),n(),D(a.locked?6:-1),n(2),re(" ",fe(9,14,a.date,"short")," (",h(10,17,a.date),") "),n(5),S(e(i.ShootingTypeNameMap.get(a.shootingType))),n(4),c("",a.distance,"m"),n(4),re("",e("session.info.rounds"),": ",h(22,19,i.roundCount$),""),n(5),c("",e("session.info.avg"),":"),n(2),S(h(29,21,i.avgScore$)),n(5),c("",e("session.info.total"),":"),n(2),S(h(36,23,i.shotsTotal$)),n(2),p("session",a)}}var mt=(()=>{class t{constructor(){this.sessionsDbService=d(X),this.TargetFaceNameMap=ee,this.TargetFaceImgMap=te,this.ShootingTypeNameMap=Z,this.roundCount$=ae(Re(()=>this.sessionsDbService.getRoundsCountBySessionId(this.$session().id))),this.$session=pe.required({alias:"session"}),this.session$=Fe(this.$session).pipe(F({refCount:!0,bufferSize:1})),this.shotsTotal$=this.session$.pipe(z(e=>this.sessionsDbService.getTotalScoreBySessionID$(e.id))),this.avgScore$=this.session$.pipe(z(e=>this.sessionsDbService.getAverageScoreBySessionID$(e.id)))}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275cmp=_({type:t,selectors:[["app-session-list-item"]],inputs:{$session:[1,"session","$session"]},standalone:!0,features:[y],decls:1,vars:0,consts:[[4,"transloco"],["alt","Target face","width","50","height","50",2,"border-radius","5px",3,"ngSrc"],[1,"flex-column","align-items-start"],[1,"session-name"],[1,"session-info"],[3,"session"]],template:function(i,a){i&1&&u(0,xt,38,25,"ng-container",0)},dependencies:[w,M,v,U,Ye,Xe,nt,V,O],styles:["[_nghost-%COMP%]{display:grid;grid-template-columns:50px minmax(0,1fr) 40px;align-items:center;justify-content:flex-start;gap:var(--spacing-3x);padding:var(--spacing-2x);background-color:var(--mdc-outlined-card-container-color);border-style:solid;border-radius:var(--mdc-outlined-card-container-shape);border-width:var(--mdc-outlined-card-outline-width);border-color:var(--mdc-outlined-card-outline-color);box-shadow:var(--mdc-outlined-card-container-elevation)}.session-name[_ngcontent-%COMP%]{display:flex;align-items:center;column-gap:var(--spacing-1x);font-size:1.25em}.session-info[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;align-items:center;column-gap:var(--spacing-1x)}"],changeDetection:0})}}return t})();function Ct(t,l){t&1&&(r(0,"mat-icon",5),s(1,"radio_button_checked"),o())}function yt(t,l){t&1&&(r(0,"mat-icon"),s(1,"radio_button_unchecked"),o())}function vt(t,l){if(t&1){let e=B();T(0)(1),r(2,"button",4),P("click",function(){R(e);let a=K(0),b=m(2);return L(b.sessionFiltersRepo.setSortBy(a))}),u(3,Ct,2,0,"mat-icon",5)(4,yt,2,0,"mat-icon"),r(5,"span"),s(6),o()()}if(t&2){let e=l.$implicit,i=m().$implicit,a=K(1),b=A(e[0]),ne=e[1];n(3),D(a===b?3:4),n(3),S(i(ne))}}function Mt(t,l){if(t&1&&(x(0),T(1),f(2,"async"),r(3,"button",2)(4,"mat-icon"),s(5,"sort"),o(),s(6),o(),r(7,"mat-menu",null,0),E(9,vt,7,3,"button",3,j),o(),C()),t&2){let e=l.$implicit,i=ue(8),a=m();n();let b=A(h(2,2,a.sessionFiltersRepo.sortBy$));n(2),p("matMenuTriggerFor",i),n(3),c(" ",e(a.SessionSortLabelMap.get(b))," "),n(3),$(a.SessionSortLabelMap.entries())}}var ct=(()=>{class t{constructor(){this.sessionFiltersRepo=d(I),this.SessionSort=J,this.SessionSortLabelMap=Be}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275cmp=_({type:t,selectors:[["app-session-sort-menu"]],standalone:!0,features:[y],decls:1,vars:0,consts:[["menu","matMenu"],[4,"transloco"],["mat-button","","type","button",3,"matMenuTriggerFor"],["mat-menu-item",""],["mat-menu-item","",3,"click"],["color","primary"]],template:function(i,a){i&1&&u(0,Mt,11,5,"ng-container",1)},dependencies:[w,M,v,it,et,Ze,tt,N,k,V,O],styles:["[_nghost-%COMP%]{display:inline-block}"],changeDetection:0})}}return t})();var Ft=(t,l)=>l.id,Tt=t=>["/sessions",t];function bt(t,l){if(t&1&&s(0),t&2){m();let e=K(1);c(" (",e,") ")}}function Dt(t,l){if(t&1&&(r(0,"a",5),g(1,"app-session-list-item",8),f(2,"async"),o()),t&2){let e=l.$implicit,i=m(2);p("routerLink",ge(6,Tt,e.id)),n(),de("active",h(2,4,i.appStateRepo.lastVisitedSession$)===e.id),p("session",e)}}function It(t,l){if(t&1&&(r(0,"h5",6),s(1),o()),t&2){let e=m().$implicit;n(),c(" ",e("sessionsList.noSessions")," ")}}function Et(t,l){if(t&1){let e=B();x(0),T(1),f(2,"async"),r(3,"app-page-with-title",1)(4,"button",2),P("click",function(){R(e);let a=m();return L(a.openFiltersDialog())}),r(5,"mat-icon"),s(6,"filter_alt"),o(),s(7),u(8,bt,1,1),o(),r(9,"div",3)(10,"div",4),g(11,"app-session-sort-menu"),o(),E(12,Dt,3,8,"a",5,Ft,!1,It,2,1,"h5",6),f(15,"async"),o(),r(16,"button",7)(17,"mat-icon"),s(18,"add"),o()()(),C()}if(t&2){let e=l.$implicit,i=m();n();let a=A(h(2,4,i.sessionFiltersRepo.activeFiltersCount$));n(2),p("page-title",e("sessionsList.title")),n(4),c(" ",e("generic.filters")," "),n(),D(a?8:-1),n(4),$(h(15,7,i.sessions$))}}var rn=(()=>{class t{constructor(){this.dialog=d(Te),this.sessionsDbService=d(X),this.appStateRepo=d(Pe),this.sessionFiltersRepo=d(I),this.sessions$=this.sessionFiltersRepo.filters$.pipe(z(e=>this.sessionsDbService.getFilteredSessions(se({},e))))}openFiltersDialog(){this.dialog.open(at,{width:"500px"})}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275cmp=_({type:t,selectors:[["app-session-list-page"]],standalone:!0,features:[y],decls:1,vars:0,consts:[[4,"transloco"],[3,"page-title"],["mat-button","","page-action","",3,"click"],[1,"standard-centering"],[1,"margin-bottom-2x"],[3,"routerLink"],[1,"text-center","margin-top-6x"],["mat-fab","","routerLink","/create",1,"fab-bottom-right"],[3,"session"]],template:function(i,a){i&1&&u(0,Et,19,9,"ng-container",0)},dependencies:[w,ye,M,v,mt,we,ct,N,k,Ce,V,O,$e,H],styles:["[_nghost-%COMP%]{display:block;padding-bottom:var(--spacing-fab-clearance)}a[_ngcontent-%COMP%]{display:block}a[_ngcontent-%COMP%]:not(:last-of-type){margin-bottom:var(--spacing-4x)}app-session-list-item.active[_ngcontent-%COMP%]{color:var(--sys-on-primary-container);background-color:var(--sys-primary-container)}"],changeDetection:0})}}return t})();export{rn as SessionListPageComponent};
