import{b as $e,c as ke,d as He,e as Je,g as tt}from"./chunk-6KS4BLAV.js";import"./chunk-45HXEJ6V.js";import{a as Ve,c as je,d as ze,e as Ae,f as Ke,g as We,h as qe,i as Ge,j as Qe,k as Ue,l as Y,n as Z,o as ee}from"./chunk-DIJB2MJM.js";import{c as Te,d as be,e as De,f as Ie,g as Ee,h as H,i as Xe,j as Ye,k as Ze,l as et}from"./chunk-RCNC62OS.js";import{a as Se,f as he,h as q,i as G,k as _e,l as ve,m as Me}from"./chunk-5Z3A46A4.js";import{a as Re,h as J,i as Le,j as X,k as we,q as Pe,u as re,w as Ne,z as Oe}from"./chunk-EZSPW3BN.js";import{Q as Be,a as P,b as Ce,e as N}from"./chunk-LFKKBSHB.js";import{Ab as ue,Bb as S,Cb as h,Db as fe,K as b,Ka as u,Ma as p,N as j,Oa as de,Ra as D,Sa as z,T as ce,Ua as E,Va as $,Wa as s,X as g,Xa as r,Y as _,Ya as f,Yc as xe,Za as x,_a as C,_b as w,a as ae,ab as L,da as R,db as k,dc as Q,ea as B,fb as c,fd as ye,ja as me,kd as U,ld as Fe,na as pe,od as M,p as se,pb as ge,pd as F,qb as l,rb as y,sb as m,t as le,ta as o,tb as oe,u as ne,ub as T,ud as O,vb as A,vd as V,wb as K,yb as v}from"./chunk-32JRF7TD.js";var ct={sortBy:J.NEWEST_FIRST,targetFace:null,shootingType:null},it="archery-stats-session-filters",I=(()=>{let i=class i{constructor(){this.store=he({name:it},_e(ct)),ve(this.store,{key:it,storage:Me}),this.sortBy$=this.store.pipe(G(e=>e.sortBy),b({refCount:!0,bufferSize:1})),this.targetFace$=this.store.pipe(G(e=>e.targetFace),b({refCount:!0,bufferSize:1})),this.shootingType$=this.store.pipe(G(e=>e.shootingType),b({refCount:!0,bufferSize:1})),this.filters$=ne({sortBy:this.sortBy$,targetFace:this.targetFace$,shootingType:this.shootingType$}).pipe(b({refCount:!0,bufferSize:1})),this.activeFiltersCount$=ne({targetFace:this.targetFace$,shootingType:this.shootingType$}).pipe(le(e=>{let n=0;return Object.values(e).forEach(d=>{Be(d)&&n++}),n}),b({refCount:!0,bufferSize:1}))}setSortBy(e){this.store.update(q("sortBy",e))}setTargetFace(e){this.store.update(q("targetFace",e))}setShootingType(e){this.store.update(q("shootingType",e))}getStoreProp(e){return this.store.getValue()[e]}resetAll(){this.store.reset()}resetOnlyFilters(){Se(()=>{let e=this.getStoreProp("sortBy");this.resetAll(),this.setSortBy(e)})}};i.\u0275fac=function(n){return new(n||i)},i.\u0275prov=ce({token:i,factory:i.\u0275fac,providedIn:"root"});let t=i;return t})();function mt(t,i){if(t&1&&(s(0,"mat-radio-button",3),l(1),r()),t&2){let a=i.$implicit,e=c().$implicit;p("value",a[0]),o(),m(" ",e(a[1])," ")}}function pt(t,i){if(t&1&&(f(0,"img",5),s(1,"span",6),l(2),r()),t&2){let a=c().$implicit,e=c();p("ngSrc",e.TargetFaceImgMap.get(e.targetFaceControl.value)),o(2),m(" ",a(e.TargetFaceNameMap.get(e.targetFaceControl.value))," ")}}function dt(t,i){if(t&1&&l(0),t&2){let a=c().$implicit;m(" ",a("generic.all")," ")}}function gt(t,i){if(t&1&&(T(0)(1),s(2,"mat-option",3),f(3,"img",5),s(4,"span",6),l(5),r()()),t&2){let a=i.$implicit,e=c().$implicit,n=c(),d=a[0],ie=a[1];o(2),p("value",d),o(),p("ngSrc",n.TargetFaceImgMap.get(d)),o(2),m(" ",e(ie)," ")}}function ut(t,i){if(t&1&&(x(0),s(1,"div",1)(2,"label"),l(3),r(),s(4,"mat-radio-group",2)(5,"mat-radio-button",3),l(6),r(),E(7,mt,2,2,"mat-radio-button",3,z),r()(),s(9,"mat-form-field")(10,"mat-label"),l(11),r(),s(12,"mat-select",2)(13,"mat-select-trigger"),u(14,pt,3,2)(15,dt,1,1),r(),s(16,"mat-option",4),l(17),r(),E(18,gt,6,3,"mat-option",3,z),r()(),C()),t&2){let a=i.$implicit,e=c();o(3),m(" ",a("form.labels.shootingType"),": "),o(),p("formControl",e.shootingTypeControl),o(),p("value",null),o(),y(a("generic.all")),o(),$(e.ShootingTypeNameMap.entries()),o(4),y(a("form.labels.targetFace")),o(),p("formControl",e.targetFaceControl),o(2),D(e.targetFaceControl.value!=="all"?14:15),o(3),y(a("generic.all")),o(),$(e.TargetFaceNameMap.entries())}}var nt=(()=>{let i=class i{constructor(){this.destroyRef=g(me),this.sessionFiltersRepo=g(I),this.TargetFaceNameMap=Z,this.TargetFaceImgMap=ee,this.ShootingType=Ue,this.ShootingTypeNameMap=Y,this.targetFaceControl=new re(this.sessionFiltersRepo.getStoreProp("targetFace")??"all",{nonNullable:!0}),this.shootingTypeControl=new re(this.sessionFiltersRepo.getStoreProp("shootingType")),this.listenToRepoValueChanges(),this.setupControlValueChangeListeners()}listenToRepoValueChanges(){this.sessionFiltersRepo.filters$.pipe(U(this.destroyRef)).subscribe(({targetFace:e,shootingType:n})=>{this.targetFaceControl.setValue(e??"all",{emitEvent:!1}),this.shootingTypeControl.setValue(n,{emitEvent:!1})})}setupControlValueChangeListeners(){this.targetFaceControl.valueChanges.pipe(U(this.destroyRef)).subscribe(e=>this.sessionFiltersRepo.setTargetFace(e==="all"?null:e)),this.shootingTypeControl.valueChanges.pipe(U(this.destroyRef)).subscribe(e=>this.sessionFiltersRepo.setShootingType(e))}};i.\u0275fac=function(n){return new(n||i)},i.\u0275cmp=_({type:i,selectors:[["app-session-filters"]],standalone:!0,features:[v],decls:1,vars:0,consts:[[4,"transloco"],[1,"flex-column","margin-bottom-4x"],[3,"formControl"],[3,"value"],["value","all"],["width","30","height","30",2,"vertical-align","middle",3,"ngSrc"],[1,"margin-left-2x"]],template:function(n,d){n&1&&u(0,ut,20,8,"ng-container",0)},dependencies:[Oe,Pe,Ne,Q,F,M,We,Ae,Ke,Qe,je,Ve,qe,Ge,xe,ze],styles:["[_nghost-%COMP%]{display:block}mat-form-field[_ngcontent-%COMP%]{width:100%}"],changeDetection:0});let t=i;return t})();function ft(t,i){if(t&1){let a=L();x(0),s(1,"h2",1),l(2),r(),s(3,"mat-dialog-content"),f(4,"app-session-filters"),r(),s(5,"mat-dialog-actions")(6,"button",2),l(7),r(),f(8,"span",3),s(9,"button",4),k("click",function(){R(a);let n=c();return B(n.sessionFiltersRepo.resetOnlyFilters())}),l(10),r()(),C()}if(t&2){let a=i.$implicit;o(2),m(" ",a("session.dialogs.filtersDialog.title")," "),o(5),m(" ",a("generic.close")," "),o(3),m(" ",a("generic.resetFilters")," ")}}var rt=(()=>{let i=class i{constructor(){this.sessionFiltersRepo=g(I)}};i.\u0275fac=function(n){return new(n||i)},i.\u0275cmp=_({type:i,selectors:[["app-session-filters-dialog"]],standalone:!0,features:[v],decls:1,vars:0,consts:[[4,"transloco"],["mat-dialog-title",""],["mat-button","","type","button","mat-dialog-close",""],[1,"spacer"],["mat-button","","color","warn",3,"click"]],template:function(n,d){n&1&&u(0,ft,11,3,"ng-container",0)},dependencies:[F,M,nt,H,be,De,Ee,Ie,N,P],styles:["[_nghost-%COMP%]{display:block}"],changeDetection:0});let t=i;return t})();function St(t,i){t&1&&(s(0,"mat-icon"),l(1,"lock"),r())}function ht(t,i){if(t&1&&(x(0),T(1),f(2,"img",1),s(3,"div",2)(4,"span",3),l(5),u(6,St,2,0,"mat-icon"),r(),s(7,"small"),l(8),S(9,"date"),S(10,"dateDistance"),r(),s(11,"div",4)(12,"small"),l(13),r(),s(14,"small"),l(15,"\u2022"),r(),s(16,"small"),l(17),r(),s(18,"small"),l(19,"\u2022"),r(),s(20,"small"),l(21),S(22,"async"),r(),s(23,"small"),l(24,"\u2022"),r(),s(25,"small"),l(26),r(),s(27,"small"),l(28),S(29,"async"),r(),s(30,"small"),l(31,"\u2022"),r(),s(32,"small"),l(33),r(),s(34,"small"),l(35),S(36,"async"),r()()(),f(37,"app-session-options-menu",5),C()),t&2){let a=i.$implicit,e=c(),n=e.$session();o(2),p("ngSrc",e.TargetFaceImgMap.get(n.targetFace)),o(3),m(" ",n.name," "),o(),D(n.locked?6:-1),o(2),oe(" ",fe(9,14,n.date,"short")," (",h(10,17,n.date),") "),o(5),y(a(e.ShootingTypeNameMap.get(n.shootingType))),o(4),m("",n.distance,"m"),o(4),oe("",a("session.info.rounds"),": ",h(22,19,e.roundCount$),""),o(5),m("",a("session.info.avg"),":"),o(2),y(h(29,21,e.avgScore$)),o(5),m("",a("session.info.total"),":"),o(2),y(h(36,23,e.shotsTotal$)),o(2),p("session",n)}}var st=(()=>{let i=class i{constructor(){this.sessionsDbService=g(X),this.TargetFaceNameMap=Z,this.TargetFaceImgMap=ee,this.ShootingTypeNameMap=Y,this.roundCount$=se(Re(()=>this.sessionsDbService.getRoundsCountBySessionId(this.$session().id))),this.$session=pe.required({alias:"session"}),this.session$=Fe(this.$session).pipe(b({refCount:!0,bufferSize:1})),this.shotsTotal$=this.session$.pipe(j(e=>this.sessionsDbService.getTotalScoreBySessionID$(e.id))),this.avgScore$=this.session$.pipe(j(e=>this.sessionsDbService.getAverageScoreBySessionID$(e.id)))}};i.\u0275fac=function(n){return new(n||i)},i.\u0275cmp=_({type:i,selectors:[["app-session-list-item"]],inputs:{$session:[1,"session","$session"]},standalone:!0,features:[v],decls:1,vars:0,consts:[[4,"transloco"],["alt","Target face","width","50","height","50",2,"border-radius","5px",3,"ngSrc"],[1,"flex-column","align-items-start"],[1,"session-name"],[1,"session-info"],[3,"session"]],template:function(n,d){n&1&&u(0,ht,38,25,"ng-container",0)},dependencies:[w,F,M,Q,Je,He,tt,V,O],styles:["[_nghost-%COMP%]{display:grid;grid-template-columns:50px minmax(0,1fr) 40px;align-items:center;justify-content:flex-start;gap:var(--spacing-3x);padding:var(--spacing-2x);background-color:var(--mdc-outlined-card-container-color);border-style:solid;border-radius:var(--mdc-outlined-card-container-shape);border-width:var(--mdc-outlined-card-outline-width);border-color:var(--mdc-outlined-card-outline-color);box-shadow:var(--mdc-outlined-card-container-elevation)}.session-name[_ngcontent-%COMP%]{display:flex;align-items:center;column-gap:var(--spacing-1x);font-size:1.25em}.session-info[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;align-items:center;column-gap:var(--spacing-1x)}"],changeDetection:0});let t=i;return t})();function _t(t,i){t&1&&(s(0,"mat-icon",5),l(1,"radio_button_checked"),r())}function xt(t,i){t&1&&(s(0,"mat-icon"),l(1,"radio_button_unchecked"),r())}function Ct(t,i){if(t&1){let a=L();T(0)(1),s(2,"button",4),k("click",function(){R(a);let n=K(0),d=c(2);return B(d.sessionFiltersRepo.setSortBy(n))}),u(3,_t,2,0,"mat-icon",5)(4,xt,2,0,"mat-icon"),s(5,"span"),l(6),r()()}if(t&2){let a=i.$implicit,e=c().$implicit,n=K(1),d=A(a[0]),ie=a[1];o(3),D(n===d?3:4),o(3),y(e(ie))}}function yt(t,i){if(t&1&&(x(0),T(1),S(2,"async"),s(3,"button",2)(4,"mat-icon"),l(5,"sort"),r(),l(6),r(),s(7,"mat-menu",null,0),E(9,Ct,7,3,"button",3,z),r(),C()),t&2){let a=i.$implicit,e=ge(8),n=c();o();let d=A(h(2,2,n.sessionFiltersRepo.sortBy$));o(2),p("matMenuTriggerFor",e),o(3),m(" ",a(n.SessionSortLabelMap.get(d))," "),o(3),$(n.SessionSortLabelMap.entries())}}var lt=(()=>{let i=class i{constructor(){this.sessionFiltersRepo=g(I),this.SessionSort=J,this.SessionSortLabelMap=Le}};i.\u0275fac=function(n){return new(n||i)},i.\u0275cmp=_({type:i,selectors:[["app-session-sort-menu"]],standalone:!0,features:[v],decls:1,vars:0,consts:[["menu","matMenu"],[4,"transloco"],["mat-button","","type","button",3,"matMenuTriggerFor"],["mat-menu-item",""],["mat-menu-item","",3,"click"],["color","primary"]],template:function(n,d){n&1&&u(0,yt,11,5,"ng-container",1)},dependencies:[w,F,M,et,Ye,Xe,Ze,N,P,V,O],styles:["[_nghost-%COMP%]{display:inline-block}"],changeDetection:0});let t=i;return t})();var vt=(t,i)=>i.id,Mt=t=>["/sessions",t];function Ft(t,i){if(t&1&&l(0),t&2){c();let a=K(1);m(" (",a,") ")}}function Tt(t,i){if(t&1&&(s(0,"a",5),f(1,"app-session-list-item",8),S(2,"async"),r()),t&2){let a=i.$implicit,e=c(2);p("routerLink",ue(6,Mt,a.id)),o(),de("active",h(2,4,e.appStateRepo.lastVisitedSession$)===a.id),p("session",a)}}function bt(t,i){if(t&1&&(s(0,"h5",6),l(1),r()),t&2){let a=c().$implicit;o(),m(" ",a("sessionsList.noSessions")," ")}}function Dt(t,i){if(t&1){let a=L();x(0),T(1),S(2,"async"),s(3,"app-page-with-title",1)(4,"button",2),k("click",function(){R(a);let n=c();return B(n.openFiltersDialog())}),s(5,"mat-icon"),l(6,"filter_alt"),r(),l(7),u(8,Ft,1,1),r(),s(9,"div",3)(10,"div",4),f(11,"app-session-sort-menu"),r(),E(12,Tt,3,8,"a",5,vt,!1,bt,2,1,"h5",6),S(15,"async"),r(),s(16,"button",7)(17,"mat-icon"),l(18,"add"),r()()(),C()}if(t&2){let a=i.$implicit,e=c();o();let n=A(h(2,4,e.sessionFiltersRepo.activeFiltersCount$));o(2),p("page-title",a("sessionsList.title")),o(4),m(" ",a("generic.filters")," "),o(),D(n?8:-1),o(4),$(h(15,7,e.sessions$))}}var tn=(()=>{let i=class i{constructor(){this.dialog=g(Te),this.sessionsDbService=g(X),this.appStateRepo=g(ke),this.sessionFiltersRepo=g(I),this.sessions$=this.sessionFiltersRepo.filters$.pipe(j(e=>this.sessionsDbService.getFilteredSessions(ae({},e))))}openFiltersDialog(){this.dialog.open(rt,{width:"500px"})}};i.\u0275fac=function(n){return new(n||i)},i.\u0275cmp=_({type:i,selectors:[["app-session-list-page"]],standalone:!0,features:[v],decls:1,vars:0,consts:[[4,"transloco"],[3,"page-title"],["mat-button","","page-action","",3,"click"],[1,"standard-centering"],[1,"margin-bottom-2x"],[3,"routerLink"],[1,"text-center","margin-top-6x"],["mat-fab","","routerLink","/create",1,"fab-bottom-right"],[3,"session"]],template:function(n,d){n&1&&u(0,Dt,19,9,"ng-container",0)},dependencies:[w,ye,F,M,st,we,lt,N,P,Ce,V,O,$e,H],styles:["[_nghost-%COMP%]{display:block;padding-bottom:var(--spacing-fab-clearance)}a[_ngcontent-%COMP%]{display:block}a[_ngcontent-%COMP%]:not(:last-of-type){margin-bottom:var(--spacing-4x)}app-session-list-item.active[_ngcontent-%COMP%]{color:var(--sys-on-primary-container);background-color:var(--sys-primary-container)}"],changeDetection:0});let t=i;return t})();export{tn as SessionListPageComponent};
