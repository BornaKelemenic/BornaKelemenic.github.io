"use strict";(self.webpackChunkarchery_stats=self.webpackChunkarchery_stats||[]).push([[388],{388:(U,x,s)=>{s.r(x),s.d(x,{ActiveSessionPageComponent:()=>h});var l=s(6895),v=s(4850),y=s(7009),f=s(9132),A=s(7579),S=s(2722),b=s(7396),t=s(4650),d=s(4859),C=s(5412),g=(()=>((g||(g={})).DELETE="delete",g))(),c=(()=>{return(o=c||(c={})).GOLD="gold-scheme",o.RED="red-scheme",o.BLUE="blue-scheme",o.BLACK="black-scheme",o.WHITE="white-scheme",c;var o})();function T(o,e){if(1&o){const n=t.EpF();t.TgZ(0,"button",4),t.NdJ("click",function(){const r=t.CHM(n).$implicit,_=t.oxw(2);return t.KtG(_.action.emit(r.action))}),t._uU(1),t.qZA()}if(2&o){const n=e.$implicit,i=t.oxw(2);t.Tol(i.showColorSchemes&&n.colorScheme||null),t.xp6(1),t.hij(" ",n.label," ")}}function w(o,e){if(1&o&&(t.TgZ(0,"div",2),t.YNc(1,T,2,3,"button",3),t.qZA()),2&o){const n=t.oxw();t.xp6(1),t.Q6J("ngForOf",n.scoreInputConfig)}}const O=[{label:"0",action:0},{label:"10",action:10,colorScheme:c.GOLD},{label:"DEL",action:g.DELETE},{label:"7",action:7,colorScheme:c.RED},{label:"8",action:8,colorScheme:c.RED},{label:"9",action:9,colorScheme:c.GOLD},{label:"4",action:4,colorScheme:c.BLACK},{label:"5",action:5,colorScheme:c.BLUE},{label:"6",action:6,colorScheme:c.BLUE},{label:"1",action:1,colorScheme:c.WHITE},{label:"2",action:2,colorScheme:c.WHITE},{label:"3",action:3,colorScheme:c.BLACK}];class p{constructor(){this.scoreInputConfig=O,this.showColorSchemes=!1,this.action=new t.vpe}}p.\u0275fac=function(e){return new(e||p)},p.\u0275cmp=t.Xpm({type:p,selectors:[["app-score-input-buttons"]],inputs:{scoreInputConfig:"scoreInputConfig",showColorSchemes:"showColorSchemes"},outputs:{action:"action"},standalone:!0,features:[t.jDz],decls:3,vars:1,consts:[["mat-button","",1,"margin-bottom-1x",3,"click"],["class","button-grid",4,"ngIf"],[1,"button-grid"],["mat-stroked-button","",3,"class","click",4,"ngFor","ngForOf"],["mat-stroked-button","",3,"click"]],template:function(e,n){1&e&&(t.TgZ(0,"button",0),t.NdJ("click",function(){return n.showColorSchemes=!n.showColorSchemes}),t._uU(1," Toggle colors\n"),t.qZA(),t.YNc(2,w,2,1,"div",1)),2&e&&(t.xp6(2),t.Q6J("ngIf",n.scoreInputConfig))},dependencies:[l.ax,l.O5,d.ot,d.lW],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;align-items:center}.button-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(3,min-content);gap:var(--spacing-2x)}.button-grid[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:50px;min-width:0}"]});class u{}u.\u0275fac=function(e){return new(e||u)},u.\u0275cmp=t.Xpm({type:u,selectors:[["app-score-input-display-block"]],standalone:!0,features:[t.jDz],ngContentSelectors:["*"],decls:1,vars:0,template:function(e,n){1&e&&(t.F$t(),t.Hsn(0))},styles:["[_nghost-%COMP%]{display:inline-flex;align-items:center;justify-content:center;font-size:1.25em;padding:.25em;width:50px;height:50px}[_nghost-%COMP%]:not(.active){cursor:pointer}.active[_nghost-%COMP%]{box-shadow:0 2px 4px -1px #0003,0 4px 5px #00000024,0 1px 10px #0000001f}"]});var I=s(4298),Z=s(9613);function B(o,e){if(1&o){const n=t.EpF();t.ynx(0),t.TgZ(1,"app-score-input-display-block",4),t.NdJ("click",function(){const r=t.CHM(n).index,_=t.oxw();return t.KtG(_.activeShotIndex=r)}),t._uU(2),t.qZA(),t.BQk()}if(2&o){const n=e.$implicit,i=e.index,a=t.oxw();let r;t.xp6(1),t.ekj("active",i===a.activeShotIndex),t.xp6(1),t.hij(" ",null!==(r=null==n?null:n.value)&&void 0!==r?r:"-"," ")}}class m{set session(e){this.numberOfArrows=e.numberOfArrows}set numberOfArrows(e){this._numberOfArrows=e,this.resetShots()}get numberOfArrows(){return this._numberOfArrows}constructor(e){this.dialog=e,this._numberOfArrows=6,this.activeShotIndex=0,this.shots=[],this.savedEntry=new t.vpe}resetShots(){this.shots=new Array(this.numberOfArrows).fill(null),this.activeShotIndex=0}saveEntryToRepo(e){this.savedEntry.emit((0,I.Yo)({shots:e})),this.resetShots()}buttonInputAction(e){"number"==typeof e?(this.shots[this.activeShotIndex]=(0,I.Ey)({value:e}),this.activeShotIndex=++this.activeShotIndex%this.shots.length):this.shots[this.activeShotIndex]=null}save(){const e=this.shots.filter(n=>!!n).sort((n,i)=>i.value-n.value);e.length?this.saveEntryToRepo(e):this.dialog.open(Z.M,{restoreFocus:!1,autoFocus:!1,width:"500px",data:{title:"Are you sure you want to add an entry with no shots ?"}}).afterClosed().subscribe(i=>{i&&this.saveEntryToRepo(e)})}}m.\u0275fac=function(e){return new(e||m)(t.Y36(C.uw))},m.\u0275cmp=t.Xpm({type:m,selectors:[["app-score-input"]],inputs:{session:"session"},outputs:{savedEntry:"savedEntry"},standalone:!0,features:[t.jDz],decls:5,vars:1,consts:[[1,"blocks-grid","margin-bottom-4x"],[4,"ngFor","ngForOf"],[3,"action"],["mat-stroked-button","",1,"margin-top-4x",3,"click"],[3,"click"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0),t.YNc(1,B,3,3,"ng-container",1),t.qZA(),t.TgZ(2,"app-score-input-buttons",2),t.NdJ("action",function(a){return n.buttonInputAction(a)}),t.qZA(),t.TgZ(3,"button",3),t.NdJ("click",function(){return n.save()}),t._uU(4,"Save"),t.qZA()),2&e&&(t.xp6(1),t.Q6J("ngForOf",n.shots))},dependencies:[l.ax,u,p,d.ot,d.lW,C.Is],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;align-items:center}.blocks-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(3,min-content);gap:var(--spacing-2x)}"]});var k=s(8778),P=s(2823),D=s(6235);function F(o,e){if(1&o&&t._UZ(0,"app-entries-table",8),2&o){const n=t.oxw(4);t.Q6J("entries",n.entries)}}function J(o,e){if(1&o&&t._UZ(0,"app-entries-circles-list",8),2&o){const n=t.oxw(4);t.Q6J("entries",n.entries)}}function L(o,e){if(1&o&&(t.ynx(0),t.YNc(1,F,1,1,"app-entries-table",7),t.YNc(2,J,1,1,"app-entries-circles-list",7),t.BQk()),2&o){const n=e.ngIf;t.xp6(1),t.Q6J("ngIf","table"===n),t.xp6(1),t.Q6J("ngIf","circles"===n)}}function M(o,e){if(1&o&&(t.ynx(0),t.YNc(1,L,3,2,"ng-container",0),t.ALo(2,"async"),t.BQk()),2&o){const n=t.oxw(2);t.xp6(1),t.Q6J("ngIf",t.lcZ(2,1,n.settingsRepo.entryListStyle$))}}function Q(o,e){if(1&o){const n=t.EpF();t.ynx(0),t.TgZ(1,"div",1)(2,"div",2)(3,"h2",3),t._uU(4),t.qZA(),t.TgZ(5,"h5",4),t.ALo(6,"date"),t._uU(7),t.ALo(8,"dateDistance"),t.qZA()()(),t._UZ(9,"mat-divider",5),t.TgZ(10,"app-score-input",6),t.NdJ("savedEntry",function(a){t.CHM(n);const r=t.oxw();return t.KtG(r.archerySessionRepo.addEntryForActiveSession(a))}),t.qZA(),t.YNc(11,M,3,3,"ng-container",0),t.BQk()}if(2&o){const n=e.ngIf,i=t.oxw();t.xp6(4),t.Oqu(n.name),t.xp6(1),t.Q6J("title",t.lcZ(6,5,n.date_created)),t.xp6(2),t.hij(" Created: ",t.lcZ(8,7,n.date_created)," "),t.xp6(3),t.Q6J("session",n),t.xp6(1),t.Q6J("ngIf",i.entries.length)}}class h{constructor(e,n,i,a,r){this.router=e,this.route=n,this.archerySessionRepo=i,this.snackbar=a,this.settingsRepo=r,this.destroy$=new A.x,this.entries=[]}ngOnInit(){this.route.params.pipe((0,S.R)(this.destroy$)).subscribe(e=>{const n=e.id;n?(this.archerySessionRepo.setActiveSession(n),this.archerySessionRepo.getActiveSession()||(this.snackbar.open("The session with that ID was not found","OK"),this.router.navigateByUrl("/list"))):this.router.navigateByUrl("/list")}),this.archerySessionRepo.activeSession$.pipe((0,S.R)(this.destroy$)).subscribe(e=>{this.entries=e?.entries?[...e.entries]:[]})}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}}h.\u0275fac=function(e){return new(e||h)(t.Y36(f.F0),t.Y36(f.gz),t.Y36(P.H),t.Y36(y.ux),t.Y36(D.i))},h.\u0275cmp=t.Xpm({type:h,selectors:[["app-active-session-page"]],standalone:!0,features:[t.jDz],decls:2,vars:3,consts:[[4,"ngIf"],[1,"title-row"],[1,"flex-column"],[1,"margin-bottom-1x"],[3,"title"],[1,"margin-top-2x","margin-bottom-2x"],[1,"margin-bottom-8x",3,"session","savedEntry"],["class","margin-bottom-8x",3,"entries",4,"ngIf"],[1,"margin-bottom-8x",3,"entries"]],template:function(e,n){1&e&&(t.YNc(0,Q,12,9,"ng-container",0),t.ALo(1,"async")),2&e&&t.Q6J("ngIf",t.lcZ(1,1,n.archerySessionRepo.activeSession$))},dependencies:[l.O5,l.Ov,f.Bz,l.uU,k.n,m,b.j,b.S,y.ZX,v.t,v.d],styles:["[_nghost-%COMP%]{display:block;padding:var(--spacing-3x) var(--spacing-1x)}@media (min-width: 768px){[_nghost-%COMP%]{padding:var(--spacing-3x)}}.title-row[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;align-items:center;justify-content:space-between;gap:var(--spacing-2x)}"]})}}]);