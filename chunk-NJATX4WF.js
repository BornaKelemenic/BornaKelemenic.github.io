import{b as gt,e as _t,f as vt,g as ht,h as wt}from"./chunk-FLRELUOW.js";import{c as Ct}from"./chunk-R6X5GI5D.js";import{d as dt}from"./chunk-SRBIYDI5.js";import"./chunk-NGGUKZKR.js";import{c as st,i as ft}from"./chunk-NDFNEPG7.js";import"./chunk-FNJ3HGKX.js";import{b as tt,c as et,d as ot,f as nt,g as rt,h as it}from"./chunk-OWY6WM33.js";import{a as ct}from"./chunk-YB7CCIRZ.js";import{c as D,e as C,k,m as mt,q as A,s as pt,v as ut}from"./chunk-AG3FRLJI.js";import{j as Y,k as q,n as z}from"./chunk-3AIAIFAZ.js";import{Ia as S,Ja as b,Ka as u,La as l,Ma as s,Na as v,O as B,Oa as $,Oc as T,Pa as G,Ra as M,Rc as J,S as f,Sb as K,Sc as X,Ta as h,Tc as Z,Ua as d,Ub as Q,V as g,W as _,Yc as at,Zc as lt,gb as c,hb as j,ia as a,ib as m,j as x,kb as R,lb as U,lc as I,mb as W,qa as F,rb as w,sb as H,tb as E,w as L,wa as N,z as V}from"./chunk-6ZKZZP75.js";import{a as O,b as P,f as p}from"./chunk-EQDQRRRY.js";var yt=(()=>{let t=class t{constructor(){this.entries$=x(D(()=>C.arrowCountEntries.orderBy("date").reverse().toArray())),this.entriesGroupedByDate$=x(D(()=>p(this,null,function*(){return(yield C.arrowCountEntries.orderBy("date").reverse().toArray()).reduce((e,i)=>{let y=new Date(i.date).toISOString().split("T")[0];return e[y]||(e[y]=[]),e[y].push({id:i.id,value:i.value}),e},{})})))}addEntry(o){return p(this,null,function*(){return yield C.arrowCountEntries.add(P(O({},o),{date:new Date().toISOString()}))})}deleteEntry(o){return p(this,null,function*(){return yield C.arrowCountEntries.delete(o)})}};t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=B({token:t,factory:t.\u0275fac,providedIn:"root"});let n=t;return n})();var Mt=(n,t)=>t.key,Et=(n,t)=>t.id;function It(n,t){if(n&1){let r=M();l(0,"mat-list-item"),c(1),l(2,"button",12),h("click",function(){let e=g(r).$implicit,i=d(3);return _(i.openConfirmDeleteDialog(e.id))}),l(3,"mat-icon"),c(4,"delete"),s()()()}if(n&2){let r=t.$implicit;a(),m(" ",r.value," ")}}function Tt(n,t){if(n&1&&(l(0,"div",11),c(1),w(2,"date"),s(),S(3,It,5,1,"mat-list-item",null,Et)),n&2){let r=t.$implicit;a(),m(" ",E(2,1,r.key,"longDate")," "),a(2),b(r.value)}}function Dt(n,t){if(n&1){let r=M();$(0),l(1,"app-page-with-title",1)(2,"div",2)(3,"mat-list"),S(4,Tt,5,4,null,null,Mt),s(),l(6,"mat-card")(7,"mat-card-header")(8,"mat-card-title"),c(9),s()(),l(10,"mat-card-content")(11,"div",3)(12,"div",4)(13,"span"),c(14),s(),v(15,"app-small-counter",5),s(),l(16,"div",6)(17,"span"),c(18),s(),v(19,"app-small-counter",7),s()()(),l(20,"mat-card-actions")(21,"button",8),h("click",function(){g(r);let e=d();return _(e.countControl.reset())}),c(22),s(),v(23,"span",9),l(24,"button",10),h("click",function(){g(r);let e=d();return _(e.saveCount())}),c(25),s()()()()(),G()}if(n&2){let r=t.$implicit,o=d(),e=W(0);a(),u("page-title",r("navbar.arrowCounter")),a(3),b(e),a(5),j(r("navbar.arrowCounter")),a(5),m("",r("form.labels.shooting"),":"),a(),u("formControl",o.shootingCountControl)("min",1),a(3),m("",r("form.labels.count"),":"),a(),u("moreIncrementAmount",o.shootingCountControl.value)("formControl",o.countControl)("min",0),a(3),m(" ",r("form.buttons.resetCount")," "),a(2),u("disabled",o.countControl.invalid),a(),m(" ",r("form.buttons.saveCount")," ")}}var xt="archery-stats-arrow-count-value",St="archery-stats-arrow-count-shooting",ae=(()=>{let t=class t{constructor(){this.dialog=f(st),this.transloco=f(J),this.arrowCountEntriesService=f(yt),this.shootingCountControl=new A(6,{nonNullable:!0,validators:[k.min(1)]}),this.countControl=new A(0,{nonNullable:!0,validators:[k.min(0)]}),this.originalOrder=()=>0;let o=localStorage.getItem(xt),e=localStorage.getItem(St);o&&this.countControl.setValue(I(o,0),{emitEvent:!1}),e&&this.shootingCountControl.setValue(I(e,6),{emitEvent:!1}),this.countControl.valueChanges.pipe(T()).subscribe({next:i=>localStorage.setItem(xt,i.toString())}),this.shootingCountControl.valueChanges.pipe(T()).subscribe({next:i=>localStorage.setItem(St,i.toString())})}saveCount(){return p(this,null,function*(){yield this.arrowCountEntriesService.addEntry({value:this.countControl.value}),this.countControl.reset()})}openConfirmDeleteDialog(o){this.dialog.open(ft,{width:"500px",data:{title:this.transloco.translate("arrowCounter.dialogs.deleteEntryDialog.title")}}).afterClosed().pipe(L(i=>!!i),V(1)).subscribe(()=>{this.arrowCountEntriesService.deleteEntry(o)})}};t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=F({type:t,selectors:[["app-arrow-counter-page"]],decls:4,vars:6,consts:[[4,"transloco"],["page-back-link","/",3,"page-title"],[2,"display","grid","grid-template-rows","1fr auto","height","100%"],[1,"padding-y-4x"],[1,"flex-row","align-items-center","justify-content-space-between"],["disableControlsWhenOverLimit","",3,"formControl","min"],[1,"flex-row","align-items-center","justify-content-space-between","margin-top-2x"],["moreIncrements","","disableControlsWhenOverLimit","",3,"moreIncrementAmount","formControl","min"],["mat-button","","color","warn",3,"click"],[1,"spacer"],["mat-flat-button","",3,"click","disabled"],["matSubheader",""],["matListItemMeta","","mat-icon-button","",3,"click"]],template:function(e,i){e&1&&(R(0),w(1,"async"),w(2,"keyvalue"),N(3,Dt,26,12,"ng-container",0)),e&2&&U(E(2,2,H(1,0,i.arrowCountEntriesService.entriesGroupedByDate$),i.originalOrder))},dependencies:[K,Q,Z,X,ut,mt,pt,Ct,ct,dt,wt,_t,vt,ht,gt,it,tt,nt,ot,rt,et,z,q,Y,lt,at],styles:["[_nghost-%COMP%]{display:block;height:100%}mat-card[_ngcontent-%COMP%], mat-list[_ngcontent-%COMP%]{width:100%;margin:0 auto;max-width:600px}mat-list[_ngcontent-%COMP%]{overflow:auto}"],changeDetection:0});let n=t;return n})();export{ae as ArrowCounterPageComponent};
