import{B as N,E as h,F as z,H as B,O as M,b as I,c as j,e as O,f as w,g as R,j as v,k as f,m as x,w as A,z as E}from"./chunk-6ZKZZP75.js";import{a as u,b as V}from"./chunk-EQDQRRRY.js";function D(...t){let e={config:{},state:{}};for(let{config:r,props:n}of t)Object.assign(e.config,r),Object.assign(e.state,n);return e}var K=0,l=new w(!1),q=l.asObservable().pipe(A(t=>!t),E(1));function ut(t){if(!l.getValue()){l.next(!0);let e=t();return K===0&&l.next(!1),e}return t()}var c={},$=class{registerPreStoreUpdate(e){c.preStoreUpdate=e}registerPreStateInit(e){c.preStateInit=e}},at=new $,p=new Map,C=new O,ct=C.asObservable();function J(t){p.set(t.name,t),C.next({type:"add",store:t})}function Q(t){p.delete(t.name),C.next({type:"remove",store:t})}function ft(t){return p.get(t)}function lt(){return p}function pt(){let t={};return p.forEach((e,r)=>{t[r]=e.getValue()}),t}var d=[];function W(t){d.push(t)}function T(t){d.length&&d.forEach(e=>t.next(e)),d=[]}var P=class extends w{constructor(e){super(e.state),this.storeDef=e,this.initialState=void 0,this.state=void 0,this.batchInProgress=!1,this.events=new O,this.context={config:this.getConfig(),setEvent:r=>{W(r)}},this.events$=this.events.asObservable(),this.state=this.getInitialState(e.state),this.initialState=this.getValue(),J(this)}get name(){return this.storeDef.name}getInitialState(e){return c.preStateInit?c.preStateInit(e,this.name):e}getConfig(){return this.storeDef.config}query(e){return e(this.getValue())}update(...e){let r=this.getValue(),n=e.reduce((s,i)=>(s=i(s,this.context),s),r);c.preStoreUpdate&&(n=c.preStoreUpdate(r,n,this.name)),n!==r&&(this.state=n,l.getValue()?this.batchInProgress||(this.batchInProgress=!0,q.subscribe(()=>{super.next(this.state),T(this.events),this.batchInProgress=!1})):(super.next(this.state),T(this.events)))}getValue(){return this.state}reset(){this.update(()=>this.initialState)}combine(e){let r=!0,n={};return new j(s=>{for(let[i,m]of Object.entries(e))s.add(m.subscribe(b=>{n[i]=b,r=!0}));return this.subscribe({next(){r&&(s.next(u({},n)),r=!1)},error(i){s.error(i)},complete(){s.complete()}})})}destroy(){Q(this),this.reset()}next(e){this.update(()=>e)}error(){}complete(){}};function U(t,...e){let{state:r,config:n}=D(...e),{name:s}=t;return new P({name:s,state:r,config:n})}function X(t){return typeof t=="function"}function gt(t){return t.charAt(0).toUpperCase()+t.slice(1)}function g(t,e){return function(r){return V(u({},r),{[t]:X(e)?e(r[t]):e})}}function S(t){return I(x(t),N())}function ht(){return A(t=>t!=null)}function H(t){return{props:t,config:void 0}}function L(t,e){let r={source:o=>o,preStoreInit:o=>o,key:e.key??`${t.name}@store`,runGuard(){return typeof window<"u"}},n=u(u({},r),e);if(!n.runGuard?.())return{initialized$:f(!1),unsubscribe(){}};let{storage:s}=e,i=new R(1),m=v(s.getItem(n.key)).subscribe(o=>{o&&t.update(y=>n.preStoreInit(u(u({},y),o))),i.next(!0),i.complete()}),b=n.source(t).pipe(z(1),B(o=>{let y=n.preStorageUpdate?n.preStorageUpdate(t.name,o):o;return s.setItem(n.key,y)})).subscribe();return{initialized$:i.asObservable(),unsubscribe(){b.unsubscribe(),m.unsubscribe()}}}function F(t){if(t)return{getItem(e){let r=t.getItem(e);return f(r&&JSON.parse(r))},setItem(e,r){return t.setItem(e,JSON.stringify(r)),f(!0)},removeItem(e){return t.removeItem(e),f(!0)}}}var Y=()=>{try{if(typeof localStorage<"u")return localStorage}catch{}},G=F(Y()),Z=()=>{try{if(typeof sessionStorage<"u")return sessionStorage}catch{}},yt=F(Z());var a=function(t){return t.CROATIAN="hr-HR",t.BRITISH_ENGLISH="en-GB",t}(a||{}),wt=new Map([[a.BRITISH_ENGLISH,"English"],[a.CROATIAN,"Hrvatski"]]),xt=new Map([[a.BRITISH_ENGLISH,"flags-gb"],[a.CROATIAN,"flags-hr"]]);var k={language:a.CROATIAN,hasManuallyChosenLanguage:!1,playSounds:!0,showColoredButtons:!0},_="archery-stats-settings",Rt=(()=>{let e=class e{constructor(){this.store=U({name:_},H(k)),L(this.store,{key:_,storage:G}),this.lang$=this.store.pipe(S(n=>n.language),h({refCount:!0,bufferSize:1})),this.playSounds$=this.store.pipe(S(n=>n.playSounds),h({refCount:!0,bufferSize:1})),this.showColoredButtons$=this.store.pipe(S(n=>n.showColoredButtons),h({refCount:!0,bufferSize:1}))}setLanguage(n){this.store.update(g("language",n))}setHasManuallyChosenLanguage(n){this.store.update(g("hasManuallyChosenLanguage",n))}setPlaySounds(n){this.store.update(g("playSounds",n))}setShowColoredButtons(n){this.store.update(g("showColoredButtons",n))}getStoreProp(n){return this.store.getValue()[n]}};e.\u0275fac=function(s){return new(s||e)},e.\u0275prov=M({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();export{ut as a,ct as b,ft as c,lt as d,pt as e,U as f,gt as g,g as h,S as i,ht as j,H as k,L as l,G as m,a as n,wt as o,xt as p,Rt as q};
