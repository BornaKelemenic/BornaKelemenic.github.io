import{b as $e,c as we,d as Xe,e as Ye,g as nt}from"./chunk-FCS25SSW.js";import"./chunk-ZPGVP7BG.js";import{a as ze,c as je,d as Ae,e as Ke,f as We,g as qe,h as Ge,i as Qe,j as Ue,k as He,l as Je,m as Z,o as ee,p as te}from"./chunk-KFKVXLL7.js";import{c as Te,d as be,e as De,f as Ee,g as Ie,h as H,i as Ze,j as et,k as tt,l as it}from"./chunk-RCNC62OS.js";import{a as he,f as Se,h as W,i as q,k as _e,l as ve,m as Me}from"./chunk-NQHDRJOQ.js";import{a as Re,h as J,i as Le,j as X,k as Pe,o as ke,q as Ne,u as Y,w as Oe,z as Ve}from"./chunk-F2QLQMHO.js";import{Q as Be,a as k,b as Ce,e as N}from"./chunk-LFKKBSHB.js";import{Ab as ge,Bb as h,Cb as _,Db as fe,K as T,Ka as g,Ma as p,N as z,Oa as de,Ra as D,Sa as j,T as ce,Ua as I,Va as $,Wa as s,X as u,Xa as r,Y as x,Ya as f,Yc as xe,Za as C,_a as y,_b as P,a as ae,ab as L,da as R,db as w,dc as U,ea as B,fb as c,fd as ye,ja as me,kd as G,ld as Fe,na as pe,od as M,p as se,pb as ue,pd as F,qb as l,rb as S,sb as m,t as le,ta as o,tb as re,u as oe,ub as b,ud as O,vb as A,vd as V,wb as K,yb as v}from"./chunk-32JRF7TD.js";var pt={sortBy:J.NEWEST_FIRST,targetFace:null,shootingType:null,distance:null},ot="archery-stats-session-filters",E=(()=>{let i=class i{constructor(){this.store=Se({name:ot},_e(pt)),ve(this.store,{key:ot,storage:Me}),this.sortBy$=this.store.pipe(q(e=>e.sortBy),T({refCount:!0,bufferSize:1})),this.targetFace$=this.store.pipe(q(e=>e.targetFace),T({refCount:!0,bufferSize:1})),this.shootingType$=this.store.pipe(q(e=>e.shootingType),T({refCount:!0,bufferSize:1})),this.distance$=this.store.pipe(q(e=>e.distance),T({refCount:!0,bufferSize:1})),this.filters$=oe({sortBy:this.sortBy$,targetFace:this.targetFace$,shootingType:this.shootingType$,distance:this.distance$}).pipe(T({refCount:!0,bufferSize:1})),this.activeFiltersCount$=oe({targetFace:this.targetFace$,shootingType:this.shootingType$,distance:this.distance$}).pipe(le(e=>{let n=0;return Object.values(e).forEach(d=>{Be(d)&&n++}),n}),T({refCount:!0,bufferSize:1}))}setSortBy(e){this.store.update(W("sortBy",e))}setTargetFace(e){this.store.update(W("targetFace",e))}setShootingType(e){this.store.update(W("shootingType",e))}setDistance(e){this.store.update(W("distance",e))}getStoreProp(e){return this.store.getValue()[e]}resetAll(){this.store.reset()}resetOnlyFilters(){he(()=>{let e=this.getStoreProp("sortBy");this.resetAll(),this.setSortBy(e)})}};i.\u0275fac=function(n){return new(n||i)},i.\u0275prov=ce({token:i,factory:i.\u0275fac,providedIn:"root"});let t=i;return t})();function dt(t,i){if(t&1&&(s(0,"mat-radio-button",3),l(1),r()),t&2){let a=i.$implicit,e=c().$implicit;p("value",a[0]),o(),m(" ",e(a[1])," ")}}function ut(t,i){if(t&1&&(f(0,"img",8),s(1,"span",9),l(2),r()),t&2){let a=c().$implicit,e=c();p("ngSrc",e.TargetFaceImgMap.get(e.targetFaceControl.value)),o(2),m(" ",a(e.TargetFaceNameMap.get(e.targetFaceControl.value))," ")}}function gt(t,i){if(t&1&&l(0),t&2){let a=c().$implicit;m(" ",a("generic.all")," ")}}function ft(t,i){if(t&1&&(b(0)(1),s(2,"mat-option",3),f(3,"img",8),s(4,"span",9),l(5),r()()),t&2){let a=i.$implicit,e=c().$implicit,n=c(),d=a[0],ne=a[1];o(2),p("value",d),o(),p("ngSrc",n.TargetFaceImgMap.get(d)),o(2),m(" ",e(ne)," ")}}function ht(t,i){if(t&1&&(C(0),s(1,"div",1)(2,"label"),l(3),r(),s(4,"mat-radio-group",2)(5,"mat-radio-button",3),l(6),r(),I(7,dt,2,2,"mat-radio-button",3,j),r()(),s(9,"mat-form-field",4)(10,"mat-label"),l(11),r(),s(12,"mat-select",2)(13,"mat-select-trigger"),g(14,ut,3,2)(15,gt,1,1),r(),s(16,"mat-option",5),l(17),r(),I(18,ft,6,3,"mat-option",3,j),r()(),s(20,"div",6)(21,"label"),l(22),r(),f(23,"app-small-counter",7),r(),y()),t&2){let a=i.$implicit,e=c();o(3),m(" ",a("form.labels.shootingType"),": "),o(),p("formControl",e.shootingTypeControl),o(),p("value",null),o(),S(a("generic.all")),o(),$(e.ShootingTypeNameMap.entries()),o(4),S(a("form.labels.targetFace")),o(),p("formControl",e.targetFaceControl),o(2),D(e.targetFaceControl.value!=="all"?14:15),o(3),S(a("generic.all")),o(),$(e.TargetFaceNameMap.entries()),o(4),S(a("form.labels.distance")),o(),p("formControl",e.distanceControl)}}var rt=(()=>{let i=class i{constructor(){this.destroyRef=u(me),this.sessionFiltersRepo=u(E),this.TargetFaceNameMap=ee,this.TargetFaceImgMap=te,this.ShootingType=Je,this.ShootingTypeNameMap=Z,this.targetFaceControl=new Y(this.sessionFiltersRepo.getStoreProp("targetFace")??"all",{nonNullable:!0}),this.shootingTypeControl=new Y(this.sessionFiltersRepo.getStoreProp("shootingType")),this.distanceControl=new Y(this.sessionFiltersRepo.getStoreProp("distance"),{nonNullable:!0,validators:[ke.min(0)]}),this.listenToRepoValueChanges(),this.setupControlValueChangeListeners()}listenToRepoValueChanges(){this.sessionFiltersRepo.filters$.pipe(G(this.destroyRef)).subscribe(({targetFace:e,shootingType:n,distance:d})=>{this.targetFaceControl.setValue(e??"all",{emitEvent:!1}),this.shootingTypeControl.setValue(n,{emitEvent:!1}),this.distanceControl.setValue(d,{emitEvent:!1})})}setupControlValueChangeListeners(){this.targetFaceControl.valueChanges.pipe(G(this.destroyRef)).subscribe(e=>this.sessionFiltersRepo.setTargetFace(e==="all"?null:e)),this.shootingTypeControl.valueChanges.pipe(G(this.destroyRef)).subscribe(e=>this.sessionFiltersRepo.setShootingType(e)),this.distanceControl.valueChanges.pipe(G(this.destroyRef)).subscribe(e=>this.sessionFiltersRepo.setDistance(e===0?null:e))}};i.\u0275fac=function(n){return new(n||i)},i.\u0275cmp=x({type:i,selectors:[["app-session-filters"]],standalone:!0,features:[v],decls:1,vars:0,consts:[[4,"transloco"],[1,"flex-column","margin-bottom-4x"],[3,"formControl"],[3,"value"],[1,"margin-bottom-4x"],["value","all"],[1,"flex-column","align-items-start"],["suffix","m","moreIncrements","",3,"formControl"],["width","30","height","30",2,"vertical-align","middle",3,"ngSrc"],[1,"margin-left-2x"]],template:function(n,d){n&1&&g(0,ht,24,10,"ng-container",0)},dependencies:[Ve,Ne,Oe,U,F,M,He,qe,Ke,We,Ue,je,ze,Ge,Qe,xe,Ae],styles:["[_nghost-%COMP%]{display:block}mat-form-field[_ngcontent-%COMP%]{width:100%}"],changeDetection:0});let t=i;return t})();function St(t,i){if(t&1){let a=L();C(0),s(1,"h2",1),l(2),r(),s(3,"mat-dialog-content"),f(4,"app-session-filters"),r(),s(5,"mat-dialog-actions")(6,"button",2),l(7),r(),f(8,"span",3),s(9,"button",4),w("click",function(){R(a);let n=c();return B(n.sessionFiltersRepo.resetOnlyFilters())}),l(10),r()(),y()}if(t&2){let a=i.$implicit;o(2),m(" ",a("session.dialogs.filtersDialog.title")," "),o(5),m(" ",a("generic.close")," "),o(3),m(" ",a("generic.resetFilters")," ")}}var st=(()=>{let i=class i{constructor(){this.sessionFiltersRepo=u(E)}};i.\u0275fac=function(n){return new(n||i)},i.\u0275cmp=x({type:i,selectors:[["app-session-filters-dialog"]],standalone:!0,features:[v],decls:1,vars:0,consts:[[4,"transloco"],["mat-dialog-title",""],["mat-button","","type","button","mat-dialog-close",""],[1,"spacer"],["mat-button","","color","warn",3,"click"]],template:function(n,d){n&1&&g(0,St,11,3,"ng-container",0)},dependencies:[F,M,rt,H,be,De,Ie,Ee,N,k],styles:["[_nghost-%COMP%]{display:block}"],changeDetection:0});let t=i;return t})();function _t(t,i){t&1&&(s(0,"mat-icon"),l(1,"lock"),r())}function xt(t,i){if(t&1&&(C(0),b(1),f(2,"img",1),s(3,"div",2)(4,"span",3),l(5),g(6,_t,2,0,"mat-icon"),r(),s(7,"small"),l(8),h(9,"date"),h(10,"dateDistance"),r(),s(11,"div",4)(12,"small"),l(13),r(),s(14,"small"),l(15,"\u2022"),r(),s(16,"small"),l(17),r(),s(18,"small"),l(19,"\u2022"),r(),s(20,"small"),l(21),h(22,"async"),r(),s(23,"small"),l(24,"\u2022"),r(),s(25,"small"),l(26),r(),s(27,"small"),l(28),h(29,"async"),r(),s(30,"small"),l(31,"\u2022"),r(),s(32,"small"),l(33),r(),s(34,"small"),l(35),h(36,"async"),r()()(),f(37,"app-session-options-menu",5),y()),t&2){let a=i.$implicit,e=c(),n=e.$session();o(2),p("ngSrc",e.TargetFaceImgMap.get(n.targetFace)),o(3),m(" ",n.name," "),o(),D(n.locked?6:-1),o(2),re(" ",fe(9,14,n.date,"short")," (",_(10,17,n.date),") "),o(5),S(a(e.ShootingTypeNameMap.get(n.shootingType))),o(4),m("",n.distance,"m"),o(4),re("",a("session.info.rounds"),": ",_(22,19,e.roundCount$),""),o(5),m("",a("session.info.avg"),":"),o(2),S(_(29,21,e.avgScore$)),o(5),m("",a("session.info.total"),":"),o(2),S(_(36,23,e.shotsTotal$)),o(2),p("session",n)}}var ct=(()=>{let i=class i{constructor(){this.sessionsDbService=u(X),this.TargetFaceNameMap=ee,this.TargetFaceImgMap=te,this.ShootingTypeNameMap=Z,this.roundCount$=se(Re(()=>this.sessionsDbService.getRoundsCountBySessionId(this.$session().id))),this.$session=pe.required({alias:"session"}),this.session$=Fe(this.$session).pipe(T({refCount:!0,bufferSize:1})),this.shotsTotal$=this.session$.pipe(z(e=>this.sessionsDbService.getTotalScoreBySessionID$(e.id))),this.avgScore$=this.session$.pipe(z(e=>this.sessionsDbService.getAverageScoreBySessionID$(e.id)))}};i.\u0275fac=function(n){return new(n||i)},i.\u0275cmp=x({type:i,selectors:[["app-session-list-item"]],inputs:{$session:[1,"session","$session"]},standalone:!0,features:[v],decls:1,vars:0,consts:[[4,"transloco"],["alt","Target face","width","50","height","50",2,"border-radius","5px",3,"ngSrc"],[1,"flex-column","align-items-start"],[1,"session-name"],[1,"session-info"],[3,"session"]],template:function(n,d){n&1&&g(0,xt,38,25,"ng-container",0)},dependencies:[P,F,M,U,Ye,Xe,nt,V,O],styles:["[_nghost-%COMP%]{display:grid;grid-template-columns:50px minmax(0,1fr) 40px;align-items:center;justify-content:flex-start;gap:var(--spacing-3x);padding:var(--spacing-2x);background-color:var(--mdc-outlined-card-container-color);border-style:solid;border-radius:var(--mdc-outlined-card-container-shape);border-width:var(--mdc-outlined-card-outline-width);border-color:var(--mdc-outlined-card-outline-color);box-shadow:var(--mdc-outlined-card-container-elevation)}.session-name[_ngcontent-%COMP%]{display:flex;align-items:center;column-gap:var(--spacing-1x);font-size:1.25em}.session-info[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;align-items:center;column-gap:var(--spacing-1x)}"],changeDetection:0});let t=i;return t})();function Ct(t,i){t&1&&(s(0,"mat-icon",5),l(1,"radio_button_checked"),r())}function yt(t,i){t&1&&(s(0,"mat-icon"),l(1,"radio_button_unchecked"),r())}function vt(t,i){if(t&1){let a=L();b(0)(1),s(2,"button",4),w("click",function(){R(a);let n=K(0),d=c(2);return B(d.sessionFiltersRepo.setSortBy(n))}),g(3,Ct,2,0,"mat-icon",5)(4,yt,2,0,"mat-icon"),s(5,"span"),l(6),r()()}if(t&2){let a=i.$implicit,e=c().$implicit,n=K(1),d=A(a[0]),ne=a[1];o(3),D(n===d?3:4),o(3),S(e(ne))}}function Mt(t,i){if(t&1&&(C(0),b(1),h(2,"async"),s(3,"button",2)(4,"mat-icon"),l(5,"sort"),r(),l(6),r(),s(7,"mat-menu",null,0),I(9,vt,7,3,"button",3,j),r(),y()),t&2){let a=i.$implicit,e=ue(8),n=c();o();let d=A(_(2,2,n.sessionFiltersRepo.sortBy$));o(2),p("matMenuTriggerFor",e),o(3),m(" ",a(n.SessionSortLabelMap.get(d))," "),o(3),$(n.SessionSortLabelMap.entries())}}var mt=(()=>{let i=class i{constructor(){this.sessionFiltersRepo=u(E),this.SessionSort=J,this.SessionSortLabelMap=Le}};i.\u0275fac=function(n){return new(n||i)},i.\u0275cmp=x({type:i,selectors:[["app-session-sort-menu"]],standalone:!0,features:[v],decls:1,vars:0,consts:[["menu","matMenu"],[4,"transloco"],["mat-button","","type","button",3,"matMenuTriggerFor"],["mat-menu-item",""],["mat-menu-item","",3,"click"],["color","primary"]],template:function(n,d){n&1&&g(0,Mt,11,5,"ng-container",1)},dependencies:[P,F,M,it,et,Ze,tt,N,k,V,O],styles:["[_nghost-%COMP%]{display:inline-block}"],changeDetection:0});let t=i;return t})();var Ft=(t,i)=>i.id,Tt=t=>["/sessions",t];function bt(t,i){if(t&1&&l(0),t&2){c();let a=K(1);m(" (",a,") ")}}function Dt(t,i){if(t&1&&(s(0,"a",5),f(1,"app-session-list-item",8),h(2,"async"),r()),t&2){let a=i.$implicit,e=c(2);p("routerLink",ge(6,Tt,a.id)),o(),de("active",_(2,4,e.appStateRepo.lastVisitedSession$)===a.id),p("session",a)}}function Et(t,i){if(t&1&&(s(0,"h5",6),l(1),r()),t&2){let a=c().$implicit;o(),m(" ",a("sessionsList.noSessions")," ")}}function It(t,i){if(t&1){let a=L();C(0),b(1),h(2,"async"),s(3,"app-page-with-title",1)(4,"button",2),w("click",function(){R(a);let n=c();return B(n.openFiltersDialog())}),s(5,"mat-icon"),l(6,"filter_alt"),r(),l(7),g(8,bt,1,1),r(),s(9,"div",3)(10,"div",4),f(11,"app-session-sort-menu"),r(),I(12,Dt,3,8,"a",5,Ft,!1,Et,2,1,"h5",6),h(15,"async"),r(),s(16,"button",7)(17,"mat-icon"),l(18,"add"),r()()(),y()}if(t&2){let a=i.$implicit,e=c();o();let n=A(_(2,4,e.sessionFiltersRepo.activeFiltersCount$));o(2),p("page-title",a("sessionsList.title")),o(4),m(" ",a("generic.filters")," "),o(),D(n?8:-1),o(4),$(_(15,7,e.sessions$))}}var rn=(()=>{let i=class i{constructor(){this.dialog=u(Te),this.sessionsDbService=u(X),this.appStateRepo=u(we),this.sessionFiltersRepo=u(E),this.sessions$=this.sessionFiltersRepo.filters$.pipe(z(e=>this.sessionsDbService.getFilteredSessions(ae({},e))))}openFiltersDialog(){this.dialog.open(st,{width:"500px"})}};i.\u0275fac=function(n){return new(n||i)},i.\u0275cmp=x({type:i,selectors:[["app-session-list-page"]],standalone:!0,features:[v],decls:1,vars:0,consts:[[4,"transloco"],[3,"page-title"],["mat-button","","page-action","",3,"click"],[1,"standard-centering"],[1,"margin-bottom-2x"],[3,"routerLink"],[1,"text-center","margin-top-6x"],["mat-fab","","routerLink","/create",1,"fab-bottom-right"],[3,"session"]],template:function(n,d){n&1&&g(0,It,19,9,"ng-container",0)},dependencies:[P,ye,F,M,ct,Pe,mt,N,k,Ce,V,O,$e,H],styles:["[_nghost-%COMP%]{display:block;padding-bottom:var(--spacing-fab-clearance)}a[_ngcontent-%COMP%]{display:block}a[_ngcontent-%COMP%]:not(:last-of-type){margin-bottom:var(--spacing-4x)}app-session-list-item.active[_ngcontent-%COMP%]{color:var(--sys-on-primary-container);background-color:var(--sys-primary-container)}"],changeDetection:0});let t=i;return t})();export{rn as SessionListPageComponent};
