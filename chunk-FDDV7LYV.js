import{D as x,F as C,H as N,K as w,L as z,N as M,T,a as u,b as j,h as b,i as R,k as y,l as I,m as v,p as E,q as f,t as O}from"./chunk-BCNRL4NK.js";function D(...t){let e={config:{},state:{}};for(let{config:r,props:n}of t)Object.assign(e.config,r),Object.assign(e.state,n);return e}var K=0,l=new I(!1),q=l.asObservable().pipe(x(t=>!t),C(1));function ut(t){if(!l.getValue()){l.next(!0);let e=t();return K===0&&l.next(!1),e}return t()}var c={},A=class{registerPreStoreUpdate(e){c.preStoreUpdate=e}registerPreStateInit(e){c.preStateInit=e}},at=new A,g=new Map,$=new y,ct=$.asObservable();function J(t){g.set(t.name,t),$.next({type:"add",store:t})}function Q(t){g.delete(t.name),$.next({type:"remove",store:t})}function ft(t){return g.get(t)}function lt(){return g}function gt(){let t={};return g.forEach((e,r)=>{t[r]=e.getValue()}),t}var p=[];function W(t){p.push(t)}function U(t){p.length&&p.forEach(e=>t.next(e)),p=[]}var P=class extends I{constructor(e){super(e.state),this.storeDef=e,this.initialState=void 0,this.state=void 0,this.batchInProgress=!1,this.events=new y,this.context={config:this.getConfig(),setEvent:r=>{W(r)}},this.events$=this.events.asObservable(),this.state=this.getInitialState(e.state),this.initialState=this.getValue(),J(this)}get name(){return this.storeDef.name}getInitialState(e){return c.preStateInit?c.preStateInit(e,this.name):e}getConfig(){return this.storeDef.config}query(e){return e(this.getValue())}update(...e){let r=this.getValue(),n=e.reduce((s,i)=>(s=i(s,this.context),s),r);c.preStoreUpdate&&(n=c.preStoreUpdate(r,n,this.name)),n!==r&&(this.state=n,l.getValue()?this.batchInProgress||(this.batchInProgress=!0,q.subscribe(()=>{super.next(this.state),U(this.events),this.batchInProgress=!1})):(super.next(this.state),U(this.events)))}getValue(){return this.state}reset(){this.update(()=>this.initialState)}combine(e){let r=!0,n={};return new R(s=>{for(let[i,d]of Object.entries(e))s.add(d.subscribe(m=>{n[i]=m,r=!0}));return this.subscribe({next(){r&&(s.next(u({},n)),r=!1)},error(i){s.error(i)},complete(){s.complete()}})})}destroy(){Q(this),this.reset()}next(e){this.update(()=>e)}error(){}complete(){}};function H(t,...e){let{state:r,config:n}=D(...e),{name:s}=t;return new P({name:s,state:r,config:n})}function X(t){return typeof t=="function"}function pt(t){return t.charAt(0).toUpperCase()+t.slice(1)}function h(t,e){return function(r){return j(u({},r),{[t]:X(e)?e(r[t]):e})}}function V(t){return b(O(t),N())}function ht(){return x(t=>t!=null)}function L(t){return{props:t,config:void 0}}function F(t,e){let r={source:o=>o,preStoreInit:o=>o,key:e.key??`${t.name}@store`,runGuard(){return typeof window<"u"}},n=u(u({},r),e);if(!n.runGuard?.())return{initialized$:f(!1),unsubscribe(){}};let{storage:s}=e,i=new v(1),d=E(s.getItem(n.key)).subscribe(o=>{o&&t.update(S=>n.preStoreInit(u(u({},S),o))),i.next(!0),i.complete()}),m=n.source(t).pipe(z(1),M(o=>{let S=n.preStorageUpdate?n.preStorageUpdate(t.name,o):o;return s.setItem(n.key,S)})).subscribe();return{initialized$:i.asObservable(),unsubscribe(){m.unsubscribe(),d.unsubscribe()}}}function G(t){if(t)return{getItem(e){let r=t.getItem(e);return f(r&&JSON.parse(r))},setItem(e,r){return t.setItem(e,JSON.stringify(r)),f(!0)},removeItem(e){return t.removeItem(e),f(!0)}}}var Y=()=>{try{if(typeof localStorage<"u")return localStorage}catch{}},B=G(Y()),Z=()=>{try{if(typeof sessionStorage<"u")return sessionStorage}catch{}},yt=G(Z());var a=function(t){return t.CROATIAN="hr-HR",t.BRITISH_ENGLISH="en-GB",t}(a||{}),xt=new Map([[a.BRITISH_ENGLISH,"English"],[a.CROATIAN,"Hrvatski"]]),wt=new Map([[a.BRITISH_ENGLISH,"flags-gb"],[a.CROATIAN,"flags-hr"]]);var k={language:a.CROATIAN,hasManuallyChosenLanguage:!1,playSounds:!0},_="archery-stats-settings",vt=(()=>{let e=class e{constructor(){this.store=H({name:_},L(k)),F(this.store,{key:_,storage:B}),this.lang$=this.store.pipe(V(n=>n.language),w({refCount:!0,bufferSize:1})),this.playSounds$=this.store.pipe(V(n=>n.playSounds),w({refCount:!0,bufferSize:1}))}setLanguage(n){this.store.update(h("language",n))}setHasManuallyChosenLanguage(n){this.store.update(h("hasManuallyChosenLanguage",n))}setPlaySounds(n){this.store.update(h("playSounds",n))}getStoreProp(n){return this.store.getValue()[n]}};e.\u0275fac=function(s){return new(s||e)},e.\u0275prov=T({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})();export{ut as a,ct as b,ft as c,lt as d,gt as e,H as f,pt as g,h,V as i,ht as j,L as k,F as l,B as m,a as n,xt as o,wt as p,vt as q};
