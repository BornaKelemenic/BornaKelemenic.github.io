"use strict";(self.webpackChunkarchery_stats=self.webpackChunkarchery_stats||[]).push([[133],{133:(Z,g,o)=>{o.r(g),o.d(g,{ListPageComponent:()=>h});var r=o(6895),a=o(4850),p=o(3336),t=o(4650),c=o(4859),l=o(6338),A=o(8778);class d{transform(n){return n.flat()}}d.\u0275fac=function(n){return new(n||d)},d.\u0275pipe=t.Yjl({name:"flatten",type:d,pure:!0,standalone:!0});var C=o(2189),L=o(489),T=o(5412),S=o(9613),v=o(9132),k=o(1331),_=o(8255);class j extends Map{constructor(n,s){super(s),this.defaultValue=n}get(n){return this.has(n)?super.get(n):this.defaultValue}}var y=o(2823),U=o(7009),w=o(3959);const F=function(e){return{session:e}};function O(e,n){if(1&e&&(t.TgZ(0,"button",12),t.NdJ("click",function(i){return i.stopPropagation()}),t.TgZ(1,"mat-icon"),t._uU(2,"more_vert"),t.qZA()()),2&e){const s=t.oxw().$implicit;t.oxw(3);const i=t.MAs(3);t.Q6J("matMenuTriggerFor",i)("matMenuTriggerData",t.VKq(2,F,s))}}const I=function(e){return["/list",e]};function Y(e,n){if(1&e){const s=t.EpF();t.TgZ(0,"mat-list-item",6),t.NdJ("click",function(){const m=t.CHM(s).$implicit,x=t.oxw(3);return t.KtG(x.sessionClicked.emit(m))}),t.ALo(1,"async"),t.TgZ(2,"span",7),t._uU(3),t.qZA(),t.TgZ(4,"span",8)(5,"span",9),t.ALo(6,"date"),t._uU(7),t.ALo(8,"dateDistance"),t.qZA()(),t.TgZ(9,"span",8)(10,"span"),t._uU(11),t.qZA(),t.TgZ(12,"span",10),t._uU(13,"\u2022"),t.qZA(),t.TgZ(14,"span"),t._uU(15),t.ALo(16,"average"),t.ALo(17,"pluck"),t.ALo(18,"flatten"),t.ALo(19,"pluck"),t.qZA(),t.TgZ(20,"span",10),t._uU(21,"\u2022"),t.qZA(),t.TgZ(22,"span"),t._uU(23),t.qZA()(),t.YNc(24,O,3,4,"button",11),t.qZA()}if(2&e){const s=n.$implicit,i=n.index,u=t.oxw(3);let m;t.Udp("padding-right",u.showAction?"48px":null),t.Q6J("routerLink",t.VKq(29,I,s.id))("lines",3)("activated",s.id===(null==(m=t.lcZ(1,13,u.archerySessionRepo.activeSession$))?null:m.id)),t.xp6(3),t.AsE(" ",i+1,". ",s.name," "),t.xp6(2),t.Q6J("title",t.lcZ(6,15,s.date_created)||""),t.xp6(2),t.hij(" ",t.lcZ(8,17,s.date_created)," "),t.xp6(4),t.hij(" Arrows: ",s.numberOfArrows," "),t.xp6(4),t.hij(" Average: ",t.lcZ(16,19,t.xi3(17,21,t.lcZ(18,24,t.xi3(19,26,s.entries,"shots")),"value"))," "),t.xp6(8),t.hij(" Entires: ",s.entries.length," "),t.xp6(1),t.Q6J("ngIf",u.showAction)}}function E(e,n){if(1&e&&(t.ynx(0),t.YNc(1,Y,25,31,"mat-list-item",5),t.BQk()),2&e){const s=t.oxw().ngIf;t.xp6(1),t.Q6J("ngForOf",s)}}function b(e,n){1&e&&(t.TgZ(0,"mat-list-item")(1,"span",7),t._uU(2," No sessions "),t.qZA()())}function J(e,n){if(1&e&&(t.TgZ(0,"mat-list"),t.YNc(1,E,2,1,"ng-container",3),t.YNc(2,b,3,0,"ng-template",null,4,t.W1O),t.qZA()),2&e){const s=n.ngIf,i=t.MAs(3);t.xp6(1),t.Q6J("ngIf",s.length)("ngIfElse",i)}}function N(e,n){if(1&e){const s=t.EpF();t.TgZ(0,"button",13),t.NdJ("click",function(){const m=t.CHM(s).session,x=t.oxw();return t.KtG(x.onExportClicked(m))}),t.TgZ(1,"mat-icon"),t._uU(2,"file_download"),t.qZA(),t.TgZ(3,"span"),t._uU(4,"Export/Save CSV"),t.qZA()(),t.TgZ(5,"button",13),t.NdJ("click",function(){const m=t.CHM(s).session,x=t.oxw();return t.KtG(x.removeArcherySession(m))}),t.TgZ(6,"mat-icon",14),t._uU(7,"delete_outline"),t.qZA(),t.TgZ(8,"span"),t._uU(9,"Delete session"),t.qZA()()}}class f{constructor(n,s,i,u){this.archerySessionRepo=n,this.dialog=s,this.snackbar=i,this.papa=u,this.showAction=!0,this.sessionClicked=new t.vpe}removeArcherySession(n){n?this.dialog.open(S.M,{restoreFocus:!1,autoFocus:!1,width:"300px",data:{title:"Delete session ?"}}).afterClosed().subscribe(i=>{i&&(0,k.xr)(()=>{this.archerySessionRepo.getActiveSession()?.id===n.id&&this.archerySessionRepo.resetActiveSession(),this.archerySessionRepo.deleteSessions(n.id)})}):this.snackbar.open("Session data missing","OK")}onExportClicked(n){const s=function M(e){return e.entries.map(n=>n.shots.map(s=>s.value))}(n);!function P(e,n,s="text"){if(navigator.msSaveBlob)navigator.msSaveOrOpenBlob(new Blob([e],{type:s}),n);else{const i=window.document.createElement("a");i.href=window.URL.createObjectURL(new Blob([e],{type:s})),i.download=n,document.body.appendChild(i),i.click(),document.body.removeChild(i)}}(this.papa.unparse(s),n.name,"text/csv")}}function Q(e,n){if(1&e&&(t.ynx(0),t.TgZ(1,"div",1)(2,"h2"),t._uU(3),t.qZA()(),t._UZ(4,"mat-divider",2),t.TgZ(5,"h3"),t._uU(6),t.ALo(7,"average"),t.ALo(8,"pluck"),t.ALo(9,"flatten"),t.ALo(10,"pluck"),t.ALo(11,"flatten"),t.ALo(12,"pluck"),t.qZA(),t._UZ(13,"mat-divider",2),t.BQk()),2&e){const s=t.oxw().ngIf;t.xp6(3),t.hij("Your sessions (",s.length,"):"),t.xp6(3),t.hij(" Your overall average: ",t.lcZ(7,2,t.xi3(8,4,t.lcZ(9,7,t.xi3(10,9,t.lcZ(11,12,t.xi3(12,14,s,"entries")),"shots")),"value"))," ")}}function R(e,n){1&e&&(t.ynx(0),t.TgZ(1,"div",2)(2,"a",3)(3,"mat-icon"),t._uU(4,"add"),t.qZA(),t._uU(5," Create a new session "),t.qZA()(),t.BQk()),2&e&&(t.xp6(2),t.Q6J("routerLink","/new"))}function D(e,n){if(1&e&&(t.ynx(0),t.YNc(1,Q,14,17,"ng-container",0),t._UZ(2,"app-session-list"),t.YNc(3,R,6,1,"ng-container",0),t.BQk()),2&e){const s=n.ngIf;t.xp6(1),t.Q6J("ngIf",s.length),t.xp6(2),t.Q6J("ngIf",!s.length)}}f.\u0275fac=function(n){return new(n||f)(t.Y36(y.H),t.Y36(T.uw),t.Y36(U.ux),t.Y36(w.N))},f.\u0275cmp=t.Xpm({type:f,selectors:[["app-session-list"]],inputs:{showAction:"showAction"},outputs:{sessionClicked:"sessionClicked"},standalone:!0,features:[t.jDz],decls:5,vars:3,consts:[[4,"ngIf"],["actionMenu","matMenu"],["matMenuContent",""],[4,"ngIf","ngIfElse"],["noSessions",""],[3,"routerLink","lines","activated","padding-right","click",4,"ngFor","ngForOf"],[3,"routerLink","lines","activated","click"],["matListItemTitle",""],["matListItemLine",""],[3,"title"],[2,"margin","0 4px"],["class","action","mat-icon-button","",3,"matMenuTriggerFor","matMenuTriggerData","click",4,"ngIf"],["mat-icon-button","",1,"action",3,"matMenuTriggerFor","matMenuTriggerData","click"],["mat-menu-item","",3,"click"],["color","warn"]],template:function(n,s){1&n&&(t.YNc(0,J,4,2,"mat-list",0),t.ALo(1,"async"),t.TgZ(2,"mat-menu",null,1),t.YNc(4,N,10,0,"ng-template",2),t.qZA()),2&n&&t.Q6J("ngIf",t.lcZ(1,1,s.archerySessionRepo.sessions$))},dependencies:[r.ax,r.O5,r.Ov,r.uU,A.n,d,C.F,L.p,v.Bz,v.rH,l.ie,l.i$,l.Tg,l.WW,l.sL,p.Ps,p.Hw,c.ot,c.RK,T.Is,_.Tx,_.VK,_.OP,_.KA,_.p6],styles:["[_nghost-%COMP%]{display:block}mat-list-item[_ngcontent-%COMP%]{cursor:pointer!important}mat-list-item[_ngcontent-%COMP%]:hover:not(.mdc-list-item--activated){background-color:var(--list-item-hover-background)}"]});class h{constructor(n){this.archerySessionRepo=n}}h.\u0275fac=function(n){return new(n||h)(t.Y36(y.H))},h.\u0275cmp=t.Xpm({type:h,selectors:[["app-list-page"]],standalone:!0,features:[t.jDz],decls:2,vars:3,consts:[[4,"ngIf"],[1,"margin-bottom-2x","flex-row"],[1,"margin-y-2x"],["mat-stroked-button","",3,"routerLink"]],template:function(n,s){1&n&&(t.YNc(0,D,4,2,"ng-container",0),t.ALo(1,"async")),2&n&&t.Q6J("ngIf",t.lcZ(1,1,s.archerySessionRepo.sessions$))},dependencies:[r.O5,r.Ov,C.F,d,L.p,v.Bz,v.rH,f,a.t,a.d,p.Ps,p.Hw,c.ot,c.zs],styles:["[_nghost-%COMP%]{display:block;padding:var(--spacing-3x) var(--spacing-1x)}@media (min-width: 768px){[_nghost-%COMP%]{padding:var(--spacing-3x)}}"]})},489:(Z,g,o)=>{o.d(g,{p:()=>a});var r=o(4650);class a{transform(t,c=2){return t&&t.length?(t.reduce((l,A)=>l+A,0)/t.length).toFixed(c):"0"}}a.\u0275fac=function(t){return new(t||a)},a.\u0275pipe=r.Yjl({name:"average",type:a,pure:!0,standalone:!0})},2189:(Z,g,o)=>{o.d(g,{F:()=>a});var r=o(4650);class a{transform(t,c){return t&&c?t.map(l=>l[c]):[]}}a.\u0275fac=function(t){return new(t||a)},a.\u0275pipe=r.Yjl({name:"pluck",type:a,pure:!0,standalone:!0})}}]);