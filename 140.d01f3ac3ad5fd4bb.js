"use strict";(self.webpackChunkarchery_stats=self.webpackChunkarchery_stats||[]).push([[140],{8140:(Q,u,s)=>{s.r(u),s.d(u,{SessionStatsPageComponent:()=>R});var m=s(6895),t=s(4650),c=s(3546),o=s(6858),y=s(1282),A=s(4781),C=s(7579),S=s(2722),L=s(370),d=s(6276);let T=(()=>{class e{transform(a){return a&&a.length?a.map(r=>(0,d.Iz)(r.entries.map(n=>n.shots.map(g=>g.value)).flat())):[]}}return e.\u0275fac=function(a){return new(a||e)},e.\u0275pipe=t.Yjl({name:"sessionTotals",type:e,pure:!0,standalone:!0}),e})();var p=s(848),h=s(5621),x=s(489),P=s(7322),D=s(2189),I=s(4926),U=s(7697);const $=["totalsChart"],j=["averagesChart"];function N(e,i){1&e&&(t.TgZ(0,"div",7)(1,"h2",8),t._uU(2,"No sessions yet"),t.qZA()())}function H(e,i){if(1&e&&(t.TgZ(0,"mat-card-content")(1,"p"),t._uU(2),t.ALo(3,"average"),t.ALo(4,"pluck"),t.ALo(5,"flatten"),t.ALo(6,"pluck"),t.ALo(7,"flatten"),t.ALo(8,"pluck"),t.qZA(),t.TgZ(9,"p"),t._uU(10),t.ALo(11,"sum"),t.ALo(12,"pluck"),t.ALo(13,"flatten"),t.ALo(14,"pluck"),t.ALo(15,"flatten"),t.ALo(16,"pluck"),t.qZA(),t.TgZ(17,"p"),t._uU(18),t.ALo(19,"average"),t.ALo(20,"sessionTotals"),t.qZA()()),2&e){const a=i.ngIf;t.xp6(2),t.hij(" Average: ",t.lcZ(3,3,t.xi3(4,5,t.lcZ(5,8,t.xi3(6,10,t.lcZ(7,13,t.xi3(8,15,a,"entries")),"shots")),"value"))," "),t.xp6(8),t.hij(" Total: ",t.lcZ(11,18,t.xi3(12,20,t.lcZ(13,23,t.xi3(14,25,t.lcZ(15,28,t.xi3(16,30,a,"entries")),"shots")),"value"))," "),t.xp6(8),t.hij(" Average Total: ",t.lcZ(19,33,t.lcZ(20,35,a))," ")}}o.kL.register(o.vn,o.uw,o.f$,o.od,o.ZL,y.Z,o.u,A.Z);let R=(()=>{class e{constructor(a){this.archerySessionRepo=a,this.destroy$=new C.x}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}ngAfterViewInit(){this.setupDefaultChartColors();const a=new o.kL(this.totalsChart.nativeElement,{type:"bar",data:{datasets:[]}}),r=new o.kL(this.averagesChart.nativeElement,{type:"bar",data:{datasets:[]}});this.archerySessionRepo.sortedSessions$.pipe((0,S.R)(this.destroy$)).subscribe(n=>{const g=n.map(l=>l.name),v=n.map(l=>l.entries.map(Y=>Y.shots.map(O=>O.value))),f=v.map(l=>(0,d.Iz)(l.flat())),Z=v.map(l=>l.length?+(0,d.Y8)(l.flat()).toFixed(2):0);a.data={labels:[...g],datasets:[{...p.$L,data:f}]},a.options={...p.NH,plugins:{...p.NH.plugins,annotation:{annotations:{averageLine:{drawTime:"afterDatasetsDraw",type:"line",scaleID:"y",value:(0,d.Y8)(f),borderColor:"red",borderDash:[6,6]}}}}},a.update("none"),r.data={labels:[...g],datasets:[{...p.$L,data:Z}]},r.options={...p.NH,plugins:{...p.NH.plugins,annotation:{annotations:{averageLine:{drawTime:"afterDatasetsDraw",type:"line",scaleID:"y",value:(0,d.Y8)(Z),borderColor:"red",borderDash:[6,6]}}}}},r.update("none")})}setupDefaultChartColors(){o.kL.defaults.color=h.I.foregroundText(),o.kL.defaults.borderColor=h.I.getProp("--foreground-divider")}}return e.\u0275fac=function(a){return new(a||e)(t.Y36(U.H))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-session-stats-page"]],viewQuery:function(a,r){if(1&a&&(t.Gf($,5,t.SBq),t.Gf(j,5,t.SBq)),2&a){let n;t.iGM(n=t.CRH())&&(r.totalsChart=n.first),t.iGM(n=t.CRH())&&(r.averagesChart=n.first)}},standalone:!0,features:[t.jDz],decls:19,vars:6,consts:[["class","margin-bottom-8x",4,"ngIf"],["appearance","outlined",1,"margin-bottom-2x"],[4,"ngIf"],[1,"margin-bottom-2x"],[1,"chart-holder"],["averagesChart",""],["totalsChart",""],[1,"margin-bottom-8x"],[2,"text-align","center"]],template:function(a,r){if(1&a&&(t.YNc(0,N,3,0,"div",0),t.ALo(1,"async"),t.TgZ(2,"mat-card",1)(3,"mat-card-header")(4,"mat-card-title"),t._uU(5,"Overall stats"),t.qZA()(),t.YNc(6,H,21,37,"mat-card-content",2),t.ALo(7,"async"),t.qZA(),t._UZ(8,"app-session-sort-menu",3),t.TgZ(9,"h2"),t._uU(10,"Averages per session"),t.qZA(),t.TgZ(11,"div",4),t._UZ(12,"canvas",null,5),t.qZA(),t.TgZ(14,"h2"),t._uU(15,"Totals per session"),t.qZA(),t.TgZ(16,"div",4),t._UZ(17,"canvas",null,6),t.qZA()),2&a){let n;t.Q6J("ngIf",!(null!=(n=t.lcZ(1,2,r.archerySessionRepo.sessions$))&&n.length)),t.xp6(6),t.Q6J("ngIf",t.lcZ(7,4,r.archerySessionRepo.sessions$))}},dependencies:[m.O5,m.Ov,I.q,x.p,D.F,P.p,T,L.A,c.QW,c.a8,c.dn,c.dk,c.n5],styles:["[_nghost-%COMP%]{display:block;padding:var(--spacing-3x) var(--spacing-1x)}@media (min-width: 768px){[_nghost-%COMP%]{padding:var(--spacing-3x)}}"],changeDetection:0}),e})()}}]);