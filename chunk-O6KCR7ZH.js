import{c as Ee,d as le,f as q,g as me}from"./chunk-SNDQO5FA.js";import{b as ft,c as _t,d as ht,e as de,f as Nt,g as qt,h as Ut}from"./chunk-C7ESUAUF.js";import"./chunk-7C5UBPY7.js";import{a as wt,c as $t,d as Bt,e as kt,f as Lt,g as Rt,h as zt,i as At,j as Vt,k as Ot,l as ue,n as fe,o as _e}from"./chunk-ZCEIQ5PE.js";import{e as ot}from"./chunk-S64JEGRV.js";import{a as he,b as be,c as ve,d as ye}from"./chunk-MYKOLI6S.js";import{c as ce,d as pt,e as dt,f as gt,g as ut,h as U,i as Ht}from"./chunk-6I3RXIRK.js";import"./chunk-SGYCFQGT.js";import{a as St,b as xt,e as pe,f as Mt,g as G}from"./chunk-JL3X65JT.js";import{t as Ct}from"./chunk-HNB34FLC.js";import{a as bt,b as vt,c as jt}from"./chunk-SB6RZB7J.js";import{d as Pt}from"./chunk-O3DFFZMN.js";import"./chunk-BXAUEGAT.js";import{a as We,f as Ze,h as K,i as Q,k as Ke,l as st,m as lt}from"./chunk-DEMOXIUP.js";import{a as Tt}from"./chunk-KVEUNRWO.js";import{a as yt,i as Dt,k as Et,o as ge,q as Ft,t as It}from"./chunk-IXICGOBR.js";import{m as ae,o as re,p as se,q as at,r as B}from"./chunk-JYPJOC3Y.js";import{$ as ee,$a as c,Ac as nt,Da as g,Db as j,Dc as De,E as w,Fb as Ue,G as Le,Gb as Ge,H as Y,Hb as Ye,Hc as rt,Ia as p,Ja as je,Jb as Qe,Ka as ne,Mc as N,N as Re,Na as D,Nc as mt,O as ze,Oa as W,Pc as ct,Qa as A,Qb as H,Qc as M,R as m,Ra as V,Rc as T,Sa as a,Ta as r,Ua as _,V as b,Va as S,W as v,Wa as x,Wb as oe,Wc as k,Xc as L,Ya as E,_a as y,ba as Ae,ca as Ve,da as $,ea as te,ga as Me,j as $e,ja as Pe,jb as Z,kb as s,kc as Je,lb as u,lc as Xe,m as X,mb as d,n as Ce,nb as Te,oa as o,ob as F,pb as P,qb as O,qc as et,r as Be,ra as Oe,tb as He,tc as tt,ub as C,uc as it,vb as I,wb as qe,xa as f,ya as Ne,z as ke,za as ie}from"./chunk-ORNXUK3Z.js";import{a as we,f as xe}from"./chunk-EQDQRRRY.js";var Gt="mat-badge-content",ii=(()=>{class t{static \u0275fac=function(i){return new(i||t)};static \u0275cmp=f({type:t,selectors:[["ng-component"]],decls:0,vars:0,template:function(i,n){},styles:[`.mat-badge{position:relative}.mat-badge.mat-badge{overflow:visible}.mat-badge-content{position:absolute;text-align:center;display:inline-block;transition:transform 200ms ease-in-out;transform:scale(0.6);overflow:hidden;white-space:nowrap;text-overflow:ellipsis;box-sizing:border-box;pointer-events:none;background-color:var(--mat-badge-background-color, var(--mat-sys-error));color:var(--mat-badge-text-color, var(--mat-sys-on-error));font-family:var(--mat-badge-text-font, var(--mat-sys-label-small-font));font-weight:var(--mat-badge-text-weight, var(--mat-sys-label-small-weight));border-radius:var(--mat-badge-container-shape, var(--mat-sys-corner-full))}.mat-badge-above .mat-badge-content{bottom:100%}.mat-badge-below .mat-badge-content{top:100%}.mat-badge-before .mat-badge-content{right:100%}[dir=rtl] .mat-badge-before .mat-badge-content{right:auto;left:100%}.mat-badge-after .mat-badge-content{left:100%}[dir=rtl] .mat-badge-after .mat-badge-content{left:auto;right:100%}@media(forced-colors: active){.mat-badge-content{outline:solid 1px;border-radius:0}}.mat-badge-disabled .mat-badge-content{background-color:var(--mat-badge-disabled-state-background-color, color-mix(in srgb, var(--mat-sys-error) 38%, transparent));color:var(--mat-badge-disabled-state-text-color, var(--mat-sys-on-error))}.mat-badge-hidden .mat-badge-content{display:none}.ng-animate-disabled .mat-badge-content,.mat-badge-content._mat-animation-noopable{transition:none}.mat-badge-content.mat-badge-active{transform:none}.mat-badge-small .mat-badge-content{width:var(--mat-badge-legacy-small-size-container-size, unset);height:var(--mat-badge-legacy-small-size-container-size, unset);min-width:var(--mat-badge-small-size-container-size, 6px);min-height:var(--mat-badge-small-size-container-size, 6px);line-height:var(--mat-badge-small-size-line-height, 6px);padding:var(--mat-badge-small-size-container-padding, 0);font-size:var(--mat-badge-small-size-text-size, 0);margin:var(--mat-badge-small-size-container-offset, -6px 0)}.mat-badge-small.mat-badge-overlap .mat-badge-content{margin:var(--mat-badge-small-size-container-overlap-offset, -6px)}.mat-badge-medium .mat-badge-content{width:var(--mat-badge-legacy-container-size, unset);height:var(--mat-badge-legacy-container-size, unset);min-width:var(--mat-badge-container-size, 16px);min-height:var(--mat-badge-container-size, 16px);line-height:var(--mat-badge-line-height, 16px);padding:var(--mat-badge-container-padding, 0 4px);font-size:var(--mat-badge-text-size, var(--mat-sys-label-small-size));margin:var(--mat-badge-container-offset, -12px 0)}.mat-badge-medium.mat-badge-overlap .mat-badge-content{margin:var(--mat-badge-container-overlap-offset, -12px)}.mat-badge-large .mat-badge-content{width:var(--mat-badge-legacy-large-size-container-size, unset);height:var(--mat-badge-legacy-large-size-container-size, unset);min-width:var(--mat-badge-large-size-container-size, 16px);min-height:var(--mat-badge-large-size-container-size, 16px);line-height:var(--mat-badge-large-size-line-height, 16px);padding:var(--mat-badge-large-size-container-padding, 0 4px);font-size:var(--mat-badge-large-size-text-size, var(--mat-sys-label-small-size));margin:var(--mat-badge-large-size-container-offset, -12px 0)}.mat-badge-large.mat-badge-overlap .mat-badge-content{margin:var(--mat-badge-large-size-container-overlap-offset, -12px)}
`],encapsulation:2,changeDetection:0})}return t})(),Yt=(()=>{class t{_ngZone=m(Ae);_elementRef=m(te);_ariaDescriber=m(nt);_renderer=m(Oe);_animationMode=m(Pe,{optional:!0});_idGenerator=m(it);get color(){return this._color}set color(e){this._setColor(e),this._color=e}_color="primary";overlap=!0;disabled;position="above after";get content(){return this._content}set content(e){this._updateRenderedContent(e)}_content;get description(){return this._description}set description(e){this._updateDescription(e)}_description;size="medium";hidden;_badgeElement;_inlineBadgeDescription;_isInitialized=!1;_interactivityChecker=m(et);_document=m(Qe);constructor(){let e=m(Je);e.load(ii),e.load(Xe)}isAbove(){return this.position.indexOf("below")===-1}isAfter(){return this.position.indexOf("before")===-1}getBadgeElement(){return this._badgeElement}ngOnInit(){this._clearExistingBadges(),this.content&&!this._badgeElement&&(this._badgeElement=this._createBadgeElement(),this._updateRenderedContent(this.content)),this._isInitialized=!0}ngOnDestroy(){this._renderer.destroyNode&&(this._renderer.destroyNode(this._badgeElement),this._inlineBadgeDescription?.remove()),this._ariaDescriber.removeDescription(this._elementRef.nativeElement,this.description)}_isHostInteractive(){return this._interactivityChecker.isFocusable(this._elementRef.nativeElement,{ignoreVisibility:!0})}_createBadgeElement(){let e=this._renderer.createElement("span"),i="mat-badge-active";return e.setAttribute("id",this._idGenerator.getId("mat-badge-content-")),e.setAttribute("aria-hidden","true"),e.classList.add(Gt),this._animationMode==="NoopAnimations"&&e.classList.add("_mat-animation-noopable"),this._elementRef.nativeElement.appendChild(e),typeof requestAnimationFrame=="function"&&this._animationMode!=="NoopAnimations"?this._ngZone.runOutsideAngular(()=>{requestAnimationFrame(()=>{e.classList.add(i)})}):e.classList.add(i),e}_updateRenderedContent(e){let i=`${e??""}`.trim();this._isInitialized&&i&&!this._badgeElement&&(this._badgeElement=this._createBadgeElement()),this._badgeElement&&(this._badgeElement.textContent=i),this._content=i}_updateDescription(e){this._ariaDescriber.removeDescription(this._elementRef.nativeElement,this.description),(!e||this._isHostInteractive())&&this._removeInlineDescription(),this._description=e,this._isHostInteractive()?this._ariaDescriber.describe(this._elementRef.nativeElement,e):this._updateInlineDescription()}_updateInlineDescription(){this._inlineBadgeDescription||(this._inlineBadgeDescription=this._document.createElement("span"),this._inlineBadgeDescription.classList.add("cdk-visually-hidden")),this._inlineBadgeDescription.textContent=this.description,this._badgeElement?.appendChild(this._inlineBadgeDescription)}_removeInlineDescription(){this._inlineBadgeDescription?.remove(),this._inlineBadgeDescription=void 0}_setColor(e){let i=this._elementRef.nativeElement.classList;i.remove(`mat-badge-${this._color}`),e&&i.add(`mat-badge-${e}`)}_clearExistingBadges(){let e=this._elementRef.nativeElement.querySelectorAll(`:scope > .${Gt}`);for(let i of Array.from(e))i!==this._badgeElement&&i.remove()}static \u0275fac=function(i){return new(i||t)};static \u0275dir=ie({type:t,selectors:[["","matBadge",""]],hostAttrs:[1,"mat-badge"],hostVars:20,hostBindings:function(i,n){i&2&&ne("mat-badge-overlap",n.overlap)("mat-badge-above",n.isAbove())("mat-badge-below",!n.isAbove())("mat-badge-before",!n.isAfter())("mat-badge-after",n.isAfter())("mat-badge-small",n.size==="small")("mat-badge-medium",n.size==="medium")("mat-badge-large",n.size==="large")("mat-badge-hidden",n.hidden||!n.content)("mat-badge-disabled",n.disabled)},inputs:{color:[0,"matBadgeColor","color"],overlap:[2,"matBadgeOverlap","overlap",j],disabled:[2,"matBadgeDisabled","disabled",j],position:[0,"matBadgePosition","position"],content:[0,"matBadge","content"],description:[0,"matBadgeDescription","description"],size:[0,"matBadgeSize","size"],hidden:[2,"matBadgeHidden","hidden",j]}})}return t})(),Wt=(()=>{class t{static \u0275fac=function(i){return new(i||t)};static \u0275mod=Ne({type:t});static \u0275inj=ze({imports:[tt,De,De]})}return t})();var oi={sortBy:pe.NEWEST_FIRST,targetFace:null,shootingType:null,distance:null},Zt="archery-stats-session-filters",z=(()=>{class t{constructor(){this.store=Ze({name:Zt},Ke(oi)),st(this.store,{key:Zt,storage:lt}),this.sortBy$=this.store.pipe(Q(e=>e.sortBy),w({refCount:!0,bufferSize:1})),this.targetFace$=this.store.pipe(Q(e=>e.targetFace),w({refCount:!0,bufferSize:1})),this.shootingType$=this.store.pipe(Q(e=>e.shootingType),w({refCount:!0,bufferSize:1})),this.distance$=this.store.pipe(Q(e=>e.distance),w({refCount:!0,bufferSize:1})),this.filters$=Ce({sortBy:this.sortBy$,targetFace:this.targetFace$,shootingType:this.shootingType$,distance:this.distance$}).pipe(w({refCount:!0,bufferSize:1})),this.activeFiltersCount$=Ce({targetFace:this.targetFace$,shootingType:this.shootingType$,distance:this.distance$}).pipe(X(e=>{let i=0;return Object.values(e).forEach(n=>{Ct(n)&&i++}),i}),w({refCount:!0,bufferSize:1}))}setSortBy(e){this.store.update(K("sortBy",e))}setTargetFace(e){this.store.update(K("targetFace",e))}setShootingType(e){this.store.update(K("shootingType",e))}setDistance(e){this.store.update(K("distance",e))}getStoreProp(e){return this.store.getValue()[e]}resetAll(){this.store.reset()}resetOnlyFilters(){We(()=>{let e=this.getStoreProp("sortBy");this.resetAll(),this.setSortBy(e)})}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275prov=Re({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();function ai(t,l){if(t&1&&(a(0,"mat-radio-button",3),s(1),r()),t&2){let e=l.$implicit,i=c().$implicit;p("value",e[0]),o(),d(" ",i(e[1])," ")}}function ri(t,l){if(t&1&&(_(0,"img",8),a(1,"span",9),s(2),r()),t&2){let e=c().$implicit,i=c();p("ngSrc",i.TargetFaceImgMap.get(i.targetFaceControl.value)),o(2),d(" ",e(i.TargetFaceNameMap.get(i.targetFaceControl.value))," ")}}function si(t,l){if(t&1&&s(0),t&2){let e=c().$implicit;d(" ",e("generic.all")," ")}}function li(t,l){if(t&1&&(F(0)(1),a(2,"mat-option",3),_(3,"img",8),a(4,"span",9),s(5),r()()),t&2){let e=l.$implicit,i=c().$implicit,n=c(),h=e[0],Se=e[1];o(2),p("value",h),o(),p("ngSrc",n.TargetFaceImgMap.get(h)),o(2),d(" ",i(Se)," ")}}function mi(t,l){if(t&1&&(S(0),a(1,"div",1)(2,"label"),s(3),r(),a(4,"mat-radio-group",2)(5,"mat-radio-button",3),s(6),r(),A(7,ai,2,2,"mat-radio-button",3,W),r()(),a(9,"mat-form-field",4)(10,"mat-label"),s(11),r(),a(12,"mat-select",2)(13,"mat-select-trigger"),g(14,ri,3,2)(15,si,1,1),r(),a(16,"mat-option",5),s(17),r(),A(18,li,6,3,"mat-option",3,W),r()(),a(20,"div",6)(21,"label"),s(22),r(),_(23,"app-small-counter",7),r(),x()),t&2){let e=l.$implicit,i=c();o(3),d(" ",e("form.labels.shootingType"),": "),o(),p("formControl",i.shootingTypeControl),o(),p("value",null),o(),u(e("generic.all")),o(),V(i.ShootingTypeNameMap.entries()),o(4),u(e("form.labels.targetFace")),o(),p("formControl",i.targetFaceControl),o(2),D(i.targetFaceControl.value!=="all"?14:15),o(3),u(e("generic.all")),o(),V(i.TargetFaceNameMap.entries()),o(4),u(e("form.labels.distance")),o(),p("formControl",i.distanceControl)}}var Kt=(()=>{class t{constructor(){this.destroyRef=m(ee),this.sessionFiltersRepo=m(z),this.TargetFaceNameMap=fe,this.TargetFaceImgMap=_e,this.ShootingType=Ot,this.ShootingTypeNameMap=ue,this.targetFaceControl=new ge(this.sessionFiltersRepo.getStoreProp("targetFace")??"all",{nonNullable:!0}),this.shootingTypeControl=new ge(this.sessionFiltersRepo.getStoreProp("shootingType")),this.distanceControl=new ge(this.sessionFiltersRepo.getStoreProp("distance"),{nonNullable:!0,validators:[Dt.min(0)]}),this.listenToRepoValueChanges(),this.setupControlValueChangeListeners()}listenToRepoValueChanges(){this.sessionFiltersRepo.filters$.pipe(N(this.destroyRef)).subscribe(({targetFace:e,shootingType:i,distance:n})=>{this.targetFaceControl.setValue(e??"all",{emitEvent:!1}),this.shootingTypeControl.setValue(i,{emitEvent:!1}),this.distanceControl.setValue(n,{emitEvent:!1})})}setupControlValueChangeListeners(){this.targetFaceControl.valueChanges.pipe(N(this.destroyRef)).subscribe(e=>this.sessionFiltersRepo.setTargetFace(e==="all"?null:e)),this.shootingTypeControl.valueChanges.pipe(N(this.destroyRef)).subscribe(e=>this.sessionFiltersRepo.setShootingType(e)),this.distanceControl.valueChanges.pipe(N(this.destroyRef)).subscribe(e=>this.sessionFiltersRepo.setDistance(e===0?null:e))}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275cmp=f({type:t,selectors:[["app-session-filters"]],decls:1,vars:0,consts:[[4,"transloco"],[1,"flex-column","margin-bottom-4x"],[3,"formControl"],[3,"value"],[1,"margin-bottom-4x"],["value","all"],[1,"flex-column","align-items-start"],["suffix","m","moreIncrements","",3,"formControl"],["width","30","height","30",2,"vertical-align","middle",3,"ngSrc"],[1,"margin-left-2x"]],template:function(i,n){i&1&&g(0,mi,24,10,"ng-container",0)},dependencies:[It,Et,Ft,oe,T,M,Pt,Rt,kt,Lt,Vt,$t,wt,zt,At,ot,Bt],styles:["[_nghost-%COMP%]{display:block}mat-form-field[_ngcontent-%COMP%]{width:100%}"],changeDetection:0})}}return t})();function ci(t,l){if(t&1){let e=E();S(0),a(1,"h2",1),s(2),r(),a(3,"mat-dialog-content"),_(4,"app-session-filters"),r(),a(5,"mat-dialog-actions")(6,"button",2),s(7),r(),_(8,"span",3),a(9,"button",4),y("click",function(){b(e);let n=c();return v(n.sessionFiltersRepo.resetOnlyFilters())}),s(10),r()(),x()}if(t&2){let e=l.$implicit;o(2),d(" ",e("session.dialogs.filtersDialog.title")," "),o(5),d(" ",e("generic.close")," "),o(3),d(" ",e("generic.resetFilters")," ")}}var Qt=(()=>{class t{constructor(){this.sessionFiltersRepo=m(z)}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275cmp=f({type:t,selectors:[["app-session-filters-dialog"]],decls:1,vars:0,consts:[[4,"transloco"],["mat-dialog-title",""],["mat-button","","type","button","mat-dialog-close",""],[1,"spacer"],["mat-button","","color","warn",3,"click"]],template:function(i,n){i&1&&g(0,ci,11,3,"ng-container",0)},dependencies:[T,M,Kt,U,pt,dt,ut,gt,B,re],styles:["[_nghost-%COMP%]{display:block}"],changeDetection:0})}}return t})();function di(t,l){if(t&1){let e=E();a(0,"button",7),y("click",function(n){return b(e),n.preventDefault(),v(n.stopPropagation())}),a(1,"mat-icon"),s(2),r()()}if(t&2){c();let e=Z(4),i=c();p("matMenuTriggerFor",e),o(2),u(i.$icon())}}function gi(t,l){if(t&1){let e=E();a(0,"button",8),y("click",function(n){return b(e),n.preventDefault(),v(n.stopPropagation())}),a(1,"mat-icon"),s(2),r()()}if(t&2){c();let e=Z(4),i=c();p("matMenuTriggerFor",e),o(2),u(i.$icon())}}function ui(t,l){if(t&1){let e=E();S(0),g(1,di,3,2,"button",2)(2,gi,3,2,"button",3),a(3,"mat-menu",null,0)(5,"button",4),y("click",function(){b(e);let n=c();return v(n.toggleLock())}),a(6,"mat-icon"),s(7),r(),a(8,"span"),s(9),r()(),a(10,"button",5),y("click",function(){b(e);let n=c();return v(n.openEditDialog())}),a(11,"mat-icon"),s(12,"edit"),r(),a(13,"span"),s(14),r()(),a(15,"button",4),y("click",function(){b(e);let n=c();return v(n.deleteSession())}),a(16,"mat-icon",6),s(17,"delete"),r(),a(18,"span"),s(19),r()()(),x()}if(t&2){let e,i=l.$implicit,n=c();o(),D((e=n.$buttonType())==="icon"?1:e==="fab"?2:-1),o(6),u(n.$isSessionLocked()?"lock":"lock_open"),o(2),d(" ",n.$isSessionLocked()?i("session.actions.pressToUnlock"):i("session.actions.pressToLock")," "),o(),p("disabled",n.$isSessionLocked()),o(4),u(i("session.actions.editSession")),o(5),u(i("session.actions.deleteSession"))}}var Jt=(()=>{class t{constructor(){this.sessionsDbService=m(G),this.dialog=m(ce),this.transloco=m(ct),this.appStateRepo=m(de),this.soundboard=m(qt),this.$isSessionLocked=Ge(()=>xt(this.$session().locked)),this.$session=$.required({alias:"session"}),this.$icon=$("more_vert",{alias:"icon-name"}),this.$buttonType=$("icon",{alias:"button-type"}),this.sessionDeleted=Ve()}deleteSession(){this.dialog.open(Ht,{width:"500px",data:{text:this.transloco.translate("session.dialogs.deleteDialog.text")}}).afterClosed().pipe(ke(1)).subscribe(i=>xe(this,null,function*(){i&&(yield this.sessionsDbService.deleteSession(this.$session().id),this.appStateRepo.setLastVisitedSession(null),this.sessionDeleted.emit())}))}openEditDialog(){this.dialog.open(Ut,{width:"500px",data:{sessionId:this.$session().id}})}toggleLock(){return xe(this,null,function*(){this.soundboard.play(this.$isSessionLocked()?"unlock":"lock"),yield this.sessionsDbService.updateSession(this.$session().id,{locked:St(!this.$isSessionLocked())})})}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275cmp=f({type:t,selectors:[["app-session-options-menu"]],inputs:{$session:[1,"session","$session"],$icon:[1,"icon-name","$icon"],$buttonType:[1,"button-type","$buttonType"]},outputs:{sessionDeleted:"sessionDeleted"},decls:1,vars:0,consts:[["menu","matMenu"],[4,"transloco"],["mat-icon-button","","type","button",3,"matMenuTriggerFor"],["mat-fab","","type","button",3,"matMenuTriggerFor"],["mat-menu-item","",3,"click"],["mat-menu-item","",3,"click","disabled"],["color","warn"],["mat-icon-button","","type","button",3,"click","matMenuTriggerFor"],["mat-fab","","type","button",3,"click","matMenuTriggerFor"]],template:function(i,n){i&1&&g(0,ui,20,6,"ng-container",1)},dependencies:[T,M,B,ae,se,L,k,ye,be,he,ve,U],styles:["[_nghost-%COMP%]{display:inline-block}"],changeDetection:0})}}return t})();function fi(t,l){t&1&&(a(0,"mat-icon"),s(1,"lock"),r())}function _i(t,l){if(t&1&&(S(0),F(1),_(2,"img",1),a(3,"div",2)(4,"span",3),s(5),g(6,fi,2,0,"mat-icon"),r(),a(7,"small"),s(8),C(9,"date"),C(10,"dateDistance"),r(),a(11,"div",4)(12,"small"),s(13),r(),a(14,"small"),s(15,"\u2022"),r(),a(16,"small"),s(17),r(),a(18,"small"),s(19,"\u2022"),r(),a(20,"small"),s(21),C(22,"async"),r(),a(23,"small"),s(24,"\u2022"),r(),a(25,"small"),s(26),r(),a(27,"small"),s(28),C(29,"async"),r(),a(30,"small"),s(31,"\u2022"),r(),a(32,"small"),s(33),r(),a(34,"small"),s(35),C(36,"async"),r()()(),_(37,"app-session-options-menu",5),x()),t&2){let e=l.$implicit,i=c(),n=i.$session();o(2),p("ngSrc",i.TargetFaceImgMap.get(n.targetFace)),o(3),d(" ",n.name," "),o(),D(n.locked?6:-1),o(2),Te(" ",qe(9,14,n.date,"short")," (",I(10,17,n.date),") "),o(5),u(e(i.ShootingTypeNameMap.get(n.shootingType))),o(4),d("",n.distance,"m"),o(4),Te("",e("session.info.rounds"),": ",I(22,19,i.roundCount$),""),o(5),d("",e("session.info.avg"),":"),o(2),u(I(29,21,i.avgScore$)),o(5),d("",e("session.info.total"),":"),o(2),u(I(36,23,i.shotsTotal$)),o(2),p("session",n)}}var Xt=(()=>{class t{constructor(){this.sessionsDbService=m(G),this.TargetFaceNameMap=fe,this.TargetFaceImgMap=_e,this.ShootingTypeNameMap=ue,this.roundCount$=$e(yt(()=>this.sessionsDbService.getRoundsCountBySessionId(this.$session().id))),this.$session=$.required({alias:"session"}),this.session$=mt(this.$session).pipe(w({refCount:!0,bufferSize:1})),this.shotsTotal$=this.session$.pipe(Y(e=>this.sessionsDbService.getTotalScoreBySessionID$(e.id))),this.avgScore$=this.session$.pipe(Y(e=>this.sessionsDbService.getAverageScoreBySessionID$(e.id)))}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275cmp=f({type:t,selectors:[["app-session-list-item"]],inputs:{$session:[1,"session","$session"]},decls:1,vars:0,consts:[[4,"transloco"],["alt","Target face","width","50","height","50",2,"border-radius","5px",3,"ngSrc"],[1,"flex-column","align-items-start"],[1,"session-name"],[1,"session-info"],[3,"session"]],template:function(i,n){i&1&&g(0,_i,38,25,"ng-container",0)},dependencies:[H,T,M,oe,jt,Nt,Jt,L,k],styles:["[_nghost-%COMP%]{display:grid;grid-template-columns:50px minmax(0,1fr) 40px;align-items:center;justify-content:flex-start;gap:var(--spacing-3x);padding:var(--spacing-2x)}.session-name[_ngcontent-%COMP%]{display:flex;align-items:center;column-gap:var(--spacing-1x);font-size:1.25em}.session-info[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;align-items:center;column-gap:var(--spacing-1x)}"],changeDetection:0})}}return t})();function hi(t,l){t&1&&(a(0,"mat-icon",5),s(1,"radio_button_checked"),r())}function bi(t,l){t&1&&(a(0,"mat-icon"),s(1,"radio_button_unchecked"),r())}function vi(t,l){if(t&1){let e=E();F(0)(1),a(2,"button",4),y("click",function(){b(e);let n=O(0),h=c(2);return v(h.sessionFiltersRepo.setSortBy(n))}),g(3,hi,2,0,"mat-icon",5)(4,bi,2,0,"mat-icon"),a(5,"span"),s(6),r()()}if(t&2){let e=l.$implicit,i=c().$implicit,n=O(1),h=P(e[0]),Se=e[1];o(3),D(n===h?3:4),o(3),u(i(Se))}}function yi(t,l){if(t&1&&(S(0),F(1),C(2,"async"),a(3,"button",2)(4,"mat-icon"),s(5,"sort"),r(),s(6),r(),a(7,"mat-menu",null,0),A(9,vi,7,3,"button",3,W),r(),x()),t&2){let e=l.$implicit,i=Z(8),n=c();o();let h=P(I(2,2,n.sessionFiltersRepo.sortBy$));o(2),p("matMenuTriggerFor",i),o(3),d(" ",e(n.SessionSortLabelMap.get(h))," "),o(3),V(n.SessionSortLabelMap.entries())}}var ei=(()=>{class t{constructor(){this.sessionFiltersRepo=m(z),this.SessionSort=pe,this.SessionSortLabelMap=Mt}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275cmp=f({type:t,selectors:[["app-session-sort-menu"]],decls:1,vars:0,consts:[["menu","matMenu"],[4,"transloco"],["mat-button","","type","button",3,"matMenuTriggerFor"],["mat-menu-item",""],["mat-menu-item","",3,"click"],["color","primary"]],template:function(i,n){i&1&&g(0,yi,11,5,"ng-container",1)},dependencies:[H,T,M,ye,be,he,ve,B,re,L,k],styles:["[_nghost-%COMP%]{display:inline-block}"],changeDetection:0})}}return t})();var ti=(()=>{class t{constructor(){this.elementRef=m(te),this.$appScrollIntoView=$.required({alias:"appScrollIntoView",transform:j}),this.$scrollDelay=$(100,{alias:"scrollDelay"}),Ye(()=>{this.$appScrollIntoView()&&Ue(()=>{setTimeout(()=>{this.elementRef.nativeElement.scrollIntoView({behavior:"smooth"})},this.$scrollDelay())})})}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275dir=ie({type:t,selectors:[["","appScrollIntoView",""]],hostVars:2,hostBindings:function(i,n){i&2&&je("scroll-margin","56px")},inputs:{$appScrollIntoView:[1,"appScrollIntoView","$appScrollIntoView"],$scrollDelay:[1,"scrollDelay","$scrollDelay"]}})}}return t})();var Si=t=>["/sessions",t],xi=(t,l)=>l.id;function Ci(t,l){t&1&&_(0,"mat-divider",11)}function Mi(t,l){if(t&1&&(a(0,"a",9),_(1,"app-session-list-item",10),r(),g(2,Ci,1,0,"mat-divider",11)),t&2){let e=l.$implicit,i=l.$index,n=l.$count;c(2);let h=O(2);p("routerLink",He(6,Si,e.id))("appScrollIntoView",i>=3&&h===e.id),o(),ne("active",h===e.id),p("session",e),o(),D(i!==n-1?2:-1)}}function Ti(t,l){if(t&1&&(a(0,"h5",6),s(1),r()),t&2){let e=c().$implicit;o(),d(" ",e("sessionsList.noSessions")," ")}}function Di(t,l){if(t&1){let e=E();a(0,"button",12),y("click",function(){b(e);let n=c(2);return v(n.scrollToTop())}),a(1,"mat-icon"),s(2,"keyboard_arrow_up"),r()()}t&2&&p("@scrollToTopButtonAnimation",void 0)}function Ei(t,l){if(t&1){let e=E();S(0),a(1,"app-page-with-title",1)(2,"button",2),y("click",function(){b(e);let n=c();return v(n.openFiltersDialog())}),a(3,"mat-icon",3),s(4,"tune"),r()(),a(5,"div",4)(6,"div",5),_(7,"app-session-sort-menu"),r(),A(8,Mi,3,8,null,null,xi,!1,Ti,2,1,"h5",6),C(11,"async"),r(),g(12,Di,3,1,"button",7),a(13,"button",8)(14,"mat-icon"),s(15,"add"),r()()(),x()}if(t&2){let e=l.$implicit,i=c(),n=O(0),h=O(4);o(),p("page-title",e("sessionsList.title")),o(),p("matTooltip",e("generic.filters"))("matBadge",n)("matBadgeHidden",!n),o(),p("color",n?"primary":""),o(5),V(I(11,7,i.sessions$)),o(4),D(h?12:-1)}}var ta=(()=>{class t{constructor(){this.destroyRef=m(ee),this.dialog=m(ce),this.sessionsDbService=m(G),this.appStateRepo=m(de),this.sessionFiltersRepo=m(z),this.sessions$=this.sessionFiltersRepo.filters$.pipe(Y(e=>this.sessionsDbService.getFilteredSessions(we({},e)))),this.$mainElement=Me(null),this.$showScrollToTopButton=Me(!1)}ngAfterViewInit(){let e=document.querySelector("main");e&&(this.$mainElement.set(e),Be(e,"scroll").pipe(X(()=>e.scrollTop),Le(e.scrollTop),N(this.destroyRef)).subscribe({next:i=>{this.$showScrollToTopButton.set(i>100)}}))}scrollToTop(){this.$mainElement()?.scrollTo({top:0,behavior:"smooth"})}openFiltersDialog(){this.dialog.open(Qt,{width:"500px"})}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275cmp=f({type:t,selectors:[["app-session-list-page"]],decls:6,vars:7,consts:[[4,"transloco"],[3,"page-title"],["mat-icon-button","","page-action","",3,"click","matTooltip","matBadge","matBadgeHidden"],[3,"color"],[1,"standard-centering"],[1,"margin-bottom-2x"],[1,"text-center","margin-top-6x"],["mat-mini-fab","",1,"fab-bottom-center"],["mat-fab","","routerLink","/create",1,"fab-bottom-right"],[3,"routerLink","appScrollIntoView"],[3,"session"],[1,"margin-y-4x"],["mat-mini-fab","",1,"fab-bottom-center",3,"click"]],template:function(i,n){i&1&&(F(0),C(1,"async"),F(2),C(3,"async"),F(4),g(5,Ei,16,9,"ng-container",0)),i&2&&(P(I(1,0,n.sessionFiltersRepo.activeFiltersCount$)),o(2),P(I(3,3,n.appStateRepo.lastVisitedSession$)),o(2),P(n.$showScrollToTopButton()))},dependencies:[H,rt,T,M,Xt,Tt,ei,ti,B,ae,at,se,L,k,ft,U,ht,_t,Wt,Yt,vt,bt],styles:["[_nghost-%COMP%]{display:block;padding-bottom:var(--spacing-fab-clearance)}a[_ngcontent-%COMP%]{display:block}app-session-list-item.active[_ngcontent-%COMP%]{color:var(--mat-sys-primary)}mat-divider[_ngcontent-%COMP%]{--mat-divider-color: #2e2e2c}"],data:{animation:[Ee("scrollToTopButtonAnimation",[me(":enter",[q({opacity:0}),le("150ms ease-in-out",q({opacity:1}))]),me(":leave",[q({opacity:1}),le("150ms ease-in-out",q({opacity:0}))])])]},changeDetection:0})}}return t})();export{ta as SessionListPageComponent};
